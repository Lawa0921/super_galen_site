<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¦é¦¨å ‚ | The Cozy Cottage Journal</title>

    <!-- LIBRARIES -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js"></script>

    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Caveat:wght@400;700&family=LXGW+WenKai+TC:wght@300;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --c-cream: #FDFBF7;
            --c-olive: #8A9A5B;
            --c-mustard: #E1AD01;
            --c-rose: #D29494;
            --c-brown: #8B4513;
            --c-dark-brown: #5D4037;
            --c-tape: rgba(255, 255, 255, 0.85);

            --f-hand: 'Caveat', cursive;
            --f-cute: 'Fredoka', sans-serif;
            --f-text: 'LXGW WenKai TC', cursive;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--c-cream);
            color: var(--c-brown);
            font-family: var(--f-text);
            overflow-x: hidden;
            width: 100vw;
            cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'><circle cx='16' cy='16' r='8' fill='%23E1AD01' opacity='0.8'/></svg>") 16 16, auto;
        }

        /* 3D SCENE (Fixed Background) */
        #webgl-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -2;
            background: linear-gradient(180deg, #fffcf5 0%, #f4e4bc 100%);
        }

        /* UI ELEMENTS */
        .back-link {
            position: fixed; top: 2rem; left: 2rem; z-index: 100;
            text-decoration: none; color: var(--c-brown);
            font-family: var(--f-cute); font-weight: 600;
            background: #fff; padding: 10px 25px;
            border-radius: 30px; border: 2px dashed var(--c-olive);
            box-shadow: 3px 3px 0 rgba(0,0,0,0.1);
            transition: 0.2s;
        }
        .back-link:hover { transform: scale(1.05); background: var(--c-cream); }

        /* FIXED AVATAR STICKER (New) */
        .avatar-sticker {
            position: fixed; top: 2rem; right: 2rem; width: 80px; height: 80px;
            z-index: 100; transform: rotate(5deg);
            border: 4px solid #fff; border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow: hidden; transition: 0.3s;
        }
        .avatar-sticker img { width: 100%; height: 100%; object-fit: cover; }
        .avatar-sticker:hover { transform: rotate(0deg) scale(1.1); }

        /* LOADING */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--c-cream); z-index: 10000;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
        .loader-icon { font-size: 3rem; margin-bottom: 1rem; animation: spin 2s infinite linear; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- MAIN LAYOUT --- */
        main {
            position: relative; z-index: 10;
            max-width: 900px; margin: 0 auto;
            padding: 150px 20px;
        }

        .section { margin-bottom: 200px; position: relative; }

        /* HERO */
        .paper-note {
            background: #fff; padding: 4rem; transform: rotate(-2deg);
            box-shadow: 5px 10px 20px rgba(0,0,0,0.1);
            max-width: 600px; margin: 0 auto;
            text-align: center; position: relative;
            mask-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 300' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0,10 Q50,0 100,10 T200,10 T300,10 T400,10 V290 Q350,300 300,290 T200,290 T100,290 T0,290 Z' fill='black'/%3E%3C/svg%3E");
            mask-size: 100% 100%;
        }
        .tape-top {
            width: 120px; height: 35px; background: var(--c-tape);
            position: absolute; top: -15px; left: 50%; transform: translateX(-50%) rotate(2deg);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .hero h1 { font-family: var(--f-hand); font-size: 4.5rem; color: var(--c-dark-brown); line-height: 1; margin-bottom: 1rem; }
        .hero p { font-family: var(--f-cute); font-size: 1.2rem; color: var(--c-olive); letter-spacing: 1px; }

        /* BOOK LAYOUT (Recipe Book) */
        .recipe-book {
            background: #fff; padding: 4rem; border-radius: 5px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            position: relative;
            background-image: linear-gradient(90deg, #fff 49%, #eee 50%, #fff 51%);
            background-size: 100% 100%;
            display: grid; grid-template-columns: 1fr 1fr; gap: 4rem;
        }
        .book-spine {
            position: absolute; left: 50%; top: 0; bottom: 0; width: 4px;
            background: rgba(0,0,0,0.1); transform: translateX(-50%);
        }
        .recipe-page h2 { font-family: var(--f-hand); font-size: 2.5rem; color: var(--c-dark-brown); border-bottom: 2px dashed var(--c-mustard); margin-bottom: 1.5rem; display: inline-block; }
        .recipe-page p { font-size: 1.1rem; line-height: 1.8; margin-bottom: 1rem; text-align: justify; }

        .polaroid {
            background: #fff; padding: 10px 10px 40px 10px;
            box-shadow: 2px 5px 15px rgba(0,0,0,0.15);
            transform: rotate(3deg); margin: 2rem auto;
            max-width: 300px; transition: 0.3s;
        }
        .polaroid:hover { transform: rotate(0deg) scale(1.05); z-index: 10; }
        .polaroid img { width: 100%; aspect-ratio: 1; object-fit: cover; filter: sepia(0.1); }
        .polaroid-caption { font-family: var(--f-hand); text-align: center; margin-top: 10px; font-size: 1.5rem; color: #666; }

        /* GRANDPA SECTION (Legacy) */
        .legacy-card {
            background: #fdf5e6; padding: 3rem; border: 4px double var(--c-olive);
            text-align: center; position: relative; max-width: 700px; margin: 0 auto;
        }
        .legacy-card::before {
            content: "ç¦æ˜Ÿå ‚"; font-family: "KaiTi", serif;
            position: absolute; top: -20px; left: 50%; transform: translateX(-50%);
            background: var(--c-brown); color: #fff; padding: 5px 20px;
            font-size: 1.5rem; border-radius: 5px;
        }

        /* INGREDIENTS (Floating) */
        .ingredients-row { display: flex; justify-content: center; gap: 3rem; margin-top: 3rem; }
        .ing-item { text-align: center; width: 100px; }
        .ing-icon { font-size: 3rem; margin-bottom: 0.5rem; display: block; }
        .ing-name { font-family: var(--f-hand); font-size: 1.5rem; }

        /* FOOTER */
        .footer-note { text-align: center; font-family: var(--f-hand); font-size: 2rem; margin-top: 4rem; }
        .socials { margin-top: 1rem; display: flex; justify-content: center; gap: 1.5rem; }
        .social-link {
            font-size: 2rem; color: var(--c-brown); transition: 0.3s;
            background: #fff; width: 50px; height: 50px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            border: 2px solid var(--c-brown);
        }
        .social-link:hover { transform: rotate(15deg) scale(1.1); color: var(--c-rose); border-color: var(--c-rose); }

        /* COOKIE JAR (Fixed) */
        .jar-trigger {
            position: fixed; bottom: 30px; right: 30px;
            width: 80px; height: 80px; background: #fff;
            border-radius: 50%; border: 3px solid var(--c-brown);
            display: flex; justify-content: center; align-items: center;
            font-size: 3rem; cursor: pointer; z-index: 500;
            box-shadow: 5px 5px 0 var(--c-olive);
            transition: 0.3s;
        }
        .jar-trigger:hover { transform: scale(1.1) rotate(-10deg); }
        .jar-hint {
            position: absolute; top: -40px; right: 0; background: var(--c-mustard); color: #fff;
            padding: 5px 15px; border-radius: 20px; font-family: var(--f-cute); white-space: nowrap;
            opacity: 0; transition: 0.3s; pointer-events: none;
        }
        .jar-trigger:hover .jar-hint { opacity: 1; top: -50px; }

        /* MODAL */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 252, 245, 0.95); z-index: 2000;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: 0.5s;
        }
        .modal-overlay.active { opacity: 1; pointer-events: all; }
        .modal-content { text-align: center; position: relative; }
        .close-btn { position: absolute; top: -50px; right: 0; font-size: 2rem; cursor: pointer; color: var(--c-brown); }
        .fortune-paper {
            background: #fff; padding: 2rem 3rem; border: 2px dashed var(--c-rose);
            font-family: var(--f-hand); font-size: 2rem; transform: rotate(-2deg);
            box-shadow: 5px 10px 30px rgba(0,0,0,0.1); margin-top: 2rem;
            opacity: 0;
        }

        @media (max-width: 768px) {
            .recipe-book { grid-template-columns: 1fr; background: #fff; }
            .book-spine { display: none; }
            .recipe-page { margin-bottom: 3rem; }
        }
    </style>
</head>
<body>

    <div id="loader"><div class="loader-icon">ğŸª</div></div>
    <div id="webgl-container"></div>

    <!-- UI -->
    <a href="index.html" class="back-link">â† Guild</a>
    <div class="avatar-sticker">
        <img src="../assets/img/guild/fuxintang/avatar.webp" alt="Fuxintang">
    </div>

    <main>
        <!-- HERO -->
        <section class="section hero">
            <div class="paper-note">
                <div class="tape-top"></div>
                <h1>Hello! <br> I'm Fuxintang</h1>
                <p>Welcome to my little forest cottage.</p>
                <div style="font-size: 3rem; position: absolute; bottom: -20px; right: -20px; transform: rotate(20deg);">ğŸŒ»</div>
            </div>
        </section>

        <!-- BOOK: CHAPTER 1 (Origins) -->
        <section class="section recipe-book">
            <div class="book-spine"></div>
            <div class="recipe-page">
                <h2>Chapter 1: The Origin</h2>
                <p>åŸæœ¬æ˜¯å€‹å…’ç«¥ç¾è¡“è€å¸« ğŸ¨ï¼Œæ¯å¤©èˆ‡è‰²å½©ç‚ºä¼ã€‚ç•«ç•«æ˜¯æˆ‘çš„åˆæˆ€ï¼Œä¹Ÿæ˜¯æˆ‘è§€å¯Ÿä¸–ç•Œçš„æ–¹å¼ã€‚</p>
                <p>ä½†æŸå¹´ç”Ÿäº†ä¸€å ´å¤§ç—…ï¼Œç”Ÿå‘½å¥½åƒæŒ‰ä¸‹äº†æš«åœéµã€‚åœ¨æ—©é¤åº—æ‰“å·¥çš„æ—¥å­è£¡ï¼Œæˆ‘é‡æ–°å­¸æœƒäº†å‘¼å¸ã€‚</p>
                <div class="polaroid">
                    <img src="../assets/img/guild/fuxintang/gallery_1.webp" alt="Making">
                    <div class="polaroid-caption">The Beginning ğŸ¥£</div>
                </div>
            </div>
            <div class="recipe-page">
                <h2>The Impulse</h2>
                <p>è·¯é‚Šå¯«è‘—ã€Œå‡ºç§Ÿæ”¤ä½ 3000ã€ï¼Œè¦ºå¾—å¾ˆä¾¿å®œå°±è¡å‹•ç§Ÿä¸‹... è«åå…¶å¦™é–‹å§‹äº†é›è›‹ç³•ä¹‹è·¯ï¼</p>
                <p>æˆ‘æ˜¯ã€Œä¸å°ˆæ¥­ç ”ç©¶å®¶ã€ã€‚éºµç³Šé…æ–¹è‡ªå·±ç ”ç™¼ï¼Œå …æŒä¸åŠ å¥‡æ€ªçš„æ±è¥¿ã€‚</p>
                <div class="ingredients-row">
                    <div class="ing-item"><span class="ing-icon">ğŸ¥š</span><div class="ing-name">Eggs</div></div>
                    <div class="ing-item"><span class="ing-icon">ğŸŒ¾</span><div class="ing-name">Flour</div></div>
                    <div class="ing-item"><span class="ing-icon">ğŸ¥›</span><div class="ing-name">Milk</div></div>
                </div>
            </div>
        </section>

        <!-- LEGACY SECTION -->
        <section class="section legacy">
            <div class="legacy-card">
                <h3 style="font-family: var(--f-hand); font-size: 2.5rem; margin: 1rem 0;">Grandpa's Legacy</h3>
                <p style="font-size: 1.2rem; line-height: 1.8;">
                    åº—å–åã€Œç¦é¦¨å ‚ã€æ˜¯ç‚ºäº†ç´€å¿µæˆ‘å¤–å…¬ã€‚<br>
                    ä»–åœ¨ç”Ÿå‰é–‹äº†ä¸€å®¶<span style="color:var(--c-rose); font-weight:bold;">ã€Œç¦æ˜Ÿå ‚ã€</span>ä¸­è—¥è¡Œå…¼ç®—å‘½çš„åº—ã€‚<br>
                    è‰è—¥çš„é¦™æ°£ï¼Œç±¤ç­’çš„è²éŸ³ï¼Œéƒ½æ˜¯æˆ‘ç«¥å¹´çš„è¨˜æ†¶ã€‚
                </p>
                <div style="font-size: 3rem; margin-top: 1rem;">ğŸ•¯ï¸</div>
            </div>
        </section>

        <!-- BOOK: CHAPTER 2 (The Craft) -->
        <section class="section recipe-book">
            <div class="book-spine"></div>
            <div class="recipe-page">
                <div class="polaroid" style="transform: rotate(-2deg);">
                    <img src="../assets/img/guild/fuxintang/gallery_2.webp" alt="Baking">
                    <div class="polaroid-caption">With Love â¤ï¸</div>
                </div>
                <p style="margin-top: 2rem;">å®¢äººéƒ½å•åŠ äº†ä»€éº¼ï¼Ÿæˆ‘èªªï¼šæ‡‰è©²æ˜¯æ„›å§ï¼å“ˆå“ˆ ğŸ’•</p>
                <p>çœ‹è‘—éºµç³Šåœ¨æ¨¡å…·è£¡æ…¢æ…¢è†¨è„¹ï¼Œè®Šæˆé‡‘é»ƒè‰²çš„å°è›‹ç³•ï¼Œé€™éç¨‹æœ¬èº«å°±æ˜¯ä¸€ç¨®ç™‚ç™’ã€‚</p>
            </div>
            <div class="recipe-page">
                <h2>Daily Specials</h2>
                <p>æ¯ä¸€é¡†é›è›‹ç³•éƒ½æ˜¯ç¾é»ç¾åšï¼Œä¿ç•™æœ€ç´”ç²¹çš„è›‹é¦™ã€‚</p>
                <ul style="list-style: none; padding: 0; font-family: var(--f-hand); font-size: 1.5rem; line-height: 2;">
                    <li>âœ¨ Classic Original (åŸå‘³)</li>
                    <li>ğŸ§€ Double Cheese (èµ·å¸)</li>
                    <li>ğŸ« Rich Chocolate (å·§å…‹åŠ›)</li>
                    <li>ğŸµ Kyoto Matcha (æŠ¹èŒ¶)</li>
                </ul>
                <div class="polaroid" style="transform: rotate(4deg); width: 80%; margin-top: 2rem;">
                    <img src="../assets/img/guild/fuxintang/gallery_3.webp" alt="Result">
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <section class="section footer">
            <div class="footer-note">
                <p>"ä¸–é–“åƒè¬ å†é›£é‡æ­¤"</p>
                <div class="socials">
                    <a href="https://www.threads.com/@fuxintang_tw" target="_blank" class="social-link"><i class="fa-brands fa-threads"></i></a>
                    <a href="https://www.instagram.com/fuxintang_tw/" target="_blank" class="social-link"><i class="fa-brands fa-instagram"></i></a>
                </div>
                <div style="font-size: 0.8rem; margin-top: 2rem; opacity: 0.5;">Made by SuperGalen's Dungeon</div>
            </div>
        </section>
    </main>

    <!-- INTERACTION -->
    <div class="jar-trigger" id="jar-trigger">
        ğŸº
        <div class="jar-hint">Grandpa's Fortune!</div>
    </div>

    <div class="modal-overlay" id="fortune-modal">
        <div class="modal-content">
            <div class="close-btn">&times;</div>
            <div style="font-size: 5rem; margin-bottom: 1rem;" id="modal-jar">ğŸº</div>
            <button id="shake-btn" style="padding: 10px 30px; font-family: var(--f-cute); font-size: 1.2rem; background: var(--c-rose); color: white; border: none; border-radius: 20px; cursor: pointer;">Shake It!</button>
            <div class="fortune-paper" id="fortune-text"></div>
        </div>
    </div>

    <script>
        // --- SETUP ---
        window.onload = () => {
            gsap.to('#loader', { opacity: 0, duration: 0.5, onComplete: () => document.getElementById('loader').remove() });
        };

        // --- THREE.JS (POV Walk) ---
        const initThree = () => {
            const scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0xFFFCF5, 10, 40);

            const camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 0.1, 100);
            camera.position.set(0, 2, 10); // Eye level

            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('webgl-container').appendChild(renderer.domElement);

            const light = new THREE.DirectionalLight(0xffeebb, 1);
            light.position.set(5, 10, 5);
            scene.add(light);
            scene.add(new THREE.AmbientLight(0xffffff, 0.8));

            // Ground
            const plane = new THREE.Mesh(
                new THREE.PlaneGeometry(100, 200),
                new THREE.MeshStandardMaterial({ color: 0xeae2c6 })
            );
            plane.rotation.x = -Math.PI/2;
            plane.position.z = -50;
            scene.add(plane);

            // Procedural Forest
            function addTree(x, z) {
                const group = new THREE.Group();
                const trunk = new THREE.Mesh(
                    new THREE.CylinderGeometry(0.2, 0.4, 1.5, 6),
                    new THREE.MeshToonMaterial({ color: 0x8B4513 })
                );
                trunk.position.y = 0.75;
                group.add(trunk);

                const foliage = new THREE.Mesh(
                    new THREE.ConeGeometry(1.2, 2.5, 7),
                    new THREE.MeshToonMaterial({ color: 0x8A9A5B })
                );
                foliage.position.y = 2.5;
                group.add(foliage);

                group.position.set(x, 0, z);
                group.rotation.y = Math.random() * Math.PI;
                scene.add(group);
            }

            // Path
            for(let z=10; z>-100; z-=3) {
                const width = 6 + Math.random()*2;
                addTree(width + Math.random(), z);
                addTree(-width - Math.random(), z);
            }

            // Render
            function animate() {
                requestAnimationFrame(animate);
                renderer.render(scene, camera);
            }
            animate();

            // Scroll Walk
            gsap.registerPlugin(ScrollTrigger);
            gsap.to(camera.position, {
                z: -30, // Walk forward
                y: 4, // Slight rise
                ease: "none",
                scrollTrigger: {
                    trigger: "body", start: "top top", end: "bottom bottom", scrub: 1
                }
            });

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        };
        initThree();

        // --- INTERACTIONS ---

        // Book Page Reveal
        gsap.utils.toArray('.recipe-book').forEach((book) => {
            gsap.from(book, {
                scrollTrigger: { trigger: book, start: "top 80%" },
                y: 50, opacity: 0, rotationX: 10, duration: 1, ease: "power2.out"
            });
        });

        // Avatar Sticker Reaction (Rotate on Scroll)
        gsap.to(".avatar-sticker", {
            rotation: 360,
            scrollTrigger: {
                trigger: "body", start: "top top", end: "bottom bottom", scrub: 1
            }
        });

        // Crayon Trail (Re-adding interaction)
        const trailLayer = document.createElement('div');
        trailLayer.id = 'drawing-layer';
        trailLayer.style.position = 'fixed'; trailLayer.style.top=0; trailLayer.style.left=0; trailLayer.style.width='100%'; trailLayer.style.height='100%'; trailLayer.style.pointerEvents='none'; trailLayer.style.zIndex='9999';
        document.body.appendChild(trailLayer);

        document.addEventListener('mousemove', (e) => {
            if(Math.random() > 0.85) {
                const dot = document.createElement('div');
                dot.style.position = 'absolute';
                dot.style.width = (Math.random()*6+2) + 'px';
                dot.style.height = dot.style.width;
                dot.style.borderRadius = '50%';
                dot.style.backgroundColor = ['#E1AD01', '#8A9A5B', '#D29494'][Math.floor(Math.random()*3)];
                dot.style.left = e.clientX + 'px';
                dot.style.top = e.clientY + 'px';
                trailLayer.appendChild(dot);

                gsap.to(dot, {
                    y: 20, opacity: 0, duration: 1,
                    onComplete: () => dot.remove()
                });
            }
        });

        // Fortune Jar
        const modal = document.getElementById('fortune-modal');
        const jarBtn = document.getElementById('jar-trigger');
        const shakeBtn = document.getElementById('shake-btn');
        const fortuneText = document.getElementById('fortune-text');
        const fortunes = ["å¿ƒèª å‰‡éˆ", "è¬äº‹å¦‚æ„", "é£Ÿä¹‹æœ‰å‘³", "è‰æœ¨é€¢æ˜¥", "ç¦æ˜Ÿé«˜ç…§"];

        jarBtn.onclick = () => {
            modal.classList.add('active');
            fortuneText.style.opacity = 0;
            gsap.set(shakeBtn, { display: 'inline-block', opacity: 1 });
        };
        document.querySelector('.close-btn').onclick = () => modal.classList.remove('active');

        shakeBtn.onclick = () => {
            const jar = document.getElementById('modal-jar');
            gsap.to(jar, { rotation: 20, yoyo: true, repeat: 5, duration: 0.1, onComplete: () => {
                const text = fortunes[Math.floor(Math.random()*fortunes.length)];
                fortuneText.innerText = text;
                gsap.to(fortuneText, { opacity: 1, duration: 0.5 });
                gsap.to(shakeBtn, { opacity: 0, display: 'none' });
            }});
        };

    </script>
</body>
</html>
