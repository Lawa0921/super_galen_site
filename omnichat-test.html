<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Omnichat Video API Test</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 40px 20px;
      background: #f5f5f5;
    }
    h1 { color: #333; }
    .info-box {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .info-box h2 {
      margin-top: 0;
      color: #2563eb;
    }
    code {
      background: #e5e7eb;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
      word-break: break-all;
    }
    .toggle-container {
      background: #1e40af;
      color: white;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    .toggle-container h2 {
      margin-top: 0;
      color: white;
    }
    .toggle-btn {
      display: inline-block;
      padding: 12px 24px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
    }
    .toggle-btn.active {
      background: #22c55e;
      color: white;
    }
    .toggle-btn:not(.active) {
      background: #374151;
      color: #9ca3af;
    }
    .toggle-btn:hover:not(.active) {
      background: #4b5563;
    }
    .current-config {
      background: #064e3b;
      padding: 15px;
      border-radius: 6px;
      margin-top: 15px;
      font-size: 13px;
    }
    .warning {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 15px;
      margin: 15px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    th, td {
      text-align: left;
      padding: 8px;
      border-bottom: 1px solid #e5e7eb;
    }
    th { background: #f9fafb; }
    #config-name, #config-url, #config-script, #status-text { display: block; margin: 3px 0; }
  </style>
</head>
<body>
  <h1>Omnichat Video API Test Page</h1>

  <div class="toggle-container">
    <h2>Plugin Version Switch</h2>
    <p>Select which plugin version to test:</p>
    <button id="btn-original" class="toggle-btn active" onclick="switchPlugin('original')">
      Original (easychat.js)
    </button>
    <button id="btn-new" class="toggle-btn" onclick="switchPlugin('new')">
      New Video Support (easychat-v2.js)
    </button>

    <div class="current-config">
      <span id="config-name"><strong>Current:</strong> Original Plugin</span>
      <span id="config-url"><strong>URL:</strong> uat-chat-plugin.easychat.co</span>
      <span id="config-script"><strong>Script:</strong> easychat.js</span>
    </div>
  </div>

  <div class="info-box">
    <h2>Plugin Comparison</h2>
    <table>
      <tr>
        <th>Item</th>
        <th>Original</th>
        <th>New (Video Support)</th>
      </tr>
      <tr>
        <td>Chat Client URL</td>
        <td><code>uat-chat-plugin.easychat.co</code></td>
        <td><code>uat-chat-client.omnichat.ai</code></td>
      </tr>
      <tr>
        <td>Plugin Script</td>
        <td><code>easychat.js</code></td>
        <td><code>easychat-v2.js</code></td>
      </tr>
      <tr>
        <td>App Key</td>
        <td colspan="2"><code>Same App Key (teamName: be4dc72f-...)</code></td>
      </tr>
      <tr>
        <td>Team ID</td>
        <td><code>be4dc72f-fa5b-44e4-833b-e1e4ed23408c</code></td>
        <td><code>be4dc72f-fa5b-44e4-833b-e1e4ed23408c</code></td>
      </tr>
      <tr>
        <td>Video Support</td>
        <td>No</td>
        <td>Yes (developing)</td>
      </tr>
    </table>
  </div>

  <div class="warning">
    <span id="status-text"><strong>Status:</strong> Click the chat button in the bottom right corner to test.</span>
  </div>

  <div class="info-box">
    <h2>Test Steps</h2>
    <ol>
      <li>Select a plugin version above</li>
      <li>Click the chat button (bottom right corner)</li>
      <li>Verify the chat dialog opens correctly</li>
      <li>Send a message to start a conversation</li>
      <li>Note the Room ID from Omnichat backend</li>
      <li>Test sending video via API</li>
    </ol>
  </div>

  <script>
    var plugins = {
      original: {
        name: 'Original Plugin',
        chatUrl: 'https://uat-chat-plugin.easychat.co/',
        appKey: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0ZWFtTmFtZSI6ImJlNGRjNzJmLWZhNWItNDRlNC04MzNiLWUxZTRlZDIzNDA4YyJ9.uObnx9MHwEI3jQ9SE5itx72LQ7ODsjTWZ4hD5Bs-5MI',
        scriptUrl: 'https://dev-chat-plugin.easychat.co/easychat.js',
        lang: 'en'
      },
      newVersion: {
        name: 'New Plugin (Video Support)',
        chatUrl: 'https://uat-chat-client.omnichat.ai/',
        appKey: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0ZWFtTmFtZSI6ImJlNGRjNzJmLWZhNWItNDRlNC04MzNiLWUxZTRlZDIzNDA4YyJ9.uObnx9MHwEI3jQ9SE5itx72LQ7ODsjTWZ4hD5Bs-5MI',
        scriptUrl: 'https://dev-chat-plugin.easychat.co/easychat-v2.js',
        lang: 'zh-Hant'
      }
    };

    var currentPlugin = 'original';

    function removeExistingPlugin() {
      var ids = [
        'easychat-floating-button',
        'easychat-unread-badge',
        'easychat-close-btn',
        'easychat-chat-dialog',
        'omnichat-plugin'
      ];
      for (var i = 0; i < ids.length; i++) {
        var el = document.getElementById(ids[i]);
        if (el) el.parentNode.removeChild(el);
      }
    }

    function loadPlugin(config) {
      var a = document.createElement('a');
      a.setAttribute('href', 'javascript:;');
      a.setAttribute('id', 'easychat-floating-button');

      var span = document.createElement('span');
      span.setAttribute('id', 'easychat-unread-badge');
      span.setAttribute('style', 'display: none');

      var d1 = document.createElement('div');
      d1.setAttribute('id', 'easychat-close-btn');
      d1.setAttribute('class', 'easychat-close-btn-close');

      var d2 = document.createElement('div');
      d2.setAttribute('id', 'easychat-chat-dialog');
      d2.setAttribute('class', 'easychat-chat-dialog-close');

      var ifrm = document.createElement('iframe');
      ifrm.setAttribute('id', 'easychat-chat-dialog-iframe');
      ifrm.setAttribute('src', config.chatUrl + '?appkey=' + config.appKey + '&lang=' + config.lang);
      ifrm.style.width = '100%';
      ifrm.style.height = '100%';
      ifrm.style.border = '0';
      d2.appendChild(ifrm);

      document.body.appendChild(a);
      document.body.appendChild(span);
      document.body.appendChild(d1);
      document.body.appendChild(d2);

      var scriptTag = document.createElement('script');
      scriptTag.src = config.scriptUrl;
      scriptTag.id = 'omnichat-plugin';
      document.body.appendChild(scriptTag);
    }

    function updateConfigDisplay(type) {
      var config = plugins[type];
      var scriptName = config.scriptUrl.split('/').pop();
      document.getElementById('config-name').textContent = 'Current: ' + config.name;
      document.getElementById('config-url').textContent = 'URL: ' + config.chatUrl;
      document.getElementById('config-script').textContent = 'Script: ' + scriptName;
    }

    function updateButtons(type) {
      var btnOriginal = document.getElementById('btn-original');
      var btnNew = document.getElementById('btn-new');
      if (type === 'original') {
        btnOriginal.classList.add('active');
        btnNew.classList.remove('active');
      } else {
        btnOriginal.classList.remove('active');
        btnNew.classList.add('active');
      }
    }

    function switchPlugin(type) {
      var pluginKey = type === 'new' ? 'newVersion' : 'original';
      if (pluginKey === currentPlugin) return;

      currentPlugin = pluginKey;
      removeExistingPlugin();

      setTimeout(function() {
        loadPlugin(plugins[pluginKey]);
        updateConfigDisplay(pluginKey);
        updateButtons(type);
        document.getElementById('status-text').textContent =
          'Switched to: ' + plugins[pluginKey].name + '. Click the chat button to test.';
      }, 100);
    }

    window.onload = function() {
      loadPlugin(plugins.original);
      updateConfigDisplay('original');
    };
  </script>

</body>
</html>
