<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ariel | The Alchemist of Order & Chaos</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+TC:wght@300;500;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <!-- Three.js Import Map -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <style>
        :root {
            /* Palette transforms from Clinical to Mystic */
            --c-bg: #f4f7f6; /* Clinical White */
            --c-text: #2c3e50;
            --c-accent-science: #3498db; /* Science Blue */
            --c-accent-mystic: #9b59b6; /* Mystic Purple */
            --c-gold: #d4af37;
        }

        body {
            margin: 0;
            background-color: var(--c-bg); /* Will animate via GSAP */
            color: var(--c-text);
            font-family: 'Noto Serif TC', serif;
            overflow-x: hidden;
        }

        #canvas-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            z-index: 0; pointer-events: none;
        }

        /* UI Overlay */
        .ui-layer {
            position: relative; z-index: 10;
            max-width: 1000px; margin: 0 auto;
            pointer-events: none; /* Let clicks pass to 3D if needed, but mostly scroll */
        }
        .ui-content { pointer-events: auto; }

        /* Navigation */
        .nav-back {
            position: fixed; top: 2rem; left: 2rem; z-index: 100;
            font-family: 'Cinzel'; font-weight: 700; color: var(--c-text);
            text-decoration: none; border: 2px solid var(--c-text);
            padding: 0.5rem 1rem; transition: 0.3s;
            mix-blend-mode: difference; /* Ensure visibility on dark/light */
            color: #fff; border-color: #fff; /* Default to white for mix-blend */
        }

        /* Typography */
        h1, h2, h3 { font-family: 'Cinzel', serif; margin: 0; }
        p { font-family: 'Noto Serif TC', serif; line-height: 2; font-size: 1.1rem; }

        .en-label {
            font-family: 'Lato', sans-serif; text-transform: uppercase; letter-spacing: 3px;
            font-size: 0.8rem; opacity: 0.7; display: block; margin-bottom: 0.5rem;
        }

        /* Sections */
        section {
            min-height: 100vh;
            display: flex; align-items: center;
            padding: 2rem; box-sizing: border-box;
            position: relative;
        }

        /* Cards */
        .story-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 3rem; border-radius: 4px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 500px;
            border-left: 4px solid var(--c-accent-science);
            transition: 0.5s;
        }

        /* Dark Mode style for bottom sections */
        .story-card.mystic {
            background: rgba(20, 10, 30, 0.8);
            color: #f0f0f0;
            border-left-color: var(--c-gold);
            backdrop-filter: blur(10px);
        }
        .story-card.mystic p { color: #ddd; }
        .story-card.mystic h2 { color: var(--c-gold); }

        /* Hero */
        #hero { justify-content: center; text-align: center; }
        .hero-title {
            font-size: 4rem; margin-bottom: 1rem;
            background: linear-gradient(to right, #2c3e50, #3498db);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .hero-subtitle { font-size: 1.2rem; letter-spacing: 2px; color: #555; margin-bottom: 2rem; }

        .scroll-hint {
            position: absolute; bottom: 2rem; left: 50%; transform: translateX(-50%);
            animation: bounce 2s infinite; opacity: 0.6;
        }
        @keyframes bounce { 0%, 100% { transform: translate(-50%, 0); } 50% { transform: translate(-50%, 10px); } }

        /* Image Props */
        .prop-img {
            width: 100%; border-radius: 4px; margin-top: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Footer */
        .final-footer {
            height: 50vh; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            background: #000; color: var(--c-gold);
            position: relative; z-index: 20;
        }
        .social-row { display: flex; gap: 2rem; font-size: 2rem; margin-top: 2rem; }
        .social-row a { color: var(--c-gold); transition: 0.3s; }
        .social-row a:hover { transform: scale(1.2); color: #fff; }

        /* Layout Utils */
        .align-right { margin-left: auto; }
        .align-left { margin-right: auto; }

        @media (max-width: 768px) {
            .hero-title { font-size: 3rem; }
            .story-card { padding: 2rem; max-width: 100%; }
        }

    </style>
</head>
<body>

    <a href="/guild/" class="nav-back">GUILD</a>
    <div id="canvas-container"></div>

    <div class="ui-layer">

        <!-- Scene 1: The Lab (White/Blue) -->
        <section id="hero">
            <div class="ui-content">
                <span class="en-label">Regulatory Affairs Manager</span>
                <h1 class="hero-title">ARIEL</h1>
                <p class="hero-subtitle">The Alchemist of Structure</p>
                <div style="width: 150px; height: 150px; margin: 0 auto; border-radius: 50%; overflow: hidden; border: 4px solid #3498db;">
                    <img src="/assets/img/guild/ariel/avatar_main.webp" style="width: 100%; height: 100%; object-fit: cover;">
                </div>
            </div>
            <div class="scroll-hint">Begin the Synthesis <i class="fa-solid fa-chevron-down"></i></div>
        </section>

        <!-- Scene 2: The Structure (Left) -->
        <section>
            <div class="story-card ui-content align-left">
                <span class="en-label">The Molecular Grid</span>
                <h2>法規的結構美學</h2>
                <p>
                    在醫藥產業深耕 15 年，我處理的是最嚴謹的 <b>API</b> 與 <b>CMC</b> 法規。
                    這裡沒有模糊地帶，每一個分子、每一個數據都必須精準到位。
                </p>
                <p>
                    這看起來像是冷冰冰的科學，但對我來說，這是守護生命的安全網。
                    我享受在混亂的數據中建立秩序，像搭建分子結構一樣，構建出無懈可擊的合規策略。
                </p>
            </div>
        </section>

        <!-- Scene 3: The Unraveling (Right) -->
        <section>
            <div class="story-card ui-content align-right">
                <span class="en-label">Servant Leadership</span>
                <h2>打破框架</h2>
                <p>
                    但規則是死的，人是活的。
                    我不希望我的團隊變成只會填表的機器。
                </p>
                <p>
                    所以我引入了 <b>Automation</b> (VBA, Gemini)。
                    我拆解了繁瑣的流程（Unraveling），釋放出團隊的時間與創意。
                    這就是我的「僕人式領導」——我不僅僅是指揮者，更是那個幫大家解開死結的人。
                </p>
            </div>
        </section>

        <!-- Scene 4: The Transformation (Center) -->
        <section style="justify-content: center;">
            <div class="story-card mystic ui-content">
                <span class="en-label">The Alchemist's Transmutation</span>
                <h2>從結構到靈魂</h2>
                <p>
                    當理性的結構被解構後，剩下的是什麼？
                    是 <b>直覺 (Intuition)</b>。
                </p>
                <p>
                    在工作之外，我脫下了實驗袍，換上了織女的長裙。
                    我用鉤針編織絲線，用塔羅解讀人心。
                </p>
            </div>
        </section>

        <!-- Scene 5: The Mystic Loom (Left) -->
        <section>
            <div class="story-card mystic ui-content align-left" style="border-left-color: #9b59b6;">
                <span class="en-label">Weaver of Fate</span>
                <h2>織命者</h2>
                <p>
                    <b>左手拿法規，右手拿塔羅。</b>
                    這看似矛盾的兩面，在我身上達成了奇妙的平衡。
                </p>
                <p>
                    我是 Ariel，一個在 Human 3.0 時代，嘗試將冰冷的邏輯與溫暖的魔法編織在一起的煉金術師。
                    我的守護靈是 <b>Astro-Logical Wolf</b>，在星辰與數據之間，敏銳地嗅出未來的方向。
                </p>
                <img src="/assets/img/guild/ariel/material_bg.webp" class="prop-img" alt="Weaving Material">
            </div>
        </section>

    </div>

    <footer class="final-footer">
        <h2 style="font-family: 'Cinzel'; letter-spacing: 5px;">THE JOURNEY CONTINUES</h2>
        <div class="social-row">
            <a href="https://www.threads.net/@iabc5040"><i class="fa-brands fa-threads"></i></a>
            <a href="https://www.instagram.com/iabc5040/"><i class="fa-brands fa-instagram"></i></a>
        </div>
        <p style="margin-top: 2rem; opacity: 0.5; font-size: 0.8rem;">Made with love by SuperGalen's Dungeon</p>
    </footer>

    <script type="module">
        import * as THREE from 'three';

        // --- SETUP ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xf4f7f6); // Initial Lab Color

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 0, 30);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // --- LIGHTS ---
        const ambLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambLight);

        const dirLight = new THREE.DirectionalLight(0xffffff, 1);
        dirLight.position.set(10, 20, 10);
        scene.add(dirLight);

        // --- PART 1: THE MOLECULES (Structure) ---
        // Instanced Mesh for performance
        const atomCount = 200;
        const atomGeo = new THREE.IcosahedronGeometry(0.5, 1);
        const atomMat = new THREE.MeshStandardMaterial({ color: 0x3498db, roughness: 0.2, metalness: 0.5 });
        const atoms = new THREE.InstancedMesh(atomGeo, atomMat, atomCount);

        const dummy = new THREE.Object3D();
        const atomPositions = [];

        for(let i=0; i<atomCount; i++) {
            // Grid-like arrangement + some noise
            const x = (Math.random() - 0.5) * 40;
            const y = (Math.random() - 0.5) * 60; // Tall distribution
            const z = (Math.random() - 0.5) * 20;

            dummy.position.set(x, y, z);
            dummy.scale.setScalar(Math.random() * 0.5 + 0.5);
            dummy.rotation.set(Math.random()*Math.PI, Math.random()*Math.PI, 0);
            dummy.updateMatrix();
            atoms.setMatrixAt(i, dummy.matrix);

            atomPositions.push({x, y, z, originalY: y});
        }
        scene.add(atoms);

        // Connections (Grid Lines)
        const gridHelper = new THREE.GridHelper(100, 50, 0xbdc3c7, 0xeef2f3);
        gridHelper.rotation.x = Math.PI / 2; // Vertical wall
        gridHelper.position.z = -10;
        scene.add(gridHelper);


        // --- PART 2: THE GOLDEN THREAD (Transition) ---
        // A long curve that starts invisible and draws itself
        const curvePoints = [
            new THREE.Vector3(0, 10, 0),
            new THREE.Vector3(5, 0, 5),
            new THREE.Vector3(-5, -10, 0),
            new THREE.Vector3(8, -20, 10),
            new THREE.Vector3(0, -30, 0), // End at Tarot
        ];
        const curve = new THREE.CatmullRomCurve3(curvePoints);
        const tubeGeo = new THREE.TubeGeometry(curve, 100, 0.1, 8, false);
        const tubeMat = new THREE.MeshStandardMaterial({
            color: 0xd4af37, emissive: 0xaa8800, emissiveIntensity: 0.5,
            metalness: 1, roughness: 0.3
        });
        const thread = new THREE.Mesh(tubeGeo, tubeMat);
        thread.geometry.setDrawRange(0, 0); // Start hidden
        scene.add(thread);


        // --- PART 3: THE TAROT (Mystic) ---
        // Texture from asset
        const textureLoader = new THREE.TextureLoader();
        const cardTexture = textureLoader.load('/assets/img/guild/ariel/material_bg.webp');

        const cardGeo = new THREE.PlaneGeometry(6, 10);
        const cardMat = new THREE.MeshStandardMaterial({
            map: cardTexture, side: THREE.DoubleSide,
            roughness: 0.6
        });
        const tarot = new THREE.Mesh(cardGeo, cardMat);
        tarot.position.set(0, -30, 0);
        tarot.rotation.y = Math.PI; // Back facing first
        scene.add(tarot);

        // Particle Stars for the bottom
        const starGeo = new THREE.BufferGeometry();
        const starPos = [];
        for(let i=0; i<500; i++) {
            starPos.push((Math.random()-0.5)*100, (Math.random()-0.5)*100 - 30, (Math.random()-0.5)*50);
        }
        starGeo.setAttribute('position', new THREE.Float32BufferAttribute(starPos, 3));
        const starMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.2, transparent: true, opacity: 0 });
        const stars = new THREE.Points(starGeo, starMat);
        scene.add(stars);


        // --- GSAP ANIMATION TIMELINE ---

        // Master Timeline linked to scroll
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: "body",
                start: "top top",
                end: "bottom bottom",
                scrub: 1
            }
        });

        // Phase 1: Exploration (0-30%)
        // Camera moves down, Atoms rotate
        tl.to(camera.position, { y: -10, z: 20, duration: 3 });
        tl.to(atoms.rotation, { y: 1, duration: 3 }, "<");

        // Phase 2: Unraveling (30-60%)
        // Atoms scatter, Grid fades, Background darkens
        tl.to(atoms.position, { x: 50, duration: 2, ease: "power2.in" }, "phase2"); // Fly away
        tl.to(gridHelper.material, { opacity: 0, transparent: true, duration: 1 }, "phase2");

        // Background Color Shift (White -> Deep Purple/Black)
        const colorObj = { r: 0.95, g: 0.97, b: 0.96 }; // #f4f7f6
        tl.to(colorObj, {
            r: 0.05, g: 0.02, b: 0.1, // Dark Purple #0d051a
            duration: 3,
            onUpdate: () => scene.background.setRGB(colorObj.r, colorObj.g, colorObj.b)
        }, "phase2");

        // Thread Draws
        // Tubular segments = 100, Radial = 8, Triangles = 2 per face.
        // Index count roughly: 100 * 8 * 6 = 4800. Let's use 5000 to be safe.
        tl.to(thread.geometry, {
            duration: 3,
            onUpdate: function() { this.targets()[0].setDrawRange(0, Math.floor(this.progress() * 5000)); }
        }, "phase2");

        // Phase 3: Mystic (60-100%)
        // Camera follows thread to Tarot
        tl.to(camera.position, { y: -30, z: 15, duration: 4 }, "phase3");

        // Stars appear
        tl.to(starMat, { opacity: 0.8, duration: 2 }, "phase3");

        // Tarot Spin
        tl.to(tarot.rotation, { y: Math.PI * 4, duration: 4, ease: "none" }, "phase3");
        tl.to(tarot.rotation, { x: 0.2, duration: 4 }, "phase3");


        // --- LOOP ---
        function animate() {
            requestAnimationFrame(animate);

            // Subtle idle motion
            atoms.rotation.z += 0.0005;
            tarot.position.y = -30 + Math.sin(Date.now()*0.001)*0.5;

            renderer.render(scene, camera);
        }
        animate();

        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>
</html>