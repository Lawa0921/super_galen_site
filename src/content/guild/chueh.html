<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chueh | The Rhythm Walker</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@300;500;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" media="print" onload="this.media='all'">

    <!-- Libraries -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>

    <style>
        :root {
            --c-bg: #050505;
            --c-primary: #00ffff; /* Cyan */
            --c-secondary: #ff00ff; /* Magenta */
            --c-accent: #ffd700; /* Gold */
            --c-text: #ffffff;
            --f-tech: 'Orbitron', sans-serif;
            --f-body: 'Noto Sans TC', sans-serif;
        }

        body {
            margin: 0;
            background-color: var(--c-bg);
            color: var(--c-text);
            font-family: var(--f-body);
            overflow-x: hidden;
            cursor: crosshair;
        }

        /* --- Loader --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .loader-text {
            font-family: var(--f-tech);
            font-size: 2rem;
            color: var(--c-primary);
            text-shadow: 0 0 10px var(--c-primary);
            animation: pulse 0.5s infinite alternate;
        }
        @keyframes pulse {
            from { opacity: 0.5; text-shadow: 0 0 10px var(--c-primary); }
            to { opacity: 1; text-shadow: 0 0 20px var(--c-primary), 0 0 40px var(--c-primary); }
        }

        /* --- Backgrounds --- */
        #webgl-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            z-index: -2; pointer-events: none;
        }
        #p5-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            z-index: -1; pointer-events: none; opacity: 0.3;
        }

        /* --- Navigation --- */
        .nav-back {
            position: fixed; top: 2rem; left: 2rem; z-index: 100;
            color: rgba(255,255,255,0.8); text-decoration: none;
            font-family: var(--f-tech); font-weight: 700;
            padding: 0.5rem 1rem;
            border: 1px solid var(--c-primary);
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }
        .nav-back:hover {
            background: var(--c-primary); color: #000;
            box-shadow: 0 0 20px var(--c-primary);
        }

        /* --- Layout --- */
        section {
            min-height: 100vh;
            display: flex; flex-direction: column; justify-content: center;
            padding: 4rem 2rem; box-sizing: border-box;
            position: relative;
        }
        .container {
            max-width: 1200px; width: 100%; margin: 0 auto; position: relative; z-index: 10;
        }

        /* --- Typography & Elements --- */
        h1 {
            font-family: var(--f-tech);
            font-size: clamp(3rem, 10vw, 8rem);
            line-height: 0.9; margin: 0;
            text-transform: uppercase;
            color: transparent;
            -webkit-text-stroke: 2px var(--c-text);
            position: relative;
        }
        h1::before {
            content: attr(data-text);
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            color: var(--c-primary);
            overflow: hidden;
            clip-path: inset(0 100% 0 0);
            animation: textScan 3s cubic-bezier(0.19, 1, 0.22, 1) forwards 0.5s;
        }
        @keyframes textScan { to { clip-path: inset(0 0 0 0); } }

        h2 {
            font-family: var(--f-tech); font-size: clamp(2rem, 5vw, 4rem);
            margin-bottom: 2rem; color: var(--c-accent);
            text-shadow: 0 0 10px var(--c-accent);
        }

        p {
            font-size: 1.1rem; line-height: 1.8; max-width: 600px;
            background: rgba(0,0,0,0.7); padding: 1rem;
            border-left: 3px solid var(--c-primary);
            margin-bottom: 1rem;
        }

        .glitch-box {
            position: relative;
            display: inline-block;
        }

        /* --- Hero --- */
        .hero-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: center;
        }
        .avatar-frame {
            position: relative; width: 100%; aspect-ratio: 1/1;
            clip-path: polygon(20% 0%, 80% 0%, 100% 20%, 100% 80%, 80% 100%, 20% 100%, 0% 80%, 0% 20%);
            transition: clip-path 0.5s, transform 0.5s;
        }
        .avatar-frame:hover {
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0% 100%);
            transform: scale(1.05);
        }
        .avatar-img {
            width: 100%; height: 100%; object-fit: cover;
            filter: grayscale(1) contrast(1.2) brightness(0.8);
            transition: filter 0.5s;
        }
        .avatar-frame:hover .avatar-img {
            filter: grayscale(0) contrast(1) brightness(1);
        }

        /* --- Timeline / Stats --- */
        .stat-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem; margin-top: 4rem;
        }
        .stat-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--c-secondary);
            padding: 2rem; text-align: center;
            transition: 0.3s;
            position: relative; overflow: hidden;
        }
        .stat-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,0,255,0.1), transparent);
            transform: translateX(-100%); transition: 0.5s;
        }
        .stat-card:hover::before { transform: translateX(100%); }
        .stat-card:hover { transform: translateY(-10px); box-shadow: 0 0 30px rgba(255,0,255,0.3); }

        .stat-num {
            font-family: var(--f-tech); font-size: 3rem; color: var(--c-secondary);
            display: block; margin-bottom: 0.5rem;
        }

        /* --- Gallery --- */
        .gallery-container {
            position: relative; width: 100%; height: 60vh;
            overflow: hidden; border: 2px solid var(--c-accent);
            margin-top: 2rem;
            clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
        }
        .gallery-img {
            width: 100%; height: 120%; object-fit: cover;
            object-position: center;
        }
        .overlay-text {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: linear-gradient(0deg, #000, transparent);
            padding: 2rem; box-sizing: border-box;
            z-index: 2;
        }

        /* --- Footer --- */
        .social-links {
            display: flex; gap: 2rem; justify-content: center; margin-top: 2rem;
        }
        .social-btn {
            font-size: 2rem; color: var(--c-text);
            width: 60px; height: 60px;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid var(--c-primary);
            border-radius: 50%;
            transition: 0.3s; text-decoration: none;
            position: relative; overflow: hidden;
        }
        .social-btn::after {
            content: ''; position: absolute; inset: 0; background: var(--c-primary);
            border-radius: 50%; z-index: -1; transform: scale(0); transition: 0.3s;
        }
        .social-btn:hover { color: #000; border-color: transparent; }
        .social-btn:hover::after { transform: scale(1); }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-grid { grid-template-columns: 1fr; text-align: center; }
            h1 { font-size: 4rem; }
            h2 { font-size: 2rem; }
            .avatar-frame { width: 80%; margin: 0 auto; clip-path: circle(50% at 50% 50%); }
            .container { padding: 0 1rem; }
            section { padding: 4rem 1rem; }
            .stat-grid { grid-template-columns: 1fr; }
            #philosophy .container { align-items: center; text-align: center; }
            #philosophy p { border-right: none; border-left: 3px solid var(--c-accent); text-align: left; }
        }
    </style>
</head>
<body>

    <div id="loader">
        <div class="loader-text">INITIALIZING SYSTEM...</div>
    </div>

    <div id="webgl-container"></div>
    <div id="p5-container"></div>

    <a href="/guild/" class="nav-back">← GUILD</a>

    <!-- HERO -->
    <section id="hero">
        <div class="container">
            <div class="hero-grid">
                <div>
                    <h1 data-text="CHUEH">CHUEH</h1>
                    <h2 class="glitch-text" style="color: var(--c-primary); font-size: 1.5rem; letter-spacing: 5px; margin-top: -10px;">
                        THE RHYTHM WALKER
                    </h2>
                    <p class="gs-reveal">
                        "從爵士鼓的激昂到手碟的空靈，我在聲音的維度中尋找共鳴。"
                    </p>
                    <div style="margin-top: 2rem;" class="gs-reveal">
                         <span style="color: var(--c-accent); font-family: var(--f-tech);">DATA:</span>
                         Musician / Teacher / Creator
                    </div>
                </div>
                <div class="avatar-frame gs-reveal">
                    <img src="/assets/img/guild/chueh/avatar.webp" alt="Chueh Avatar" class="avatar-img" decoding="async">
                </div>
            </div>
        </div>
    </section>

    <!-- ORIGIN -->
    <section id="origin">
        <div class="container">
            <h2 class="gs-reveal">SYSTEM ORIGIN</h2>
            <div class="stat-grid">
                <div class="stat-card gs-reveal">
                    <span class="stat-num">20XX</span>
                    <h3>Jazz Drums</h3>
                    <p style="margin: 0 auto; background: none; border: none; font-size: 0.9rem; color: #aaa;">
                        國中時期啟動的節奏引擎。這是一切律動的開始。
                    </p>
                </div>
                <div class="stat-card gs-reveal" style="border-color: var(--c-primary);">
                    <span class="stat-num" style="color: var(--c-primary);">5Yrs</span>
                    <h3>Handpan</h3>
                    <p style="margin: 0 auto; background: none; border: none; font-size: 0.9rem; color: #aaa;">
                        五年後的相遇。被空靈、療癒卻充滿節奏的特性深深吸引。
                    </p>
                </div>
                <div class="stat-card gs-reveal" style="border-color: var(--c-accent);">
                    <span class="stat-num" style="color: var(--c-accent);">10+</span>
                    <h3>Years EXP</h3>
                    <p style="margin: 0 auto; background: none; border: none; font-size: 0.9rem; color: #aaa;">
                        至今，這份熱愛已轉化為生活與職業的核心驅動力。
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- PHILOSOPHY -->
    <section id="philosophy">
        <div class="container" style="display: flex; flex-direction: column; align-items: flex-end; text-align: right;">
            <h2 class="gs-reveal" style="color: #fff; -webkit-text-stroke: 1px var(--c-primary);">CORE RESONANCE</h2>
            <p class="gs-reveal" style="border-left: none; border-right: 3px solid var(--c-accent);">
                手碟最迷人之處，在於它既能療癒心靈，又保有強烈的節奏靈魂。<br>
                在這裡，我們不只學琴，更是在找尋一種讓自己快樂與平靜的共鳴。
            </p>
            <p class="gs-reveal" style="border-left: none; border-right: 3px solid var(--c-accent); margin-top: 1rem;">
                希望這個地方，會讓你覺得手碟是一個很親切的存在，<br>
                慢慢認識之後，能帶給你一些快樂和溫暖。
            </p>
        </div>
    </section>

    <!-- GALLERY -->
    <section id="gallery-sec">
        <div class="container">
            <h2 class="gs-reveal">MEMORY FRAGMENTS</h2>
            <p class="gs-reveal">紀錄敲擊的聲音、練習片段，以及生活裡冒出的迷因。</p>

            <div class="gallery-container gs-reveal">
                <img src="/assets/img/guild/chueh/performance.webp" alt="Performance" class="gallery-img" data-speed="0.5">
                <div class="overlay-text">
                    <h3 style="font-family: var(--f-tech); color: var(--c-primary); margin: 0;">STAGE PERFORMANCE</h3>
                    <span style="color: #aaa; font-size: 0.8rem;">Visual Log #8841</span>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <section style="min-height: 50vh; justify-content: center; text-align: center;">
        <div class="container">
            <h2 style="font-size: 3rem;" class="gs-reveal">JOIN THE FREQUENCY</h2>
            <p class="gs-reveal" style="margin: 0 auto; text-align: center; border: none;">
                如果你聽了覺得有興趣，歡迎來找我一起玩玩看這個像飛碟的樂器。
            </p>

            <div class="social-links gs-reveal">
                <a href="https://www.threads.com/@handpan_chueh" target="_blank" class="social-btn"><i class="fa-brands fa-threads"></i></a>
                <a href="https://www.instagram.com/handpan_chueh/" target="_blank" class="social-btn"><i class="fa-brands fa-instagram"></i></a>
            </div>
        </div>
    </section>

    <!-- THREE.JS SCRIPT -->
    <script type="module">
        import * as THREE from 'three';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';

        // --- SCENE SETUP ---
        const container = document.getElementById('webgl-container');
        const scene = new THREE.Scene();

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 10;

        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // --- POST PROCESSING (BLOOM) ---
        const renderScene = new RenderPass(scene, camera);
        const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
        bloomPass.threshold = 0;
        bloomPass.strength = 1.2; // High bloom for explosion effect
        bloomPass.radius = 0.5;

        const composer = new EffectComposer(renderer);
        composer.addPass(renderScene);
        composer.addPass(bloomPass);

        // --- GEOMETRY: THE SONIC SPHERE ---
        const sphereGroup = new THREE.Group();
        scene.add(sphereGroup);

        const geom = new THREE.IcosahedronGeometry(4, 3);
        const pos = geom.attributes.position.array;
        const count = pos.length / 3;

        // Create particles
        const pGeom = new THREE.BufferGeometry();
        pGeom.setAttribute('position', geom.attributes.position);

        // Add random sizes
        const pSizes = new Float32Array(count);
        for(let i=0; i<count; i++) pSizes[i] = Math.random() * 0.15;
        pGeom.setAttribute('size', new THREE.BufferAttribute(pSizes, 1));

        const pMat = new THREE.PointsMaterial({
            color: 0x00ffff,
            size: 0.1,
            transparent: true,
            opacity: 0.8,
            blending: THREE.AdditiveBlending
        });
        const points = new THREE.Points(pGeom, pMat);
        sphereGroup.add(points);

        // Wireframe Overlay
        const wMat = new THREE.MeshBasicMaterial({
            color: 0xff00ff,
            wireframe: true,
            transparent: true,
            opacity: 0.1,
            blending: THREE.AdditiveBlending
        });
        const wireframe = new THREE.Mesh(geom, wMat);
        wireframe.scale.set(1.02, 1.02, 1.02);
        sphereGroup.add(wireframe);

        // Floating Shards (Debris)
        const shardsGeom = new THREE.BufferGeometry();
        const shardsCount = 300;
        const sPos = new Float32Array(shardsCount * 3);

        for(let i=0; i<shardsCount; i++) {
            const r = 6 + Math.random() * 15;
            const theta = Math.random() * Math.PI * 2;
            const phi = Math.acos((Math.random() * 2) - 1);

            sPos[i*3] = r * Math.sin(phi) * Math.cos(theta);
            sPos[i*3+1] = r * Math.sin(phi) * Math.sin(theta);
            sPos[i*3+2] = r * Math.cos(phi);
        }
        shardsGeom.setAttribute('position', new THREE.BufferAttribute(sPos, 3));
        const sMat = new THREE.PointsMaterial({
            color: 0xffd700,
            size: 0.1,
            transparent: true,
            blending: THREE.AdditiveBlending
        });
        const shards = new THREE.Points(shardsGeom, sMat);
        scene.add(shards);

        // --- ANIMATION ---
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();

            // Pulse Sphere
            const scale = 1 + Math.sin(time * 2) * 0.05;
            sphereGroup.scale.set(scale, scale, scale);
            sphereGroup.rotation.y += 0.002;
            sphereGroup.rotation.z = Math.sin(time * 0.5) * 0.1;

            // Rotate Shards
            shards.rotation.y = -time * 0.05;

            // Bloom Pulse
            bloomPass.strength = 1.0 + Math.sin(time * 3) * 0.3;

            composer.render();
        }
        animate();

        // --- INTERACTION ---
        let mouseX = 0;
        let mouseY = 0;
        document.addEventListener('mousemove', (e) => {
            mouseX = (e.clientX / window.innerWidth) * 2 - 1;
            mouseY = -(e.clientY / window.innerHeight) * 2 + 1;

            gsap.to(sphereGroup.rotation, {
                x: mouseY * 0.5,
                y: mouseX * 0.5,
                duration: 1
            });
        });

        // --- SCROLL EFFECTS ---
        gsap.registerPlugin(ScrollTrigger);

        // Move Camera
        gsap.to(camera.position, {
            z: 2, // Zoom in
            scrollTrigger: {
                trigger: "body",
                start: "top top",
                end: "bottom bottom",
                scrub: 1
            }
        });

        // Explode Sphere on Scroll
        // We move the shards outward based on scroll
        // Custom update for shards geometry
        ScrollTrigger.create({
            trigger: "body",
            start: "top top",
            end: "bottom bottom",
            onUpdate: (self) => {
                const progress = self.progress;
                shards.scale.set(1 + progress * 2, 1 + progress * 2, 1 + progress * 2);
                sphereGroup.scale.set(1 + progress * 0.5, 1 + progress * 0.5, 1 + progress * 0.5);
            }
        });

        // Parallax for Gallery Image
        gsap.utils.toArray('[data-speed]').forEach(el => {
            gsap.to(el, {
                y: (i, target) => -ScrollTrigger.maxScroll(window) * target.dataset.speed * 0.1,
                scrollTrigger: {
                    trigger: el,
                    start: "top bottom",
                    scrub: 0
                }
            });
        });

        // Text Reveals
        gsap.utils.toArray('.gs-reveal').forEach(el => {
            gsap.from(el, {
                y: 50, opacity: 0, duration: 1,
                scrollTrigger: {
                    trigger: el,
                    start: "top 85%"
                }
            });
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });

        // Preloader Logic
        window.onload = () => {
             setTimeout(() => {
                 const loader = document.getElementById('loader');
                 if(loader) {
                    gsap.to(loader, {
                        opacity: 0,
                        duration: 0.5,
                        onComplete: () => loader.remove()
                    });
                 }
                 ScrollTrigger.refresh();
             }, 800);
        };
    </script>

    <!-- P5.JS SCRIPT (OVERLAY) -->
    <script>
        function setup() {
            let canvas = createCanvas(windowWidth, windowHeight);
            canvas.parent('p5-container');
            frameRate(30);
            noCursor(); // Let CSS handle cursor
        }

        function draw() {
            clear();

            // Random glitch lines
            if(frameCount % 8 === 0) {
                stroke(0, 255, 255, 100);
                strokeWeight(1);
                let y = random(height);
                line(0, y, width, y);
            }

            // Random Tech Text
            if(frameCount % 15 === 0) {
                fill(0, 255, 255, 150);
                noStroke();
                textSize(12);
                text(Math.floor(random(1000,9999)), random(width), random(height));
            }

            // Mouse Ripple
            stroke(255, 0, 255, 50);
            strokeWeight(2);
            noFill();
            circle(mouseX, mouseY, (frameCount % 20) * 8);

            // Connecting line to cursor from random points
            if(frameCount % 10 === 0) {
                stroke(255, 255, 255, 20);
                line(mouseX, mouseY, random(width), random(height));
            }
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }
    </script>
</body>
</html>
