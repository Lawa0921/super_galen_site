<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸè‰²â­ï¸ãµãã‚“ãŸã˜ãƒ¼ | CMY Fantasy | KAWAII STAGE!</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&family=Kiwi+Maru:wght@500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        :root {
            --pink: #ff9ecc;
            --hot-pink: #ff69b4;
            --cyan: #a0e8ef;
            --yellow: #fffacd;
            --white: #ffffff;
            --text: #5d4037;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(135deg, #fff0f5, #e0ffff);
            color: var(--text);
            font-family: 'Zen Maru Gothic', sans-serif;
            overflow-x: hidden;
            width: 100vw;
        }

        #canvas-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        main {
            position: relative;
            z-index: 10;
            width: 100%;
            overflow: hidden;
        }

        /* --- HERO SECTION --- */
        .hero-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
        }

        .hero-bg-circle {
            position: absolute;
            width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%;
            z-index: -1;
            animation: pulse 3s infinite ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 0.6; }
        }

        .hero-title {
            font-family: 'Kiwi Maru', serif;
            font-weight: 900;
            font-size: clamp(3rem, 8vw, 6rem);
            color: var(--hot-pink);
            text-shadow: 4px 4px 0 var(--white), 8px 8px 0 var(--cyan);
            margin-bottom: 1rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-2deg); }
            50% { transform: translateY(-15px) rotate(2deg); }
        }

        .hero-subtitle {
            font-size: clamp(1.2rem, 3vw, 2rem);
            background: var(--white);
            color: var(--hot-pink);
            padding: 0.5rem 2rem;
            border-radius: 50px;
            border: 3px solid var(--cyan);
            box-shadow: 5px 5px 0 var(--pink);
            font-weight: bold;
        }

        /* --- IDOL CARDS --- */
        .idol-section {
            padding: 6rem 2rem;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 4rem;
        }

        .idol-card {
            background: var(--white);
            width: 100%;
            max-width: 450px;
            border-radius: 30px;
            padding: 2rem;
            position: relative;
            border: 4px solid var(--white);
            box-shadow: 10px 10px 0 var(--pink), inset 0 0 20px rgba(255,182,193,0.2);
            transition: transform 0.3s;
            overflow: hidden;
        }

        .idol-card:hover { transform: translateY(-10px) rotate(1deg); }

        .idol-card::before {
            content: 'â™¥';
            position: absolute;
            top: -10px; right: -10px;
            font-size: 4rem;
            color: var(--cyan);
            opacity: 0.3;
            transform: rotate(20deg);
        }

        .idol-avatar-frame {
            width: 180px; height: 180px;
            margin: 0 auto 1.5rem;
            border-radius: 50%;
            border: 6px solid var(--cyan);
            overflow: hidden;
            background: var(--white);
        }
        .idol-avatar-frame img { width: 100%; height: 100%; object-fit: cover; }

        .idol-name {
            font-size: 2.5rem;
            text-align: center;
            color: var(--hot-pink);
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 0 var(--white);
        }

        .idol-stats {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border: 2px dashed var(--pink);
        }

        .stat-row {
            display: flex; align-items: center; margin-bottom: 0.5rem; font-weight: bold; font-size: 0.9rem;
        }
        .stat-label { width: 60px; color: var(--text); }
        .stat-bar-bg { flex: 1; height: 12px; background: #eee; border-radius: 10px; overflow: hidden; }
        .stat-bar-fill { height: 100%; background: linear-gradient(90deg, var(--cyan), var(--hot-pink)); border-radius: 10px; }

        .idol-desc {
            font-size: 1rem;
            line-height: 1.6;
            text-align: center;
            color: var(--text);
        }

        /* --- RIBBON DECORATION --- */
        .ribbon-deco {
            position: absolute;
            top: -15px; left: 50%; transform: translateX(-50%);
            width: 120px; height: 40px;
            background: var(--hot-pink);
            color: white;
            display: flex; justify-content: center; align-items: center;
            font-weight: bold;
            clip-path: polygon(0 0, 100% 0, 100% 100%, 50% 70%, 0 100%);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }

        /* --- GALLERY --- */
        .gallery-section {
            padding: 4rem 2rem;
            text-align: center;
        }

        .section-title {
            font-size: 3rem;
            color: var(--cyan);
            text-shadow: 3px 3px 0 var(--white), 6px 6px 0 var(--pink);
            margin-bottom: 3rem;
            display: inline-block;
            position: relative;
        }

        .section-title::after {
            content: 'âœ¨';
            position: absolute; top: -20px; right: -30px; font-size: 2rem;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            max-width: 1000px;
            margin: 0 auto;
        }

        .gallery-item {
            aspect-ratio: 1;
            border-radius: 20px;
            overflow: hidden;
            border: 4px solid var(--white);
            box-shadow: 5px 5px 0 var(--cyan);
            transition: 0.3s;
            background: var(--white);
        }

        .gallery-item img {
            width: 100%; height: 100%; object-fit: cover; transition: 0.5s;
        }

        .gallery-item:hover { transform: scale(1.05) rotate(2deg); box-shadow: 8px 8px 0 var(--hot-pink); z-index: 5; }

        /* --- CTA / FOOTER --- */
        .cta-section {
            padding: 6rem 2rem;
            text-align: center;
            background: url('data:image/svg+xml;utf8,<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="2" cy="2" r="2" fill="%23ffffff" opacity="0.4"/></svg>');
        }

        .producer-card {
            background: var(--white);
            display: inline-block;
            padding: 3rem 4rem;
            border-radius: 40px;
            border: 5px solid var(--hot-pink);
            box-shadow: 0 10px 30px rgba(255,105,180,0.3);
            max-width: 800px;
        }

        .cta-btn {
            display: inline-block;
            margin-top: 2rem;
            background: linear-gradient(45deg, var(--hot-pink), var(--pink));
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            padding: 1rem 3rem;
            border-radius: 50px;
            text-decoration: none;
            box-shadow: 0 5px 15px rgba(255,105,180,0.4);
            transition: 0.3s;
            border: 2px solid white;
        }

        .cta-btn:hover {
            transform: scale(1.1) rotate(-2deg);
            box-shadow: 0 10px 25px rgba(255,105,180,0.6);
        }

        .social-row {
            margin-top: 2rem;
            display: flex; justify-content: center; gap: 1rem;
        }

        .social-icon {
            width: 50px; height: 50px;
            background: var(--cyan);
            color: white;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-weight: bold; text-decoration: none;
            transition: 0.2s;
            border: 2px solid white;
            box-shadow: 3px 3px 0 var(--text);
        }
        .social-icon:hover { transform: translateY(-5px); background: var(--hot-pink); }

        .nav-back {
            position: fixed;
            top: 1.5rem; left: 1.5rem;
            background: var(--white);
            color: var(--hot-pink);
            padding: 0.5rem 1.2rem;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
            border: 2px solid var(--pink);
            box-shadow: 3px 3px 0 var(--cyan);
            transition: 0.2s;
            z-index: 100;
        }
        .nav-back:hover { transform: scale(1.1); box-shadow: 5px 5px 0 var(--cyan); }

        /* Loader */
        #loader {
            position: fixed; inset: 0; background: var(--pink); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.8s;
        }
        .heart-beat { font-size: 4rem; animation: beat 0.8s infinite; }
        @keyframes beat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }

    </style>
</head>
<body>

    <div id="loader"><div class="heart-beat">ğŸ’–</div></div>
    <a href="/guild/" class="nav-back">â† GUILD</a>
    <div id="canvas-container"></div>

    <main>
        <section class="hero-section">
            <div class="hero-bg-circle"></div>
            <h1 class="hero-title">åŸè‰²<br>ãµãã‚“ãŸã˜ãƒ¼</h1>
            <div class="hero-subtitle">KAWAII IDOL UNIT âœ¨ START!</div>
        </section>

        <section class="idol-section" id="idols">
            <!-- Xiao Miao -->
            <div class="idol-card">
                <div class="ribbon-deco">MEMBER</div>
                <div class="idol-avatar-frame">
                    <img src="/assets/img/guild/cmy_fantasy/gallery_1.webp" alt="Xiao Miao">
                </div>
                <h2 class="idol-name">ç­±å–µ</h2>
                <div class="idol-stats">
                    <div class="stat-row">
                        <span class="stat-label">èŒåº¦</span>
                        <div class="stat-bar-bg"><div class="stat-bar-fill" style="width: 95%"></div></div>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">é£Ÿé‡</span>
                        <div class="stat-bar-bg"><div class="stat-bar-fill" style="width: 90%"></div></div>
                    </div>
                </div>
                <p class="idol-desc">
                    å—¨å—¨ï¼æˆ‘æ˜¯ç­±å–µï¼ğŸ±<br>
                    é›–ç„¶çœ‹èµ·ä¾†å‘†å‘†çš„ï¼Œ<br>ä½†ç«™ä¸Šèˆå°å°±æœƒé–ƒé–ƒç™¼å…‰å–”ï¼âœ¨<br>
                    #åƒè²¨ #Cosplay #æ—¥ç³»å¶åƒ
                </p>
            </div>

            <!-- Ting Ting -->
            <div class="idol-card">
                <div class="ribbon-deco">MEMBER</div>
                <div class="idol-avatar-frame">
                    <img src="/assets/img/guild/cmy_fantasy/gallery_2.webp" alt="Ting Ting">
                </div>
                <h2 class="idol-name">å©·å©·</h2>
                <div class="idol-stats">
                    <div class="stat-row">
                        <span class="stat-label">å…ƒæ°£</span>
                        <div class="stat-bar-bg"><div class="stat-bar-fill" style="width: 98%"></div></div>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">èˆåŠ›</span>
                        <div class="stat-bar-bg"><div class="stat-bar-fill" style="width: 92%"></div></div>
                    </div>
                </div>
                <p class="idol-desc">
                    Helloï¼æˆ‘æ˜¯å©·å©·ï¼ğŸ’ƒ<br>
                    å……æ»¿æ´»åŠ›çš„èˆè¹ˆæ“”ç•¶ï¼<br>
                    è®“æˆ‘å€‘ä¸€èµ·å‰µé€ æœ€æ£’çš„å›æ†¶å§ï¼ğŸ’–<br>
                    #èˆè¹ˆ #èˆå° #å…ƒæ°£æ»¿æ»¿
                </p>
            </div>
        </section>

        <section class="gallery-section">
            <h2 class="section-title">STAGE MEMORIES</h2>
            <div class="gallery-grid">
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_1.webp"></div>
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_2.webp"></div>
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_3.webp"></div>
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_4.webp"></div>
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_5.webp"></div>
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_6.webp"></div>
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_7.webp"></div>
                <div class="gallery-item"><img src="/assets/img/guild/cmy_fantasy/gallery_8.webp"></div>
            </div>
        </section>

        <section class="cta-section">
            <div class="producer-card">
                <h2 style="color:var(--hot-pink); margin-bottom:1rem;">Dear Producer-san!</h2>
                <p style="font-size:1.2rem; line-height:1.6;">
                    æˆ‘å€‘æ˜¯ã€ŒåŸè‰²â­ï¸ãµãã‚“ãŸã˜ãƒ¼ã€ï¼<br>
                    å¸Œæœ›èƒ½ç”¨æˆ‘å€‘çš„è¡¨æ¼”ï¼Œå¸¶çµ¦ä½ æ»¿æ»¿çš„ç¬‘å®¹ï¼ğŸ˜Š<br>
                    <strong style="color:var(--cyan)">è«‹å¤šå¤šæŒ‡æ•™ï¼âœ¨</strong>
                </p>
                <div style="margin-top:1.5rem; font-size:0.9rem; color:#aaa;">
                    (è‹¥å¯ä»¥æ”¾å½±ç‰‡çš„è©±ï¼Œå¯å†æä¾›çµ¦æ‚¨ ><)
                </div>

                <a href="https://www.instagram.com/cmy_fantasy/" target="_blank" class="cta-btn">æˆç‚ºè£½ä½œäººï¼</a>

                <div class="social-row">
                    <a href="https://www.threads.com/@cmy_fantasy" target="_blank" class="social-icon">T</a>
                    <a href="https://www.instagram.com/cmy_fantasy/" target="_blank" class="social-icon">IG</a>
                    <a href="https://www.youtube.com/@cmy_fantasy" target="_blank" class="social-icon">YT</a>
                </div>
            </div>
        </section>
    </main>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { OutlinePass } from 'three/addons/postprocessing/OutlinePass.js';

        // --- Scene Setup ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        // Light pastel fog for depth
        scene.fog = new THREE.FogExp2(0xfff0f5, 0.02);

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
        camera.position.set(0, 0, 20);

        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // --- Toon Lighting ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);

        const dirLight = new THREE.DirectionalLight(0xffffff, 0.5);
        dirLight.position.set(10, 10, 10);
        scene.add(dirLight);

        // --- Falling Hearts/Stars (Instanced) ---
        const count = 300;
        const dummy = new THREE.Object3D();

        // Heart Shape
        const heartShape = new THREE.Shape();
        heartShape.moveTo(0, 0);
        heartShape.bezierCurveTo(0, 0, -0.5, 0.8, -1, 0.8);
        heartShape.bezierCurveTo(-2, 0.8, -2, -0.5, -2, -0.5);
        heartShape.bezierCurveTo(-2, -1.5, 0, -3, 0, -3);
        heartShape.bezierCurveTo(0, -3, 2, -1.5, 2, -0.5);
        heartShape.bezierCurveTo(2, -0.5, 2, 0.8, 1, 0.8);
        heartShape.bezierCurveTo(0.5, 0.8, 0, 0, 0, 0);

        const heartGeo = new THREE.ExtrudeGeometry(heartShape, { depth: 0.4, bevelEnabled: true, bevelSegments: 2, steps: 2, bevelSize: 0.1, bevelThickness: 0.1 });
        const heartMat = new THREE.MeshToonMaterial({ color: 0xff69b4 }); // Hot Pink
        const hearts = new THREE.InstancedMesh(heartGeo, heartMat, count);

        // Star Shape
        const starShape = new THREE.Shape();
        const pts = 5;
        const outerRad = 1.2;
        const innerRad = 0.6;
        for(let i=0; i<pts*2; i++) {
            const r = (i%2===0)? outerRad : innerRad;
            const a = (i / (pts*2)) * Math.PI * 2;
            starShape.lineTo(Math.cos(a)*r, Math.sin(a)*r);
        }
        const starGeo = new THREE.ExtrudeGeometry(starShape, { depth: 0.4, bevelEnabled: true, bevelSegments: 2, steps: 2, bevelSize: 0.1, bevelThickness: 0.1 });
        const starMat = new THREE.MeshToonMaterial({ color: 0x00ffff }); // Cyan
        const stars = new THREE.InstancedMesh(starGeo, starMat, count);

        // Init Positions
        const instances = [];
        for(let i=0; i<count; i++) {
            instances.push({
                x: (Math.random() - 0.5) * 60,
                y: (Math.random() - 0.5) * 60,
                z: (Math.random() - 0.5) * 40 - 10,
                rotSpeed: Math.random() * 0.05,
                fallSpeed: Math.random() * 0.1 + 0.02,
                type: Math.random() > 0.5 ? 'heart' : 'star'
            });
        }

        scene.add(hearts);
        scene.add(stars);

        // --- Animation Loop ---
        function animate() {
            requestAnimationFrame(animate);

            let hIdx = 0;
            let sIdx = 0;

            for(let i=0; i<count; i++) {
                const data = instances[i];

                // Fall animation
                data.y -= data.fallSpeed;
                if(data.y < -30) data.y = 30; // Reset to top

                dummy.position.set(data.x, data.y, data.z);
                dummy.rotation.x += data.rotSpeed;
                dummy.rotation.y += data.rotSpeed;
                dummy.scale.setScalar(0.5); // Smaller cute size
                dummy.updateMatrix();

                if(data.type === 'heart') {
                    hearts.setMatrixAt(hIdx++, dummy.matrix);
                } else {
                    stars.setMatrixAt(sIdx++, dummy.matrix);
                }
            }
            hearts.instanceMatrix.needsUpdate = true;
            stars.instanceMatrix.needsUpdate = true;

            // Camera subtle sway
            const t = Date.now() * 0.0005;
            camera.position.x = Math.sin(t) * 1;
            camera.position.y = Math.cos(t * 0.8) * 1;
            camera.lookAt(0, 0, 0);

            renderer.render(scene, camera);
        }
        animate();

        // --- GSAP ---
        window.addEventListener('load', () => {
            const loader = document.getElementById('loader');
            loader.style.opacity = '0';
            setTimeout(() => loader.remove(), 1000);

            gsap.registerPlugin(ScrollTrigger);

            // Pop-in cards
            gsap.utils.toArray('.idol-card').forEach((card, i) => {
                gsap.from(card, {
                    scrollTrigger: {
                        trigger: card,
                        start: "top 85%"
                    },
                    y: 100,
                    opacity: 0,
                    rotation: i % 2 === 0 ? -5 : 5,
                    duration: 0.8,
                    ease: "elastic.out(1, 0.5)"
                });
            });

            // Gallery bounce
            gsap.from(".gallery-item", {
                scrollTrigger: {
                    trigger: ".gallery-grid",
                    start: "top 80%"
                },
                scale: 0,
                opacity: 0,
                stagger: 0.05,
                duration: 0.5,
                ease: "back.out(2)"
            });
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
