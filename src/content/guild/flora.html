<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flora 芙老師 | 豐饒甜食店</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        :root {
            /* Warm Oven Palette */
            --c-bg: #F9F7F2;
            --c-oven-dark: #3E2723; /* Dark Chocolate */
            --c-oven-glass: rgba(20, 10, 5, 0.85);
            --c-heat: #FF7043; /* Heat Glow */
            --c-gold: #FFC107; /* Burnished Gold */

            --c-matcha: #A4C639; /* Fresh Matcha */
            --c-cream: #FFF8E1; /* Butter Cream */
            --c-bread: #D7CCC8; /* Flour/Dough */
            --c-cookie: #EFEBE9; /* Biscuit */

            --c-text: #5D4037;
            --c-accent: #C2185B; /* Berry Jam */

            --font-display: 'Cinzel', serif;
            --font-body: 'Noto Serif TC', serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--c-bg);
            color: var(--c-text);
            font-family: var(--font-body);
            overflow-x: hidden;
            opacity: 0;
            transition: opacity 1s ease;
            cursor: default;
        }

        body.loaded {
            opacity: 1;
        }

        /* --- OVEN DOOR (HERO) --- */
        #oven-door {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100vh;
            z-index: 100;
            perspective: 1000px;
            pointer-events: none; /* Allow scroll through initially? No, we need to block clicks on content but allow scroll */
            /* We'll use pointer-events: none on the *door* itself once opened, but initially it covers */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .door-panel {
            width: 100%; height: 100%;
            background: radial-gradient(circle at center, rgba(62, 39, 35, 0.9), var(--c-oven-dark));
            border: 20px solid #281815;
            box-shadow: inset 0 0 100px rgba(0,0,0,0.8);
            position: absolute;
            top: 0; left: 0;
            transform-origin: top center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .door-glass {
            position: absolute;
            top: 50px; bottom: 50px; left: 50px; right: 50px;
            background: rgba(255, 160, 122, 0.05);
            border-radius: 20px;
            border: 2px solid rgba(255,255,255,0.1);
            box-shadow: 0 0 50px rgba(255, 112, 67, 0.2);
            pointer-events: auto; /* Catch clicks if needed */
        }

        .door-handle {
            width: 60%;
            height: 40px;
            background: linear-gradient(90deg, #5D4037, #8D6E63, #5D4037);
            border-radius: 20px;
            position: absolute;
            bottom: 15%;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        .oven-title {
            font-family: var(--font-display);
            color: var(--c-gold);
            font-size: clamp(2rem, 5vw, 4rem);
            text-shadow: 0 0 20px rgba(255, 193, 7, 0.4);
            z-index: 2;
            text-align: center;
            letter-spacing: 0.1em;
        }

        .oven-hint {
            color: rgba(255,255,255,0.6);
            margin-top: 1rem;
            font-size: 1.2rem;
            animation: pulse 2s infinite;
            z-index: 2;
        }

        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* --- CONTENT WRAPPERS (PASTRIES) --- */
        #content-layer {
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            padding-top: 100vh; /* Spacer for the "Opening" scroll */
            padding-bottom: 20vh;
        }

        .pastry-card {
            position: relative;
            margin-bottom: 15vh;
            padding: 4rem;
            color: var(--c-text);
            transition: transform 0.3s ease;
        }

        /* 1. CHEF COOKIE (Avatar + Intro) */
        .card-cookie {
            background: var(--c-cookie);
            border-radius: 50% 50% 45% 55% / 55% 45% 60% 40%; /* Organic Cookie Shape */
            box-shadow:
                inset 10px 10px 30px rgba(255,255,255,0.8),
                inset -10px -10px 30px rgba(93, 64, 55, 0.1),
                15px 15px 40px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            max-width: 800px;
            margin-left: auto; margin-right: auto;
            border: 8px solid rgba(255,255,255,0.4);
        }

        /* The "Chip" decorations */
        .card-cookie::before {
            content: ''; position: absolute; top: 15%; right: 20%;
            width: 40px; height: 30px; background: #5D4037; border-radius: 50%; opacity: 0.8;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }
        .card-cookie::after {
            content: ''; position: absolute; bottom: 20%; left: 15%;
            width: 35px; height: 35px; background: #5D4037; border-radius: 50%; opacity: 0.8;
             box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        /* 2. STATS BREAD (Loaf) */
        .card-bread {
            background: #EFEBE9;
            border-radius: 40px 40px 100px 100px / 120px 120px 30px 30px; /* Loaf Top */
            box-shadow:
                0 20px 0 #D7CCC8, /* Crust Thickness */
                0 30px 40px rgba(0,0,0,0.15);
            padding: 5rem 3rem 3rem;
            max-width: 700px;
            margin-left: auto; margin-right: auto;
            position: relative;
        }

        /* Bread lines */
        .card-bread .crust-line {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 80%; height: 100%; border-radius: inherit;
            border-top: 4px solid rgba(93, 64, 55, 0.1);
            pointer-events: none;
        }

        /* 3. ALCHEMY CAKE (Layered) */
        .card-cake {
            background: linear-gradient(to bottom, #FFF9C4 0%, #FFF9C4 30%, #FFECB3 30%, #FFECB3 60%, #FFE082 60%, #FFE082 100%);
            border-radius: 20px 100px 20px 20px; /* Wedge-ish */
            padding: 0;
            overflow: hidden;
            box-shadow: 10px 10px 30px rgba(0,0,0,0.1);
            max-width: 900px;
            margin-left: auto; margin-right: auto;
        }

        .cake-frosting {
            background: white;
            padding: 3rem;
            border-bottom: 8px solid var(--c-matcha); /* Filling layer */
        }

        .cake-body {
            padding: 3rem;
        }

        /* AVATAR STYLING */
        .chef-avatar-container {
            width: 250px; height: 250px;
            margin-bottom: 2rem;
            position: relative;
        }

        .chef-avatar {
            width: 100%; height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 6px solid white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        .chef-hat {
            position: absolute;
            top: -40px; right: -20px;
            font-size: 4rem;
            color: white;
            filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.2));
            transform: rotate(15deg);
        }

        /* TYPOGRAPHY OVERRIDES */
        h2 {
            font-family: var(--font-display);
            color: var(--c-text);
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .card-cookie h2 { color: var(--c-matcha); }
        .card-bread h2 { color: #8D6E63; }
        .card-cake h2 { color: #C2185B; }

        p { line-height: 1.8; font-size: 1.1rem; }

        /* STAT BARS (Flour Dust Style) */
        .stat-bar-container {
            background: rgba(0,0,0,0.05);
            border-radius: 20px;
            height: 12px;
            margin: 1rem 0 2rem;
            overflow: hidden;
        }
        .stat-bar {
            height: 100%;
            background: var(--c-matcha);
            border-radius: 20px;
            width: 0%;
            background-image: linear-gradient(45deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent);
            background-size: 20px 20px;
        }

        /* GALLERY GRID (Waffle) */
        .waffle-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            background: #D7CCC8;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: inset 2px 2px 10px rgba(0,0,0,0.1);
        }
        .waffle-item img {
            width: 100%; height: 250px; object-fit: cover;
            border-radius: 8px;
            transition: transform 0.3s;
        }
        .waffle-item:hover img { transform: scale(1.02); }

        /* THREE.JS CANVAS */
        #canvas-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
        }

        /* FOOTER */
        .footer-card {
            text-align: center;
            padding: 4rem;
            margin-top: 10vh;
        }

        .social-btn {
            display: inline-flex; width: 60px; height: 60px;
            border-radius: 50%; background: var(--c-matcha); color: white;
            align-items: center; justify-content: center; font-size: 1.5rem;
            margin: 0 1rem; text-decoration: none;
            transition: transform 0.2s;
        }
        .social-btn:hover { transform: scale(1.1) rotate(10deg); }

        /* LOADER */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--c-bg); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            font-family: var(--font-display); font-size: 2rem; color: var(--c-matcha);
        }

        /* Responsive */
        @media(max-width: 768px) {
            .pastry-card { padding: 2rem; border-radius: 20px !important; margin: 2rem 1rem; }
            .waffle-grid { grid-template-columns: 1fr; }
        }

    </style>
</head>
<body>

    <div id="loader">FLORA'S PATISSERIE</div>

    <!-- OVEN DOOR -->
    <div id="oven-door">
        <div class="door-panel">
            <div class="door-glass"></div>
            <div class="door-handle"></div>
            <h1 class="oven-title">FLORA<br><span style="font-size: 0.5em; color: white;">The Sweet Alchemy</span></h1>
            <div class="oven-hint"><i class="fa-solid fa-chevron-down"></i> SCROLL TO OPEN <i class="fa-solid fa-chevron-down"></i></div>
        </div>
    </div>

    <!-- 3D BACKGROUND -->
    <div id="canvas-container"></div>

    <!-- SCROLL CONTENT -->
    <div id="content-layer">

        <!-- SECTION 1: CHEF COOKIE -->
        <div class="pastry-card card-cookie">
            <div class="chef-avatar-container">
                <img src="/assets/img/guild/flora/profile.webp" class="chef-avatar" alt="Flora">
                <i class="fa-solid fa-hat-chef chef-hat"></i>
            </div>
            <h2>Master Chef Flora</h2>
            <p>
                我是 <span style="color: var(--c-matcha); font-weight: bold;">Flora 芙老師</span>，品牌是豐饒甜食店。<br>
                在甜點領域深耕 17 年，從台灣到海外，走過教學、研發、品牌經營三條戰線。
            </p>
            <p style="margin-top: 1rem; font-style: italic; color: #8D6E63;">
                "甜點是通往幸福的最短途徑，是連結人、土地與情感的最佳入口。"
            </p>
        </div>

        <!-- SECTION 2: STATS BREAD -->
        <div class="pastry-card card-bread">
            <div class="crust-line"></div>
            <h2>Ingredient Analysis</h2>

            <div style="margin-bottom: 1.5rem;">
                <div style="display:flex; justify-content:space-between; font-weight:bold;"><span>SWEETNESS</span> <span>100%</span></div>
                <div class="stat-bar-container"><div class="stat-bar" style="width: 100%;"></div></div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <div style="display:flex; justify-content:space-between; font-weight:bold;"><span>R&D PRECISION</span> <span>98%</span></div>
                <div class="stat-bar-container"><div class="stat-bar" style="width: 98%;"></div></div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <div style="display:flex; justify-content:space-between; font-weight:bold;"><span>TEACHING</span> <span>95%</span></div>
                <div class="stat-bar-container"><div class="stat-bar" style="width: 95%;"></div></div>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <div style="display:flex; justify-content:space-between; font-weight:bold;"><span>CULTURE</span> <span>99%</span></div>
                <div class="stat-bar-container"><div class="stat-bar" style="width: 99%;"></div></div>
            </div>
        </div>

        <!-- SECTION 3: SERVICE CAKE -->
        <div class="pastry-card card-cake">
            <div class="cake-frosting">
                <h2>The Sweet Menu</h2>
                <p>把「產品、教育、文化」整合成一套有策略的內容系統。</p>
            </div>
            <div class="cake-body">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                    <div>
                        <h3 style="color: var(--c-accent);"><i class="fa-solid fa-utensils"></i> Product</h3>
                        <p>從菜單設計、成本結構到定價邏輯。</p>
                    </div>
                    <div>
                        <h3 style="color: var(--c-accent);"><i class="fa-solid fa-graduation-cap"></i> Education</h3>
                        <p>跨越年齡與國界的專業教學模組。</p>
                    </div>
                    <div style="grid-column: span 2;">
                        <h3 style="color: var(--c-accent);"><i class="fa-solid fa-book-atlas"></i> Culture</h3>
                        <p>用企業經營的角度操作甜點，連結土地情感。</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 4: SHOWCASE WAFFLE -->
        <div class="pastry-card" style="background: transparent; box-shadow: none; padding: 0;">
            <div class="waffle-grid">
                <div class="waffle-item"><img src="/assets/img/guild/flora/showcase_tree.webp"></div>
                <div class="waffle-item"><img src="/assets/img/guild/flora/showcase_slice.webp"></div>
                <div class="waffle-item"><img src="/assets/img/guild/flora/showcase_floral.webp"></div>
                <div class="waffle-item"><img src="/assets/img/guild/flora/showcase_cupcake.webp"></div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer-card">
            <h2>Connect with Flora</h2>
            <div style="margin-top: 2rem;">
                <a href="https://www.threads.net/@flora_setsuna_tw" target="_blank" class="social-btn"><i class="fa-brands fa-threads"></i></a>
                <a href="https://www.facebook.com/FlowGateau" target="_blank" class="social-btn"><i class="fa-brands fa-facebook-f"></i></a>
            </div>
            <p style="margin-top: 2rem; opacity: 0.6; font-size: 0.9rem;">Made with love by SuperGalen's Dungeon</p>
        </div>

    </div>

    <!-- SCRIPTS -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/ScrollTrigger.min.js"></script>

    <script type="module">
        import * as THREE from 'three';

        // --- GSAP SETUP ---
        gsap.registerPlugin(ScrollTrigger);

        // --- THREE.JS SCENE ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0xF9F7F2, 0.02); // Cream fog

        const camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 0, 10);

        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // --- INGREDIENTS (SPRITES) ---
        function createIconTexture(iconChar, color) {
            const canvas = document.createElement('canvas');
            canvas.width = 128; canvas.height = 128;
            const ctx = canvas.getContext('2d');
            ctx.font = '900 80px "Font Awesome 6 Free"';
            ctx.fillStyle = color;
            ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
            ctx.fillText(iconChar, 64, 64);
            return new THREE.CanvasTexture(canvas);
        }

        const icons = [
            { char: '\uf1fd', color: '#A4C639' }, // Cake (Matcha)
            { char: '\uf810', color: '#FF7043' }, // Cupcake (Orange)
            { char: '\uf563', color: '#8D6E63' }, // Cookie (Choco)
            { char: '\uf094', color: '#FDD835' }, // Lemon (Yellow)
        ];

        const sprites = [];
        const group = new THREE.Group();
        scene.add(group);

        // Wait for fonts
        document.fonts.ready.then(() => {
            const materials = icons.map(i => new THREE.SpriteMaterial({
                map: createIconTexture(i.char, i.color),
                transparent: true, opacity: 0.8
            }));

            for(let i=0; i<60; i++) {
                const sprite = new THREE.Sprite(materials[Math.floor(Math.random()*materials.length)]);
                // Spread wide and tall
                sprite.position.set(
                    (Math.random() - 0.5) * 30,
                    (Math.random() - 0.5) * 50 - 10, // Start lower
                    (Math.random() - 0.5) * 20
                );
                const scale = Math.random() * 0.8 + 0.5;
                sprite.scale.set(scale, scale, 1);

                sprite.userData = {
                    speedY: Math.random() * 0.02 + 0.01,
                    wobble: Math.random() * Math.PI * 2
                };

                group.add(sprite);
                sprites.push(sprite);
            }
        });

        // --- ANIMATION LOOP ---
        function animate() {
            sprites.forEach(s => {
                s.position.y += s.userData.speedY; // Float up like heat/bubbles
                s.position.x += Math.sin(Date.now() * 0.001 + s.userData.wobble) * 0.01;

                // Reset if too high
                if(s.position.y > 20) s.position.y = -30;
            });

            group.rotation.y = window.scrollY * 0.0005; // Rotate scene on scroll

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }
        animate();

        // --- SCROLL INTERACTION (OVEN & CARDS) ---

        // 1. OVEN DOOR OPENING
        const doorTimeline = gsap.timeline({
            scrollTrigger: {
                trigger: "body",
                start: "top top",
                end: "500px top", // Short distance to open
                scrub: 1,
                pin: false
            }
        });

        doorTimeline
            .to(".door-panel", {
                rotationX: -90, // Rotate down like oven door
                y: 100,
                opacity: 0,
                ease: "power2.in"
            })
            .to("#oven-door", { pointerEvents: "none" }, "<"); // Allow clicks through

        // 2. PASTRY CARDS ENTRANCE
        gsap.utils.toArray('.pastry-card').forEach((card, i) => {
            // Parallax entrance
            const dir = i % 2 === 0 ? -100 : 100; // Alternating sides
            const rot = i % 2 === 0 ? -5 : 5;

            gsap.from(card, {
                x: dir,
                rotation: rot,
                opacity: 0,
                duration: 1.5,
                ease: "elastic.out(1, 0.7)",
                scrollTrigger: {
                    trigger: card,
                    start: "top 80%",
                }
            });
        });

        // 3. STAT BARS FILL
        gsap.utils.toArray('.stat-bar').forEach(bar => {
            gsap.from(bar, {
                scaleX: 0,
                transformOrigin: "left center",
                duration: 1.5,
                scrollTrigger: {
                    trigger: bar,
                    start: "top 90%"
                }
            });
        });

        // LOADER
        window.addEventListener('load', () => {
            document.body.classList.add('loaded');
            gsap.to('#loader', { opacity: 0, duration: 0.5, onComplete: () => document.getElementById('loader').remove() });
        });

        // RESIZE
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>
</html>