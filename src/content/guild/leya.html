<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leya | The Prism Core</title>
    <meta name="description" content="A brave heart drifting in the universe. Rational yet emotional.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;500;700&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        :root {
            --bg-color: #f8f9fa;
            --text-color: #2d3436;
            --accent-gold: #D4AF37;
            --accent-blue: #a8d0e6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Noto Serif TC', serif;
            overflow-x: hidden;
            width: 100vw;
            scrollbar-width: none;
        }
        body::-webkit-scrollbar { display: none; }

        /* --- Canvas Wrapper --- */
        #p5-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* --- Scroll Spacer --- */
        #scroll-spacer {
            height: 500vh;
            width: 100%;
            position: absolute;
            top: 0; left: 0;
            z-index: -1;
            pointer-events: none;
        }

        /* --- Content Layout --- */
        .content-section {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.5s ease;
            display: flex;
            align-items: center; /* Vertical Center */
            padding: 5vw;
        }

        .content-section.active {
            pointer-events: auto;
        }

        /* --- Content Positioning (Desktop) --- */
        /* Bio: Left */
        #sec-bio { justify-content: flex-start; }

        /* Services: Right */
        #sec-services { justify-content: flex-end; }

        /* Hero & Goals: Center */
        #sec-hero, #sec-goals { justify-content: center; }

        /* --- Glass Cards --- */
        .content-card {
            background: rgba(255, 255, 255, 0.5); /* More transparent */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            padding: 2.5rem;
            border-radius: 4px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
            position: relative;
            max-width: 500px; /* Narrower to allow space for crystal */
            width: 100%;
        }

        /* Prismatic Border */
        .content-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 2px;
            background: linear-gradient(90deg, #ff9a9e, #a18cd1, #fbc2eb);
        }

        /* --- Typography --- */
        .hero-title {
            font-family: 'Cinzel', serif;
            font-size: clamp(4rem, 10vw, 8rem);
            color: #2d3436;
            letter-spacing: 0.2em;
            margin-bottom: 1rem;
            text-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        .hero-subtitle {
            font-size: 1.2rem;
            color: var(--accent-gold);
            letter-spacing: 0.5em;
            text-transform: uppercase;
            text-align: center;
        }

        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: #2d3436;
            margin-bottom: 1.5rem;
            display: inline-block;
            border-bottom: 1px solid var(--accent-gold);
        }

        p {
            font-size: 1.05rem;
            line-height: 1.8;
            margin-bottom: 1.2rem;
            color: #444;
            text-align: justify;
        }

        .highlight {
            background: linear-gradient(120deg, rgba(212, 175, 55, 0.2) 0%, rgba(212, 175, 55, 0) 100%);
            padding: 0 4px;
            font-weight: 500;
        }

        /* --- Footer --- */
        .fixed-footer {
            position: fixed;
            bottom: 2rem;
            left: 0;
            width: 100%;
            text-align: center;
            z-index: 100;
            pointer-events: none;
        }
        .socials {
            pointer-events: auto;
            display: inline-flex;
            gap: 1.5rem;
            background: rgba(255,255,255,0.7);
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            backdrop-filter: blur(5px);
        }
        .social-btn {
            font-size: 1.5rem;
            color: #555;
            transition: transform 0.3s;
        }
        .social-btn:hover { color: var(--accent-gold); transform: scale(1.1); }

        .nav-back {
            position: fixed; top: 2rem; left: 2rem; z-index: 100;
            color: #555; text-decoration: none;
            font-family: 'Cinzel', serif; font-weight: 700;
            opacity: 0.6; transition: opacity 0.3s;
        }
        .nav-back:hover { opacity: 1; color: var(--accent-gold); }

        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #f8f9fa; z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            color: var(--accent-gold); font-family: 'Cinzel'; letter-spacing: 0.2em;
        }

        @media (max-width: 900px) {
            .content-section { justify-content: center !important; align-items: flex-end !important; padding-bottom: 20vh; }
            .content-card { max-width: 90%; padding: 1.5rem; background: rgba(255,255,255,0.8); }
            /* On mobile, Crystal will move UP, Content DOWN */
        }
    </style>
</head>
<body>

    <div id="loader">POLISHING...</div>
    <a href="/guild/" class="nav-back">GUILD</a>

    <div id="p5-container"></div>
    <div id="scroll-spacer"></div>

    <!-- Section 1: Hero -->
    <div id="sec-hero" class="content-section">
        <div>
            <h1 class="hero-title">LEYA</h1>
            <div class="hero-subtitle">The Prism Soul</div>
        </div>
    </div>

    <!-- Section 2: Bio (Left) -->
    <div id="sec-bio" class="content-section">
        <div class="content-card">
            <h2 class="section-title">Refraction</h2>
            <p>
                我是 <span class="highlight">Leya</span>。30歲以前，三分之一的時間漂泊海外。旅程告一段落後，回到台灣面對的是內心的衝擊與重新歸零。
            </p>
            <p>
                無婚姻、無子女、無房無車，但我擁有一顆<span class="highlight">勇敢的心</span>。
                花了一年時間調適，終於在混亂中看見了光折射的方向。
            </p>
        </div>
    </div>

    <!-- Section 3: Services (Right) -->
    <div id="sec-services" class="content-section">
        <div class="content-card">
            <h2 class="section-title">Facets</h2>
            <p>
                <i class="fa-solid fa-fire-flame-curved" style="color: var(--accent-gold);"></i> <strong>勇敢的催化劑</strong><br>
                如果你正處於人生的十字路口，我希望能成為你的勇氣參照物——晚一點開始，真的沒關係。
            </p>
            <p>
                <i class="fa-solid fa-plane" style="color: #a18cd1;"></i> <strong>流浪的視角</strong><br>
                從澳洲打工度假到西班牙朝聖之路，我們一起探索世界的邊界。
            </p>
        </div>
    </div>

    <!-- Section 4: Goals (Center/Bottom) -->
    <div id="sec-goals" class="content-section">
        <div class="content-card">
            <h2 class="section-title">Reflection</h2>
            <p style="text-align: center; color: #777; font-style: italic;">
                「慢慢走也可以，走在自己要的路上都會發光。」
            </p>
            <div style="display: flex; justify-content: space-around; margin-top: 1.5rem;">
                <div style="text-align: center;"><i class="fa-solid fa-earth-oceania" style="font-size: 2rem; color: #a18cd1;"></i><div style="font-size:0.8rem; margin-top:0.5rem">Australia</div></div>
                <div style="text-align: center;"><i class="fa-solid fa-person-hiking" style="font-size: 2rem; color: #ff9a9e;"></i><div style="font-size:0.8rem; margin-top:0.5rem">Spain</div></div>
                <div style="text-align: center;"><i class="fa-brands fa-youtube" style="font-size: 2rem; color: #ff6b6b;"></i><div style="font-size:0.8rem; margin-top:0.5rem">Channel</div></div>
            </div>
        </div>
    </div>

    <div class="fixed-footer">
        <div class="socials">
            <a href="https://www.threads.net/@goodays.leya" target="_blank" class="social-btn"><i class="fa-brands fa-threads"></i></a>
            <a href="https://www.instagram.com/goodays.leya/" target="_blank" class="social-btn"><i class="fa-brands fa-instagram"></i></a>
        </div>
    </div>

    <script>
        // --- State ---
        let scrollProgress = 0;
        let crystalState = {
            rotY: 0,
            rotX: 0,
            expansion: 0,
            spinSpeed: 0.005,
            x: 0, // X Offset
            y: 0, // Y Offset
            scale: 1
        };

        // --- p5.js ---
        const sketch = (p) => {
            const colors = [
                p.color(255, 182, 193), p.color(173, 216, 230),
                p.color(255, 215, 0), p.color(221, 160, 221)
            ];

            p.setup = () => {
                const canvas = p.createCanvas(p.windowWidth, p.windowHeight, p.WEBGL);
                canvas.parent('p5-container');
                p.setAttributes('alpha', true);
                p.noStroke();
            };

            p.draw = () => {
                p.clear();

                // Lights
                p.ambientLight(150);
                p.pointLight(255, 255, 255, p.mouseX-p.width/2, p.mouseY-p.height/2, 300);

                let t = p.frameCount * 0.02;
                p.pointLight(255, 0, 255, 500 * Math.cos(t), 0, 500 * Math.sin(t));
                p.pointLight(0, 255, 255, 0, 500 * Math.cos(t * 1.5), 500 * Math.sin(t * 1.5));

                p.push();

                // --- Positional Logic (The Fix) ---
                // Move Crystal based on State
                // Convert percentage offset to pixels
                p.translate(crystalState.x * p.width, crystalState.y * p.height, 0);
                p.scale(crystalState.scale);

                // Rotation
                let targetRotY = scrollProgress * p.TWO_PI;
                crystalState.rotY = p.lerp(crystalState.rotY, targetRotY, 0.1) + crystalState.spinSpeed;
                p.rotateY(crystalState.rotY);
                p.rotateX(p.frameCount * 0.002 + p.sin(scrollProgress * p.PI) * 0.5);

                p.specularMaterial(255);
                p.shininess(100);

                // Core
                p.push();
                p.fill(255, 255, 255, 230);
                drawJewel(p, 70); // Bigger core
                p.pop();

                // Shards
                let expansion = crystalState.expansion * 200;
                for(let i=0; i<8; i++) {
                    p.push();
                    let angle = (p.TWO_PI / 8) * i;
                    let r = 90 + expansion * 0.5;
                    let x = Math.cos(angle) * r;
                    let z = Math.sin(angle) * r;
                    let y = Math.sin(angle * 3 + t) * 30 + (i%2===0 ? expansion : -expansion);

                    p.translate(x, y, z);
                    p.rotateY(angle);
                    p.rotateX(t + i);

                    let col = colors[(i + Math.floor(t * 0.5)) % colors.length];
                    col.setAlpha(180);
                    p.fill(col);

                    if (i % 2 === 0) p.cone(25, 70);
                    else p.ellipsoid(25, 35, 15);
                    p.pop();
                }
                p.pop();
            };

            function drawJewel(p, r) {
                p.push();
                p.scale(1, 1.5, 1);
                p.rotateX(p.QUARTER_PI);
                p.rotateZ(p.QUARTER_PI);
                p.box(r);
                p.pop();
            }

            p.windowResized = () => {
                p.resizeCanvas(p.windowWidth, p.windowHeight);
            };
        };

        // --- GSAP ---
        function initApp() {
            gsap.registerPlugin(ScrollTrigger);

            const isMobile = window.innerWidth < 900;

            // Main Timeline
            let tl = gsap.timeline({
                scrollTrigger: {
                    trigger: "#scroll-spacer",
                    start: "top top",
                    end: "bottom bottom",
                    scrub: 0.5,
                    onUpdate: (self) => { scrollProgress = self.progress; }
                }
            });

            // Helper
            function toggle(id, show) {
                const el = document.querySelector(id);
                gsap.to(el, { opacity: show ? 1 : 0, duration: 0.5, pointerEvents: show ? 'auto' : 'none' });
                if(show) el.classList.add('active'); else el.classList.remove('active');
            }

            // Hero (0-15%)
            // Crystal Center
            gsap.set(crystalState, { x: 0, y: 0, scale: 1 });
            gsap.set("#sec-hero", { opacity: 1 });

            // 1. Bio (20-45%)
            // Text Left -> Crystal Right
            ScrollTrigger.create({
                trigger: "#scroll-spacer",
                start: "20% top",
                end: "45% top",
                onEnter: () => {
                    toggle("#sec-hero", false);
                    toggle("#sec-bio", true);
                    gsap.to(crystalState, {
                        x: isMobile ? 0 : 0.25, // Right on Desktop
                        y: isMobile ? -0.2 : 0,  // Up on Mobile
                        scale: 1.2,
                        expansion: 0.6,
                        spinSpeed: 0.02
                    });
                },
                onLeaveBack: () => {
                    toggle("#sec-hero", true);
                    toggle("#sec-bio", false);
                    gsap.to(crystalState, { x: 0, y: 0, scale: 1, expansion: 0, spinSpeed: 0.005 });
                }
            });

            // 2. Services (50-75%)
            // Text Right -> Crystal Left
            ScrollTrigger.create({
                trigger: "#scroll-spacer",
                start: "50% top",
                end: "75% top",
                onEnter: () => {
                    toggle("#sec-bio", false);
                    toggle("#sec-services", true);
                    gsap.to(crystalState, {
                        x: isMobile ? 0 : -0.25, // Left on Desktop
                        y: isMobile ? -0.2 : 0,
                        scale: 1.2,
                        expansion: 0.3,
                        spinSpeed: 0.05
                    });
                },
                onLeaveBack: () => {
                    toggle("#sec-services", false);
                    toggle("#sec-bio", true);
                    gsap.to(crystalState, {
                        x: isMobile ? 0 : 0.25,
                        y: isMobile ? -0.2 : 0,
                        scale: 1.2,
                        expansion: 0.6,
                        spinSpeed: 0.02
                    });
                }
            });

            // 3. Goals (80-100%)
            // Text Center -> Crystal Up/Center
            ScrollTrigger.create({
                trigger: "#scroll-spacer",
                start: "80% top",
                end: "100% bottom",
                onEnter: () => {
                    toggle("#sec-services", false);
                    toggle("#sec-goals", true);
                    gsap.to(crystalState, {
                        x: 0,
                        y: -0.1, // Slightly Up
                        scale: 1.5, // Big
                        expansion: 0.8,
                        spinSpeed: 0.01
                    });
                },
                onLeaveBack: () => {
                    toggle("#sec-goals", false);
                    toggle("#sec-services", true);
                    gsap.to(crystalState, {
                        x: isMobile ? 0 : -0.25,
                        y: isMobile ? -0.2 : 0,
                        scale: 1.2,
                        expansion: 0.3,
                        spinSpeed: 0.05
                    });
                }
            });
        }

        window.addEventListener('load', () => {
            new p5(sketch);
            gsap.to("#loader", { opacity: 0, duration: 1, onComplete: () => {
                document.getElementById('loader').style.display = 'none';
                initApp();
            }});
        });
    </script>
</body>
</html>
