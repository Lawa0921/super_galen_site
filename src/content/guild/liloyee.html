<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liloyee | Angel's Dream Library</title>
    <meta name="description" content="Liloyee - å¥§æ•¸è€å¸«, ä½œå®¶, Cosplayer. Welcome to my dream world.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&family=Noto+Sans+TC:wght@300;400;700&family=Fredoka:wght@400;600&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <style>
        :root {
            --color-bg: #ffe6f2; /* Soft Pink (Start) */
            --color-text: #5d4037; /* Warm Brown */
            --color-accent: #ff9ecd; /* Hot Pink */
            --color-secondary: #a0e9ff; /* Sky Blue */
            --color-gold: #ffd700;
            --color-dark-bg: #1a0b2e; /* Deep Purple (End) */
            --color-neon-blue: #00f3ff;
            --color-neon-pink: #ff00ff;
            --font-main: 'Zen Maru Gothic', sans-serif;
            --font-body: 'Noto Sans TC', sans-serif;
            --font-tech: 'Share Tech Mono', monospace;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; cursor: none; }

        body {
            background-color: var(--color-bg);
            color: var(--color-text);
            font-family: var(--font-body);
            overflow-x: hidden;
            width: 100%;
            transition: background-color 1s ease, color 1s ease;
        }

        body.dark-mode {
            background-color: var(--color-dark-bg);
            color: #fff;
        }

        /* --- Canvas Background --- */
        #canvas-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* --- Magic Cursor --- */
        .cursor-dot {
            width: 12px; height: 12px;
            background-color: var(--color-gold);
            border-radius: 50%;
            position: fixed;
            top: 0; left: 0;
            z-index: 9999;
            pointer-events: none;
            box-shadow: 0 0 15px var(--color-gold), 0 0 30px var(--color-accent);
            mix-blend-mode: exclusion;
            transition: width 0.3s, height 0.3s, background-color 0.3s;
        }
        .cursor-dot.hover {
            width: 40px; height: 40px;
            background-color: rgba(255, 255, 255, 0.8);
            border: 2px solid var(--color-accent);
            mix-blend-mode: normal;
        }

        /* --- Layout --- */
        main { position: relative; z-index: 10; width: 100%; overflow: hidden; }

        section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 4rem 2rem;
            position: relative;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
        }

        /* --- Typography --- */
        h1, h2, h3 { font-family: var(--font-main); }

        h1 {
            font-size: clamp(4rem, 15vw, 9rem);
            font-weight: 700;
            color: transparent;
            background: linear-gradient(135deg, #fff 0%, #ff9ecd 50%, #a0e9ff 100%);
            -webkit-background-clip: text;
            background-clip: text;
            filter: drop-shadow(0px 0px 10px rgba(255, 158, 205, 0.6));
            margin-bottom: 1rem;
            line-height: 1.1;
            text-align: center;
        }

        h2 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            margin-bottom: 2rem;
            text-align: center;
            color: var(--color-accent);
            text-shadow: 3px 3px 0px rgba(255,255,255,0.5);
        }

        .dark-mode h2 {
            color: var(--color-neon-blue);
            text-shadow: 0 0 10px var(--color-neon-blue);
        }

        p { font-size: 1.1rem; line-height: 1.8; margin-bottom: 1.5rem; }

        /* --- Components --- */
        .glass-card {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(15px);
            border-radius: 30px;
            border: 2px solid rgba(255, 255, 255, 0.9);
            padding: 3rem;
            box-shadow: 0 10px 40px rgba(255, 158, 205, 0.2);
            transition: all 0.5s ease;
        }

        .dark-mode .glass-card {
            background: rgba(20, 10, 40, 0.6);
            border-color: rgba(160, 233, 255, 0.3);
            color: #e0e0e0;
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.2);
        }

        .role-badge {
            display: inline-block;
            background: white;
            color: var(--color-accent);
            border: 2px solid var(--color-accent);
            padding: 0.5rem 1.2rem;
            border-radius: 50px;
            margin: 0.3rem;
            font-weight: bold;
            transition: 0.3s;
        }
        .role-badge:hover {
            background: var(--color-accent);
            color: white;
            transform: scale(1.1);
        }

        /* --- Hero --- */
        .hero-content { text-align: center; position: relative; z-index: 20; }
        .avatar-container {
            width: 300px; height: 300px;
            border-radius: 50%;
            margin: 0 auto 2rem;
            position: relative;
            padding: 10px;
            background: linear-gradient(to right, var(--color-accent), var(--color-secondary));
            animation: spin-border 10s linear infinite;
        }
        .avatar-img {
            width: 100%; height: 100%;
            object-fit: cover;
            border-radius: 50%;
            border: 5px solid white;
        }

        /* --- Dream Lab --- */
        .lab-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }
        .analysis-box {
            font-family: var(--font-tech);
            border: 1px solid var(--color-secondary);
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }
        .analysis-box::before {
            content: '';
            position: absolute; top:0; left:0; width: 5px; height: 100%;
            background: var(--color-secondary);
        }
        .analysis-value { float: right; color: var(--color-accent); font-weight: bold; }

        /* --- Timeline (Horizontal) --- */
        #timeline {
            overflow: hidden;
            display: block; /* Override flex for horizontal scroll logic */
            height: auto;
            min-height: auto;
            padding: 0;
        }
        .timeline-wrapper {
            display: flex;
            width: 400%; /* 4 sections */
            height: 100vh;
        }
        .timeline-panel {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 4rem;
            border-right: 1px dashed rgba(255,255,255,0.3);
            flex-shrink: 0;
        }
        .timeline-year {
            font-size: 6rem;
            font-weight: 900;
            opacity: 0.2;
            position: absolute;
            z-index: -1;
        }

        /* --- Lucky Slot Machine --- */
        .slot-machine-container {
            background: #222;
            padding: 20px;
            border-radius: 20px;
            border: 4px solid var(--color-gold);
            display: inline-block;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.4);
        }
        .slot-window {
            background: white;
            height: 120px;
            width: 300px;
            border-radius: 10px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            font-size: 4rem;
            overflow: hidden;
            border: 4px inset #ccc;
            margin-bottom: 20px;
        }
        .slot-reel { text-align: center; width: 33%; }
        .spin-btn {
            background: var(--color-accent);
            color: white;
            border: none;
            padding: 1rem 3rem;
            font-size: 1.5rem;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 0 #d66ba0;
            transition: transform 0.1s;
        }
        .spin-btn:active { transform: translateY(5px); box-shadow: none; }

        /* --- Blind Box & Gallery --- */
        /* (Reused existing styles with minor tweaks) */
        .blind-box-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; width: 100%; perspective: 1000px; }
        .blind-box { aspect-ratio: 1; border-radius: 20px; transform-style: preserve-3d; transition: 0.6s; cursor: pointer; }
        .blind-box:hover { transform: translateY(-10px) rotateX(10deg); }
        .blind-box.opened { transform: rotateY(180deg); }
        .box-side { position: absolute; width:100%; height:100%; border-radius:20px; backface-visibility:hidden; display:flex; align-items:center; justify-content:center; flex-direction:column; padding:1rem; text-align:center; }
        .box-front { background: linear-gradient(135deg, var(--color-accent), #ffc2d1); color: white; border:4px solid white;}
        .box-back { background: white; transform: rotateY(180deg); color: var(--color-text); border:4px solid var(--color-accent); }

        .gallery-grid { columns: 3 250px; column-gap: 1.5rem; }
        .gallery-item { margin-bottom: 1.5rem; border-radius: 15px; overflow: hidden; break-inside: avoid; }
        .gallery-item img { width: 100%; display: block; transition: transform 0.5s; }
        .gallery-item:hover img { transform: scale(1.1); }

        footer { text-align: center; padding: 4rem 0; background: rgba(255,255,255,0.9); }

        @media (max-width: 768px) {
            .lab-grid { grid-template-columns: 1fr; }
            .timeline-wrapper { width: 100vw; flex-direction: column; height: auto; }
            .timeline-panel { height: 80vh; width: 100%; border-right: none; border-bottom: 1px dashed rgba(255,255,255,0.3); }
        }

    </style>
</head>
<body>
    <div class="cursor-dot"></div>
    <div id="canvas-container"></div>
    <a href="/guild/" class="nav-back" style="position: fixed; top: 2rem; left: 2rem; z-index: 100; color: var(--color-text); background: white; padding: 0.5rem 1rem; border-radius: 20px; text-decoration: none; font-weight: bold;"><i class="fa-solid fa-arrow-left"></i> Exit Dream</a>

    <main>
        <!-- 1. HERO -->
        <section id="hero">
            <div class="container hero-content">
                <div class="avatar-container">
                    <img src="/assets/img/guild/liloyee/avatar.webp" class="avatar-img">
                </div>
                <h1>Liloyee</h1>
                <div class="hero-tags">
                    <span class="role-badge"><i class="fa-solid fa-feather"></i> Writer</span>
                    <span class="role-badge"><i class="fa-solid fa-calculator"></i> Math Teacher</span>
                    <span class="role-badge"><i class="fa-solid fa-wand-magic-sparkles"></i> Cosplayer</span>
                </div>
            </div>
        </section>

        <!-- 2. INTRO & DREAM LAB -->
        <section id="dream-lab">
            <div class="container">
                <div class="glass-card lab-grid">
                    <div>
                        <h2>Dream Analyst <i class="fa-solid fa-flask" style="font-size: 0.6em;"></i></h2>
                        <p>ã€Œå¤¢è£¡çš„ä¸–ç•Œæœ‰é¡è‰²ã€æœ‰è§¸è¦ºã€æœ‰æº«åº¦ã€æœ‰ç—›è¦ºã€‚ã€</p>
                        <p>æˆ‘ç†±æ„›ç ”ç©¶è§£å¤¢ï¼Œæœƒå¾å¤¢å¢ƒæƒ…ç·’ã€å ´æ™¯ã€ç”Ÿæ´»ç’°å¢ƒåˆ†æç‹€æ…‹ã€‚å°æˆ‘è€Œè¨€ï¼Œé€™æ˜¯å¥½ç©æœ‰è¶£åˆæœ‰æ„ç¾©çš„äº‹ï¼</p>

                        <div style="margin-top: 2rem;">
                            <div class="analysis-box">
                                <span>LUCIDITY_LEVEL</span>
                                <span class="analysis-value">98%</span>
                            </div>
                            <div class="analysis-box">
                                <span>SENSORY_INPUT</span>
                                <span class="analysis-value">MAXIMUM</span>
                            </div>
                            <div class="analysis-box">
                                <span>NIGHTMARE_RESISTANCE</span>
                                <span class="analysis-value">IMMUNE</span>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <i class="fa-solid fa-eye" style="font-size: 10rem; color: var(--color-secondary); opacity: 0.8; filter: drop-shadow(0 0 20px var(--color-neon-blue)); animation: pulse 3s infinite;"></i>
                        <p style="margin-top: 1rem; font-family: var(--font-tech);">SCANNING DREAM FRAGMENTS...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. TIMELINE (Horizontal Scroll) -->
        <div id="timeline">
            <div class="timeline-wrapper">
                <div class="timeline-panel" style="background: rgba(255,255,255,0.1);">
                    <span class="timeline-year">ORIGIN</span>
                    <i class="fa-solid fa-earth-asia" style="font-size: 5rem; margin-bottom: 2rem; color: var(--color-accent);"></i>
                    <h2>Malaysia</h2>
                    <p>ä¾†è‡ªé¦¬ä¾†è¥¿äºçš„ç¤¾æœƒå¿ƒç†ç³»ç•¢æ¥­ç”Ÿ ğŸ‡²ğŸ‡¾</p>
                </div>
                <div class="timeline-panel" style="background: rgba(255,255,255,0.15);">
                    <span class="timeline-year">TEACH</span>
                    <i class="fa-solid fa-chalkboard-user" style="font-size: 5rem; margin-bottom: 2rem; color: var(--color-secondary);"></i>
                    <h2>Teacher</h2>
                    <p>ç¾åœ¨æ˜¯å¥§æ•¸æ•¸å­¸è€å¸« ğŸ“<br>ç”¨æ•™è‚²ç™‚ç™’ä»–äººï¼Œä¹Ÿè¢«å­©å­å€‘ç™‚ç™’ã€‚</p>
                </div>
                <div class="timeline-panel" style="background: rgba(255,255,255,0.2);">
                    <span class="timeline-year">LOVE</span>
                    <i class="fa-solid fa-hand-holding-heart" style="font-size: 5rem; margin-bottom: 2rem; color: var(--color-gold);"></i>
                    <h2>Volunteer</h2>
                    <p>æ›¾ä»»è‡ªé–‰ç—‡é™ªè®€ã€åƒèˆ‡ç¾©å·¥æ´»å‹•ã€‚<br>åŠ©äººæ˜¯æˆ‘å¿ƒä¸­æŸ”è»Ÿçš„é¡˜æœ›ã€‚</p>
                </div>
                <div class="timeline-panel" style="background: rgba(255,255,255,0.25);">
                    <span class="timeline-year">FUTURE</span>
                    <i class="fa-solid fa-pen-nib" style="font-size: 5rem; margin-bottom: 2rem; color: #fff;"></i>
                    <h2>Writer</h2>
                    <p>é€™è¼©å­æœ€æƒ³æˆç‚ºä¸€åä½œå®¶ã€‚<br>æŠŠæ•…äº‹å“¼æˆæ›²å­ï¼Œå¯«å‡ºæº«æŸ”å¹½é»˜çš„æ–‡å­—ã€‚</p>
                </div>
            </div>
        </div>

        <!-- 4. LUCKY SLOT MACHINE -->
        <section id="lucky">
            <div class="container" style="text-align: center;">
                <h2>Super Lucky ğŸ€</h2>
                <p>ã€Œæˆ‘é‹æ°£éå¸¸å¥½ï¼é€™è¼©å­æŠ½éæ‰‹æ©Ÿã€è€³æ©Ÿ...ã€<br>ä¾†è©¦è©¦çœ‹ä½ çš„é‹æ°£å§ï¼</p>

                <div class="slot-machine-container" style="margin-top: 3rem;">
                    <div class="slot-window">
                        <div class="slot-reel" id="reel1">7</div>
                        <div class="slot-reel" id="reel2">7</div>
                        <div class="slot-reel" id="reel3">7</div>
                    </div>
                    <button class="spin-btn" onclick="spinSlots()">TEST LUCK</button>
                    <div id="slot-msg" style="color: var(--color-gold); font-weight: bold; margin-top: 1rem; height: 1.5rem;"></div>
                </div>
            </div>
        </section>

        <!-- 5. BLIND BOX -->
        <section id="dreams">
            <div class="container" style="text-align: center;">
                <h2>Dream Blind Box</h2>
                <div class="blind-box-container" id="box-grid" style="margin-top: 3rem;">
                    <!-- JS Generated -->
                </div>
            </div>
        </section>

        <!-- 6. GALLERY -->
        <section id="gallery">
            <div class="container">
                <h2>Life Fragments</h2>
                <div class="gallery-grid" id="gallery-content" style="margin-top: 3rem;">
                    <!-- JS Generated -->
                </div>
            </div>
        </section>

        <footer>
            <div class="container">
                <h3>Liloyee</h3>
                <p>ã€Œå¸Œæœ›æˆç‚ºå¤©ä¸Šçš„å¤©ä½¿å‰ï¼Œä¹Ÿå¯ä»¥æ˜¯äººé–“çš„å¤©ä½¿ ğŸ§šğŸ»â€â™€ï¸ã€</p>
                <div style="margin-top: 2rem; font-size: 2rem; display: flex; justify-content: center; gap: 2rem;">
                    <a href="https://www.instagram.com/liloyee_0224/" target="_blank" style="color: inherit;"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.threads.com/@liloyee_0224" target="_blank" style="color: inherit;"><i class="fa-brands fa-threads"></i></a>
                </div>
                <p style="margin-top: 2rem; font-size: 0.8rem; opacity: 0.5;">Designed by <a href="/guild/" style="color: inherit;">SuperGalen</a></p>
            </div>
        </footer>
    </main>

    <script>
        // --- 1. THREE.JS "DREAM STREAM" ---
        let scene, camera, renderer, particles, floatingObjects = [];
        let mouseX = 0, mouseY = 0;

        const initThree = () => {
            const container = document.getElementById('canvas-container');
            scene = new THREE.Scene();
            // Start with light fog, transition to dark later
            scene.fog = new THREE.FogExp2(0xffe6f2, 0.002);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
            camera.position.z = 800;

            renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            container.appendChild(renderer.domElement);

            // --- A. Particles (Stream) ---
            const count = 3000;
            const posArray = new Float32Array(count * 3);
            const colorArray = new Float32Array(count * 3);
            const randomArray = new Float32Array(count); // For varied movement

            const color1 = new THREE.Color(0xff9ecd); // Pink
            const color2 = new THREE.Color(0xa0e9ff); // Blue

            for(let i=0; i<count; i++) {
                posArray[i*3] = (Math.random() - 0.5) * 2000; // Wide spread
                posArray[i*3+1] = (Math.random() - 0.5) * 2000;
                posArray[i*3+2] = (Math.random() - 0.5) * 2000;

                colorArray[i*3] = color1.r;
                colorArray[i*3+1] = color1.g;
                colorArray[i*3+2] = color1.b;

                randomArray[i] = Math.random();
            }

            const geo = new THREE.BufferGeometry();
            geo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            geo.setAttribute('color', new THREE.BufferAttribute(colorArray, 3));
            geo.setAttribute('aRandom', new THREE.BufferAttribute(randomArray, 1));

            const mat = new THREE.PointsMaterial({
                size: 2,
                vertexColors: true,
                transparent: true,
                opacity: 0.8,
                blending: THREE.AdditiveBlending
            });

            particles = new THREE.Points(geo, mat);
            scene.add(particles);

            // --- B. Floating Symbols (InstancedMesh) ---
            // Torus (Rings), Octahedron (Diamonds), Box (Books/Cubes)
            const objCount = 50;
            const geometries = [
                new THREE.TorusGeometry(10, 3, 16, 100),
                new THREE.OctahedronGeometry(15),
                new THREE.BoxGeometry(15, 20, 5) // Book shape
            ];

            const objMat = new THREE.MeshBasicMaterial({ color: 0xffffff, wireframe: true, transparent: true, opacity: 0.3 });

            geometries.forEach(g => {
                const mesh = new THREE.InstancedMesh(g, objMat, objCount);
                const dummy = new THREE.Object3D();
                const speeds = [];

                for(let i=0; i<objCount; i++) {
                    dummy.position.set(
                        (Math.random()-0.5)*1500,
                        (Math.random()-0.5)*1500,
                        (Math.random()-0.5)*1500
                    );
                    dummy.rotation.set(Math.random()*Math.PI, Math.random()*Math.PI, 0);
                    const scale = 0.5 + Math.random();
                    dummy.scale.set(scale, scale, scale);
                    dummy.updateMatrix();
                    mesh.setMatrixAt(i, dummy.matrix);

                    speeds.push({
                        rotX: (Math.random()-0.5)*0.01,
                        rotY: (Math.random()-0.5)*0.01,
                        ySpd: (Math.random()-0.5)*0.2
                    });
                }

                mesh.userData = { speeds: speeds, dummies: Array(objCount).fill().map(() => new THREE.Object3D()) };
                // Initialize dummies with current positions
                for(let i=0; i<objCount; i++) {
                     mesh.getMatrixAt(i, mesh.userData.dummies[i].matrix);
                     mesh.userData.dummies[i].matrix.decompose(mesh.userData.dummies[i].position, mesh.userData.dummies[i].rotation, mesh.userData.dummies[i].scale);
                }

                scene.add(mesh);
                floatingObjects.push(mesh);
            });

            // --- Animation Loop ---
            const animate = () => {
                requestAnimationFrame(animate);

                // 1. SCROLL-BASED TRANSITIONS
                const scrollY = window.scrollY;
                const maxScroll = document.body.scrollHeight - window.innerHeight;
                const progress = Math.min(scrollY / maxScroll, 1); // 0 to 1

                // Camera Fly-through
                camera.position.z = 800 - (progress * 1000); // Fly inward

                // Color Transition (Light -> Dark)
                // Threshold at 30% scroll to start darkening
                if(progress > 0.3) {
                    document.body.classList.add('dark-mode');
                    const darkness = Math.min((progress - 0.3) * 2, 1);
                    scene.fog.color.setHSL(0.7, 0.5, 0.9 * (1-darkness)); // Fade to black/purple
                    scene.fog.density = 0.002 - (darkness * 0.001); // Clear up fog in space
                } else {
                    document.body.classList.remove('dark-mode');
                    scene.fog.color.setHex(0xffe6f2);
                    scene.fog.density = 0.002;
                }

                // Particle Movement (Warp Speed effect)
                const warp = 1 + (progress * 5);
                const positions = particles.geometry.attributes.position.array;

                // Rotate entire system
                particles.rotation.z += 0.0005 * warp;

                // Floating Objects Animation
                floatingObjects.forEach(mesh => {
                    for(let i=0; i<objCount; i++) {
                        const dummy = mesh.userData.dummies[i];
                        const spd = mesh.userData.speeds[i];

                        dummy.rotation.x += spd.rotX * warp;
                        dummy.rotation.y += spd.rotY * warp;
                        dummy.position.y += spd.ySpd * warp;

                        // Wrap around
                        if(dummy.position.y > 1000) dummy.position.y = -1000;
                        if(dummy.position.y < -1000) dummy.position.y = 1000;

                        dummy.updateMatrix();
                        mesh.setMatrixAt(i, dummy.matrix);
                    }
                    mesh.instanceMatrix.needsUpdate = true;
                });

                renderer.render(scene, camera);
            };

            animate();

            // Resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

            // Mouse
            document.addEventListener('mousemove', (e) => {
                const cursor = document.querySelector('.cursor-dot');
                cursor.style.transform = `translate(${e.clientX}px, ${e.clientY}px)`;
            });
        };

        // --- 2. SLOT MACHINE ---
        const spinSlots = () => {
            const symbols = ['7', 'ğŸ€', 'ğŸ’', 'â­', 'â¤ï¸', 'ğŸŒ™'];
            const reels = [document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
            const btn = document.querySelector('.spin-btn');
            const msg = document.getElementById('slot-msg');

            btn.disabled = true;
            msg.innerText = "SPINNING...";

            let spins = 0;
            const maxSpins = 20;

            const interval = setInterval(() => {
                reels.forEach(r => r.innerText = symbols[Math.floor(Math.random() * symbols.length)]);
                spins++;

                if(spins > maxSpins) {
                    clearInterval(interval);
                    // FORCE WIN (She is super lucky!)
                    reels.forEach(r => r.innerText = 'ğŸ€');
                    msg.innerText = "JACKPOT! SUPER LUCKY! ğŸ‰";
                    createConfetti(btn.getBoundingClientRect().left + 100, btn.getBoundingClientRect().top);
                    btn.disabled = false;
                }
            }, 100);
        };

        // --- 3. BLIND BOX ---
        const initBlindBox = () => {
            const grid = document.getElementById('box-grid');
            const data = [
                {icon: 'fa-moon', text: 'å¤¢éŠä»™å¢ƒ'},
                {icon: 'fa-book', text: 'æ•…äº‹æ—…äºº'},
                {icon: 'fa-ghost', text: 'éˆç•°é«”è³ª?'},
                {icon: 'fa-plane', text: 'å¤¢ä¸­é£›è¡Œ'}
            ];

            data.forEach((d, i) => {
                const div = document.createElement('div');
                div.className = 'blind-box';
                div.innerHTML = `
                    <div class="box-side box-front"><i class="fa-solid fa-gift" style="font-size:3rem; margin-bottom:1rem;"></i>Tap Me</div>
                    <div class="box-side box-back"><i class="fa-solid ${d.icon}" style="font-size:3rem; color:var(--color-accent); margin-bottom:1rem;"></i><p>${d.text}</p></div>
                `;
                div.onclick = function(e) {
                    this.classList.toggle('opened');
                    if(this.classList.contains('opened')) createConfetti(e.clientX, e.clientY);
                };
                grid.appendChild(div);
            });
        };

        // --- 4. GALLERY ---
        const initGallery = () => {
            const grid = document.getElementById('gallery-content');
            // Using 1-12 for demo, can expand to 19
            for(let i=1; i<=12; i++) {
                const div = document.createElement('div');
                div.className = 'gallery-item';
                div.innerHTML = `<img src="/assets/img/guild/liloyee/gallery_${String(i).padStart(2,'0')}.webp" loading="lazy">`;
                grid.appendChild(div);
            }
        };

        // Confetti (Reused)
        const createConfetti = (x, y) => {
            const colors = ['#ff9ecd', '#a0e9ff', '#ffd700'];
            for(let i=0; i<30; i++) {
                const p = document.createElement('div');
                p.style.position='fixed'; p.style.left=x+'px'; p.style.top=y+'px';
                p.style.width = Math.random()*10+5+'px'; p.style.height=p.style.width;
                p.style.background = colors[Math.floor(Math.random()*colors.length)];
                p.style.borderRadius='50%'; p.style.zIndex='9999';
                document.body.appendChild(p);
                gsap.to(p, {x:(Math.random()-0.5)*200, y:(Math.random()-0.5)*200, opacity:0, duration:1, onComplete:()=>p.remove()});
            }
        };

        // --- 5. GSAP ---
        window.onload = () => {
            initThree();
            initBlindBox();
            initGallery();

            gsap.registerPlugin(ScrollTrigger);

            // Horizontal Scroll for Timeline
            // Only apply on desktop to avoid mobile UX issues
            if(window.innerWidth > 768) {
                const sections = gsap.utils.toArray(".timeline-panel");
                gsap.to(sections, {
                    xPercent: -100 * (sections.length - 1),
                    ease: "none",
                    scrollTrigger: {
                        trigger: "#timeline",
                        pin: true,
                        scrub: 1,
                        snap: 1 / (sections.length - 1),
                        end: () => "+=" + document.querySelector(".timeline-wrapper").offsetWidth
                    }
                });
            }

            // Hero Entrance
            gsap.from("#hero h1", { scale: 0.5, opacity: 0, duration: 1.5, ease: "elastic.out(1, 0.3)" });
            gsap.from(".hero-tags span", { y: 50, opacity: 0, stagger: 0.2, duration: 0.8 });

            // Lab Stats Animation
            gsap.utils.toArray(".analysis-value").forEach(val => {
                gsap.from(val, {
                    textContent: 0,
                    duration: 2,
                    ease: "power1.in",
                    snap: { textContent: 1 },
                    scrollTrigger: { trigger: val, start: "top 80%" }
                });
            });
        };

    </script>
</body>
</html>
