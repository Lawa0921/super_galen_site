<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liuan | å¥èº«è‡ªç”±æ•™ç·´</title>
    <meta name="description" content="å¥èº«è‡ªç”±æ•™ç·´ Liuan - å¾å…¬è·åˆ°è‡ªç”±ï¼Œå¸¶ä½ æ‰¾å›å°èº«é«”çš„æŒæ§æ¬Šã€‚é‹å‹•ç”Ÿç†å­¸èƒŒæ™¯ï¼Œçµåˆè¬å› èˆ‡ç§‘å­¸çš„å¥èº«æŒ‡å°ã€‚">
    <meta property="og:image" content="/assets/img/guild/liuan/avatar.webp">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Libraries -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        :root {
            --c-neon-green: #39FF14;
            --c-neon-cyan: #00FFFF;
            --c-neon-pink: #FF00FF;
            --c-bg: #050505;
            --c-card-bg: rgba(10, 20, 10, 0.85);
            --font-display: 'Black Ops One', cursive;
            --font-meme: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
            --font-tech: 'Orbitron', sans-serif;
            --font-body: 'Noto Sans TC', sans-serif;
        }

        body {
            margin: 0; padding: 0; box-sizing: border-box;
            background-color: var(--c-bg);
            color: #fff;
            font-family: var(--font-body);
            overflow-x: hidden;
            width: 100vw;
        }

        * { box-sizing: border-box; }

        /* --- Canvas --- */
        #webgl-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none;
            background: radial-gradient(circle at center, #1a2a1a 0%, #000000 100%);
        }

        /* --- Scroll Spacer --- */
        #scroll-spacer {
            height: 1200vh; /* Long scroll for story */
            width: 100%; position: relative;
            z-index: -1; pointer-events: none;
        }

        /* --- UI Overlay --- */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10;
        }

        /* Brand Mark */
        .brand-mark {
            position: fixed; top: 2rem; left: 2rem; z-index: 100;
            display: flex; align-items: center; gap: 10px;
            pointer-events: auto; text-decoration: none;
            mix-blend-mode: exclusion;
        }
        .mark-text {
            font-family: var(--font-display);
            font-size: 1.5rem;
            color: var(--c-neon-green);
            text-shadow: 0 0 10px var(--c-neon-green);
        }

        /* --- Glitch Effect --- */
        .glitch {
            position: relative;
            color: white;
        }
        .glitch::before, .glitch::after {
            content: attr(data-text);
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        }
        .glitch::before {
            left: 2px; text-shadow: -1px 0 var(--c-neon-pink);
            clip: rect(24px, 550px, 90px, 0);
            animation: glitch-anim-2 3s infinite linear alternate-reverse;
        }
        .glitch::after {
            left: -2px; text-shadow: -1px 0 var(--c-neon-cyan);
            clip: rect(85px, 550px, 140px, 0);
            animation: glitch-anim 2.5s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim {
            0% { clip: rect(13px, 9999px, 81px, 0); }
            20% { clip: rect(88px, 9999px, 16px, 0); }
            40% { clip: rect(24px, 9999px, 126px, 0); }
            60% { clip: rect(102px, 9999px, 34px, 0); }
            80% { clip: rect(56px, 9999px, 78px, 0); }
            100% { clip: rect(12px, 9999px, 49px, 0); }
        }
        @keyframes glitch-anim-2 {
            0% { clip: rect(65px, 9999px, 100px, 0); }
            20% { clip: rect(2px, 9999px, 45px, 0); }
            40% { clip: rect(15px, 9999px, 33px, 0); }
            60% { clip: rect(80px, 9999px, 15px, 0); }
            80% { clip: rect(33px, 9999px, 98px, 0); }
            100% { clip: rect(110px, 9999px, 2px, 0); }
        }

        /* --- Typography & Layout --- */
        .center-stage {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; width: 100%; max-width: 1200px;
            pointer-events: none;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* Classic Meme Style Text */
        .meme-macro-text {
            font-family: var(--font-meme);
            font-size: clamp(3rem, 8vw, 6rem);
            line-height: 1.1;
            text-transform: uppercase;
            color: #fff;
            -webkit-text-stroke: 2px #000;
            text-shadow:
                3px 3px 0 #000,
                -1px -1px 0 #000,
                1px -1px 0 #000,
                -1px 1px 0 #000,
                1px 1px 0 #000;
            margin-bottom: 2rem;
            width: 100%;
            pointer-events: auto; /* Clickable just for fun? */
            cursor: cell;
        }

        .meme-subtext {
            font-family: var(--font-meme);
            font-size: clamp(1.5rem, 4vw, 3rem);
            color: #fff;
            -webkit-text-stroke: 1px #000;
            text-shadow: 2px 2px 0 #000;
        }

        .avatar-frame {
            width: 300px; height: 300px;
            border: 4px solid var(--c-neon-green);
            box-shadow: 0 0 30px var(--c-neon-green), inset 0 0 30px var(--c-neon-green);
            border-radius: 50%; overflow: hidden;
            position: relative;
            background: #000;
            transition: transform 0.1s;
        }
        .avatar-frame img {
            width: 100%; height: 100%; object-fit: cover;
        }
        .avatar-frame:hover {
            transform: scale(1.1) rotate(5deg);
        }

        /* Content Sections */
        .section-content {
            position: absolute; top: 50%; transform: translateY(-50%);
            width: 100%; padding: 0 10%;
            display: flex; gap: 4rem; align-items: center;
            opacity: 0; pointer-events: none;
        }
        .section-left { justify-content: flex-start; }
        .section-right { justify-content: flex-end; }
        .section-center { justify-content: center; text-align: center; flex-direction: column; }

        .info-card {
            background: var(--c-card-bg);
            border: 1px solid var(--c-neon-green);
            padding: 2.5rem; border-radius: 10px;
            backdrop-filter: blur(10px);
            max-width: 600px;
            box-shadow: 10px 10px 0px rgba(57, 255, 20, 0.2);
            pointer-events: auto;
            position: relative;
            overflow: hidden;
        }
        .info-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 5px; height: 100%;
            background: var(--c-neon-green);
        }

        .info-card h2 {
            font-family: var(--font-tech);
            color: var(--c-neon-green);
            font-size: 2rem; margin-top: 0; margin-bottom: 1rem;
            text-transform: uppercase; border-bottom: 1px dashed rgba(255,255,255,0.3); padding-bottom: 10px;
        }
        .info-card p {
            font-size: 1.1rem; line-height: 1.8; color: #ddd; margin-bottom: 1rem;
        }
        .info-card ul {
            list-style: none; padding: 0;
        }
        .info-card li {
            margin-bottom: 0.8rem; display: flex; align-items: center; gap: 10px;
            font-size: 1.1rem;
        }
        .info-card li i { color: var(--c-neon-cyan); }

        .highlight {
            color: var(--c-neon-cyan); font-weight: 700;
        }

        /* --- Footer / Finale --- */
        #finale {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 50;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none;
            transition: opacity 0.5s;
        }
        #finale.active { opacity: 1; pointer-events: auto; }

        .social-links {
            display: flex; gap: 2rem; margin-top: 2rem;
        }
        .social-btn {
            color: var(--c-bg); background: var(--c-neon-green);
            padding: 1rem 2rem; font-family: var(--font-tech); font-weight: 700;
            text-decoration: none; border-radius: 5px; font-size: 1.2rem;
            transition: 0.3s;
            clip-path: polygon(10% 0, 100% 0, 100% 80%, 90% 100%, 0 100%, 0 20%);
        }
        .social-btn:hover {
            background: var(--c-neon-cyan); transform: scale(1.1) rotate(-2deg);
            box-shadow: 0 0 20px var(--c-neon-cyan);
        }

        .footer-credit {
            position: absolute; bottom: 1rem; width: 100%; text-align: center;
            font-size: 0.8rem; color: #666; font-family: var(--font-tech);
        }
        .footer-credit a { color: #888; text-decoration: none; }
        .footer-credit a:hover { color: var(--c-neon-green); }

        .muscle-emoji {
            position: fixed; font-size: 3rem; pointer-events: none; z-index: 9999;
            animation: fly-up 2s ease-out forwards;
        }
        @keyframes fly-up {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            20% { opacity: 1; transform: translateY(-20vh) scale(1.5); }
            100% { transform: translateY(-100vh) rotate(360deg) scale(1); opacity: 0; }
        }

        /* --- Entrance --- */
        #entrance-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000; z-index: 10001;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .loader-bar {
            width: 300px; height: 4px; background: #333; margin-top: 20px;
            position: relative; overflow: hidden;
        }
        .loader-fill {
            position: absolute; top: 0; left: 0; height: 100%; width: 0%;
            background: var(--c-neon-green);
            animation: load 2s ease-in-out forwards;
        }
        @keyframes load { 0% { width: 0%; } 100% { width: 100%; } }

        /* --- Marquee --- */
        .marquee {
            position: fixed; top: 0; width: 100%; background: var(--c-neon-green); color: #000;
            overflow: hidden; z-index: 200; height: 30px; line-height: 30px;
            font-family: var(--font-meme); font-size: 1.2rem;
            white-space: nowrap;
        }
        .marquee-content {
            display: inline-block;
            animation: scroll-left 10s linear infinite;
        }
        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .click-hint {
            position: fixed; bottom: 2rem; right: 2rem;
            color: rgba(255,255,255,0.5); font-family: var(--font-tech);
            font-size: 0.8rem; pointer-events: none;
            animation: blink 2s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        @media (max-width: 768px) {
            .meme-macro-text { font-size: 2.5rem; }
            .avatar-frame { width: 200px; height: 200px; }
            .section-content { flex-direction: column; padding: 0 1rem; justify-content: center; }
            .info-card { width: 100%; padding: 1.5rem; }
            .social-links { flex-direction: column; gap: 1rem; }
        }
    </style>
</head>
<body>

    <div id="entrance-screen">
        <div class="meme-macro-text" style="font-size: 2rem;">INITIALIZING GAINS...</div>
        <div class="loader-bar"><div class="loader-fill"></div></div>
    </div>

    <!-- Marquee -->
    <div class="marquee">
        <div class="marquee-content">
            MUCH POWER /// SUCH MUSCLE /// DO YOU EVEN LIFT? /// LIGHT WEIGHT BABY! /// GET TO THE CHOPPA! /// GAINS LOADING... /// NEVER SKIP LEG DAY /// YES BUDDY!
        </div>
    </div>

    <div id="webgl-container"></div>
    <div id="scroll-spacer"></div>

    <a href="/guild/" class="brand-mark">
        <i class="fa-solid fa-dumbbell" style="font-size: 2rem; color: var(--c-neon-green);"></i>
        <div class="mark-text">LIUAN</div>
    </a>

    <div class="click-hint">[CLICK ANYWHERE FOR CHAOS]</div>

    <div class="overlay">
        <!-- Hero Section -->
        <div id="hero" class="center-stage">
            <div class="meme-macro-text glitch" data-text="WHEN YOU FINALLY">WHEN YOU FINALLY</div>
            <div class="avatar-frame">
                <img src="/assets/img/guild/liuan/avatar.webp" alt="Liuan Gains">
            </div>
            <div class="meme-macro-text glitch" data-text="GET THAT PUMP" style="margin-top: 1rem;">GET THAT PUMP</div>

            <div class="meme-subtext" style="color: var(--c-neon-cyan);">
                FITNESS COACH | MEME LORD
            </div>
        </div>

        <!-- 1. Origin -->
        <div id="section-1" class="section-content section-left">
            <div class="info-card">
                <h2>// ORIGIN STORY ğŸ¦</h2>
                <p>æˆ‘æ˜¯ä¸€å€‹<span class="highlight">å¥èº«è‡ªç”±æ•™ç·´</span>ï¼</p>
                <p>ä¹‹å‰åœ¨å…¬è·ä¸Šç­ï¼Œä½†ç™¼ç¾å¥èº«é€™ä»¶äº‹å°æˆ‘ä¾†èªªæ‰æ˜¯æœ€é‡è¦çš„ã€‚æ–¼æ˜¯æ¯…ç„¶æ±ºç„¶é›¢é–‹èˆ’é©åœˆï¼ŒæŠ•å…¥é‹å‹•é ˜åŸŸã€‚</p>
                <p>ç ”ç©¶æ‰€ä¸»ä¿®<span class="highlight">é‹å‹•ç”Ÿç†å­¸</span>ï¼Œå¤§å­¸æ˜¯ç¤¾æœƒå­¸ç³»ã€‚å–œæ­¡è§€å¯Ÿç¤¾æœƒï¼Œä¹Ÿå–œæ­¡è§€å¯Ÿè‚Œè‚‰ (?</p>
                <p style="font-family: var(--font-meme); font-size: 1.5rem; color: yellow; text-shadow: 1px 1px 0 #000;">"DO IT FOR THE GAINS!"</p>
            </div>
        </div>

        <!-- 2. Philosophy -->
        <div id="section-2" class="section-content section-right">
            <div class="info-card">
                <h2>// PHILOSOPHY ğŸ—¿</h2>
                <p>ã€Œå¥èº«é‹å‹•é™¤äº†è‡ªå·±ç·´ï¼Œå¸¶èº«é‚Šçš„äººæˆ–æ˜¯çˆºçˆºå¥¶å¥¶é‹å‹•ï¼Œçµ¦æˆ‘çš„æ„Ÿè¦ºæ›´è¸å¯¦ï¼ã€</p>
                <p>ç©éå¥ç¾ã€å¥åŠ›ã€‚æˆ‘çš„ç›®æ¨™æ˜¯æŠŠé‹å‹•è·Ÿå®¶äººã€å·¥ä½œçµåˆï¼Œè®“é‹å‹•æˆç‚ºç”Ÿæ´»çš„ä¸€ç¨®<span class="highlight">æ—¥å¸¸é¢¨æ ¼</span>ï¼Œè€Œä¸åªæ˜¯ç—›è‹¦çš„è¨“ç·´ã€‚</p>
                <div style="text-align: right; font-size: 2rem;">ğŸ’ªğŸ’ªğŸ’ª</div>
            </div>
        </div>

        <!-- 3. Services -->
        <div id="section-3" class="section-content section-left">
            <div class="info-card">
                <h2>// SERVICES ğŸ”¥</h2>
                <ul>
                    <li><i class="fa-solid fa-language"></i> <strong>å¥èº«å½±ç‰‡ç¿»è­¯</strong>ï¼šåˆ†äº«åœ‹å¤–å„ªè³ªè³‡è¨Šã€‚</li>
                    <li><i class="fa-solid fa-person-running"></i> <strong>å€‹äººæ•™ç·´</strong>ï¼šç§‘å­¸åŒ–è¨“ç·´å®‰æ’ã€‚</li>
                    <li><i class="fa-solid fa-question-circle"></i> <strong>ç–‘é›£é›œç—‡è§£ç­”</strong>ï¼šæœ‰å•é¡Œéš¨æ™‚å¹«å¿™ï¼</li>
                </ul>
                <p>ç›®å‰æ­£ç©æ¥µæ‹æ”æ›´å¤šå¥½ç©çš„å½±ç‰‡ï¼Œæ¨å»£é‹å‹•ç”Ÿæ´»åŒ–ï¼</p>
            </div>
        </div>

        <!-- 4. Future -->
        <div id="section-4" class="section-content section-center">
            <div class="info-card" style="text-align: center;">
                <h2>// NEXT LEVEL ğŸš€</h2>
                <p>æ¥ä¸‹ä¾†æœƒæœ‰æ›´å¤šå¥½ç©çš„è¨ˆåŠƒï¼ğŸ˜</p>
                <p>æ¯”å¦‚ï¼š<span class="highlight">æ‰¾é€€ä¼‘çš„å®¶äººä¾†å€‹æŒ‘æˆ°</span>ï¼</p>
                <p>è®“å¤§å®¶æ›´äº†è§£é‹å‹•å¥èº«çš„å¥½ï¼Œä¸€èµ·æŠŠæ—¥å¸¸é‹å‹•å‘ˆç¾çµ¦å¤§å®¶ã€‚</p>
                <div style="margin-top: 1rem; font-family: var(--font-meme); font-size: 1.5rem; color: var(--c-neon-green);">
                    MUCH CHALLENGE. VERY HEALTH.
                </div>
            </div>
        </div>

    </div>

    <!-- Finale -->
    <div id="finale">
        <h1 class="meme-macro-text glitch" data-text="JOIN THE REVOLUTION" style="font-size: 3rem; margin-bottom: 2rem;">JOIN THE REVOLUTION</h1>
        <div class="avatar-frame" style="width: 150px; height: 150px; margin-bottom: 2rem;">
            <img src="/assets/img/guild/liuan/avatar.webp" alt="Liuan">
        </div>

        <div class="social-links">
            <a href="https://www.instagram.com/liuan_onesmallstep/" target="_blank" class="social-btn">
                <i class="fa-brands fa-instagram"></i> INSTAGRAM
            </a>
            <a href="https://www.threads.net/@liuan_onesmallstep" target="_blank" class="social-btn">
                <i class="fa-brands fa-threads"></i> THREADS
            </a>
        </div>

        <div class="footer-credit">
            Made with <i class="fa-solid fa-heart" style="color: var(--c-neon-pink);"></i> by <a href="/guild/">SuperGalen's Dungeon</a>
        </div>
    </div>

    <script type="module">
        import * as THREE from 'three';

        // --- Setup ---
        const container = document.getElementById('webgl-container');
        const scene = new THREE.Scene();
        // Dark fog for depth
        scene.fog = new THREE.FogExp2(0x050505, 0.05);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // --- Lights ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const pointLight = new THREE.PointLight(0x39FF14, 2, 50); // Neon Green
        pointLight.position.set(0, 0, 10);
        scene.add(pointLight);

        // Headlamp attached to camera
        const headLamp = new THREE.PointLight(0x00FFFF, 1, 30);
        camera.add(headLamp);
        scene.add(camera);

        // --- Load Meme Textures ---
        const textureLoader = new THREE.TextureLoader();
        const memeTextures = [];
        const memeFiles = ['meme1.webp', 'meme2.webp', 'meme3.webp', 'meme4.webp', 'meme5.webp'];

        memeFiles.forEach(file => {
            textureLoader.load(
                `/assets/img/guild/liuan/${file}`,
                (texture) => {
                    texture.colorSpace = THREE.SRGBColorSpace;
                    memeTextures.push(texture);
                },
                undefined,
                (err) => console.warn('Failed to load texture:', file)
            );
        });

        // --- Objects: "Tunnel of Gains" ---
        const tunnelGroup = new THREE.Group();
        scene.add(tunnelGroup);

        const geometryBox = new THREE.BoxGeometry(1, 1, 2);
        const geometryBar = new THREE.CylinderGeometry(0.1, 0.1, 4, 8);

        const materialGreen = new THREE.MeshStandardMaterial({
            color: 0x39FF14, wireframe: true, emissive: 0x004400
        });
        const materialCyan = new THREE.MeshStandardMaterial({
            color: 0x00FFFF, wireframe: true, emissive: 0x004444
        });

        // Floating Text Sprites (Now with Emojis and Memes)
        function createTextSprite(text, color, isEmoji = false) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 512; canvas.height = 256;

            if (isEmoji) {
                ctx.font = '150px "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji"';
            } else {
                ctx.font = 'Bold 80px Impact, sans-serif'; // Meme font
            }

            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            if (!isEmoji) {
                // Meme text style: White with black stroke
                ctx.lineWidth = 4;
                ctx.strokeStyle = '#000000';
                ctx.strokeText(text, 256, 128);
                ctx.fillStyle = '#FFFFFF';
                ctx.fillText(text, 256, 128);
            } else {
                ctx.fillText(text, 256, 128);
            }

            const tex = new THREE.CanvasTexture(canvas);
            const mat = new THREE.SpriteMaterial({ map: tex });
            const sprite = new THREE.Sprite(mat);
            sprite.scale.set(10, 5, 1);
            return sprite;
        }

        // Wait for textures to load slightly or just add them dynamically
        // We will add placeholders first or add them in the loop

        const memePhrases = [
            { text: "GAINS", isEmoji: false },
            { text: "MUCH POWER", isEmoji: false },
            { text: "WOW", isEmoji: false },
            { text: "ğŸ’ª", isEmoji: true },
            { text: "ğŸ”¥", isEmoji: true },
            { text: "ğŸ¦", isEmoji: true },
            { text: "ğŸ—¿", isEmoji: true },
            { text: "SUCH MUSCLE", isEmoji: false },
            { text: "NEVER SKIP LEG DAY", isEmoji: false },
            { text: "ğŸ¤¡", isEmoji: true },
            { text: "ğŸ’€", isEmoji: true }
        ];

        // Create initial objects
        const count = 200;
        for(let i=0; i<count; i++) {
            const mesh = new THREE.Mesh(
                Math.random() > 0.5 ? geometryBox : geometryBar,
                Math.random() > 0.5 ? materialGreen : materialCyan
            );

            const theta = Math.random() * Math.PI * 2;
            const radius = 10 + Math.random() * 20;
            const z = i * -1 - Math.random() * 10;

            mesh.position.set(Math.cos(theta) * radius, Math.sin(theta) * radius, z);
            mesh.rotation.set(Math.random()*Math.PI, Math.random()*Math.PI, 0);
            tunnelGroup.add(mesh);
        }

        // Add Text Sprites
        for(let i=0; i<40; i++) {
            const item = memePhrases[Math.floor(Math.random() * memePhrases.length)];
            const sprite = createTextSprite(item.text, '#fff', item.isEmoji);

            const theta = Math.random() * Math.PI * 2;
            const radius = 5 + Math.random() * 12;
            const z = -20 - Math.random() * 180;

            sprite.position.set(Math.cos(theta)*radius, Math.sin(theta)*radius, z);

            sprite.userData = {
                rotateSpeed: (Math.random() - 0.5) * 0.1,
                floatSpeed: (Math.random() - 0.5) * 0.05
            };
            tunnelGroup.add(sprite);
        }

        // Add Image Memes (Wait a bit for textures or check in animate loop)
        // Since we can't wait synchronously, we'll set an interval to add them once loaded
        const addMemeInterval = setInterval(() => {
            if (memeTextures.length === memeFiles.length) {
                // Add some meme planes
                for(let i=0; i<20; i++) {
                    const texture = memeTextures[Math.floor(Math.random() * memeTextures.length)];
                    const mat = new THREE.SpriteMaterial({ map: texture });
                    const sprite = new THREE.Sprite(mat);

                    // Maintain aspect ratio somewhat (assume square or landscape)
                    sprite.scale.set(8, 8, 1);

                    const theta = Math.random() * Math.PI * 2;
                    const radius = 8 + Math.random() * 15;
                    const z = -10 - Math.random() * 190;

                    sprite.position.set(Math.cos(theta)*radius, Math.sin(theta)*radius, z);
                    tunnelGroup.add(sprite);
                }
                clearInterval(addMemeInterval);
            }
        }, 500);


        // --- GSAP Animation ---
        gsap.registerPlugin(ScrollTrigger);

        window.addEventListener('load', () => {
            gsap.to('#entrance-screen', {
                opacity: 0, duration: 1, delay: 1.5,
                onComplete: () => {
                    document.getElementById('entrance-screen').remove();
                    initScroll();
                }
            });
        });

        function initScroll() {
            // Hero Exit
            gsap.to('#hero', {
                opacity: 0, scale: 2, filter: 'blur(10px)',
                scrollTrigger: { trigger: '#scroll-spacer', start: 'top top', end: '10% top', scrub: true }
            });

            // Camera Flight
            gsap.to(camera.position, {
                z: -200,
                ease: 'none',
                scrollTrigger: {
                    trigger: '#scroll-spacer',
                    start: 'top top',
                    end: 'bottom bottom',
                    scrub: 1
                }
            });

            // Camera Rotation (Barrel Roll)
            gsap.to(camera.rotation, {
                z: Math.PI * 4, // More rotations for more chaos
                ease: 'none',
                scrollTrigger: {
                    trigger: '#scroll-spacer',
                    start: 'top top',
                    end: 'bottom bottom',
                    scrub: 1
                }
            });

            // Sections
            const sections = [
                { id: '#section-1', start: 10, end: 25 },
                { id: '#section-2', start: 30, end: 45 },
                { id: '#section-3', start: 50, end: 65 },
                { id: '#section-4', start: 70, end: 85 }
            ];

            sections.forEach(s => {
                const tl = gsap.timeline({
                    scrollTrigger: {
                        trigger: '#scroll-spacer',
                        start: s.start + '% top',
                        end: s.end + '% top',
                        scrub: 1
                    }
                });

                tl.fromTo(s.id,
                    { opacity: 0, scale: 0.5, rotation: (Math.random()-0.5)*30 },
                    { opacity: 1, scale: 1, rotation: 0, duration: 1, ease: "elastic.out(1, 0.5)" }
                );

                tl.to(s.id, { opacity: 0, scale: 1.5, filter: 'blur(5px)', duration: 1 }, 3);
            });

            // Finale
            ScrollTrigger.create({
                trigger: '#scroll-spacer',
                start: '99% bottom',
                onEnter: () => document.getElementById('finale').classList.add('active'),
                onLeaveBack: () => document.getElementById('finale').classList.remove('active')
            });
        }

        // --- Loop ---
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);

            const time = clock.getElapsedTime();

            // Rotate objects in tunnel slightly
            tunnelGroup.children.forEach((mesh, i) => {
                if (mesh.type === 'Sprite') {
                    // Wiggle sprites
                    mesh.position.x += Math.sin(time * 3 + i) * 0.01;
                    mesh.position.y += Math.cos(time * 2 + i) * 0.01;
                } else {
                    mesh.rotation.x += 0.02;
                    mesh.rotation.y += 0.02;
                }
            });

            renderer.render(scene, camera);
        }

        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- Global Chaos Interaction ---
        document.addEventListener('click', (e) => {
            // Ignore if clicking a link or button
            if (e.target.closest('a') || e.target.closest('button')) return;

            // Visual Chaos
            const tl = gsap.timeline();
            tl.to('body', { x: -5, duration: 0.05, yoyo: true, repeat: 3 })
              .to('body', { x: 5, duration: 0.05, yoyo: true, repeat: 3 })
              .to('body', { x: 0, duration: 0.05 });

            // Spawn Emojis at click position
            for(let i=0; i<5; i++) {
                const el = document.createElement('div');
                el.className = 'muscle-emoji';
                el.textContent = ['ğŸ’ª', 'ğŸ”¥', 'ğŸ¦', 'ğŸ‹ï¸', 'ğŸ§±', 'ğŸ’Š'][Math.floor(Math.random()*6)];
                el.style.left = (e.clientX + (Math.random()-0.5)*100) + 'px';
                el.style.top = (e.clientY + (Math.random()-0.5)*100) + 'px';
                el.style.fontSize = (2 + Math.random()*2) + 'rem';
                document.body.appendChild(el);

                // Animate out
                gsap.to(el, {
                    y: -200 - Math.random()*300,
                    x: (Math.random()-0.5)*200,
                    rotation: Math.random()*360,
                    opacity: 0,
                    duration: 1 + Math.random(),
                    onComplete: () => el.remove()
                });
            }

            // Flash background
            gsap.fromTo('#webgl-container', { filter: 'hue-rotate(0deg)' }, { filter: 'hue-rotate(90deg)', duration: 0.2, yoyo: true, repeat: 1 });
        });

    </script>
</body>
</html>
