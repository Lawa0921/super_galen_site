<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Michael Lai | Kinetic Architect</title>
    <meta name="description" content="Michael Lai - 數據分析師 | 轉化動能與邏輯的專家 | 貓與自動化的共生">

    <!-- Fonts: Use a strong, high-contrast pairing -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;700;800&family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Libraries: GSAP (Global Animation) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <!-- Three.js Import Map -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <style>
        :root {
            /* Palette: Light & Clean */
            --c-bg: #F8FAFC;       /* Off-White */
            --c-text: #0F172A;     /* Deep Slate */
            --c-primary: #3B82A0;  /* Cool Blue-Grey */
            --c-secondary: #64748B;/* Muted Slate */
            --c-accent: #F97316;   /* Kinetic Orange */
            --c-glass: rgba(255, 255, 255, 0.4);

            --f-main: 'Manrope', sans-serif;
            --f-serif: 'Noto Serif TC', serif;

            --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--c-bg);
            color: var(--c-text);
            font-family: var(--f-serif); /* Contrast: Serif body for elegance */
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* --- Global Layout --- */
        #webgl-container {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 0;
            pointer-events: none; /* Pass interactions except specific meshes (handled in JS) */
        }

        .scroller {
            position: relative;
            z-index: 10;
        }

        .section {
            min-height: 100vh;
            padding: 4rem 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            position: relative;
        }

        /* --- Typography --- */
        h1, h2, h3, .heading-font {
            font-family: var(--f-main);
            font-weight: 800;
            letter-spacing: -0.03em;
            line-height: 1.1;
        }

        h1 { font-size: clamp(3.5rem, 8vw, 7rem); color: var(--c-text); }
        h2 { font-size: clamp(2rem, 5vw, 4rem); margin-bottom: 2rem; }

        .outline-text {
            color: transparent;
            -webkit-text-stroke: 1px var(--c-secondary);
            opacity: 0.3;
        }

        .accent-text { color: var(--c-accent); position: relative; display: inline-block; }

        /* --- Components --- */
        .glass-panel {
            background: var(--c-glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.6);
            border-radius: 2rem;
            padding: 2.5rem;
            box-shadow: 0 20px 40px -10px rgba(59, 130, 160, 0.1);
            transition: transform 0.4s var(--ease-out);
        }
        .glass-panel:hover {
            transform: translateY(-5px) scale(1.01);
            background: rgba(255,255,255,0.6);
        }

        .bento-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: auto;
            gap: 1.5rem;
        }

        .bento-item {
            grid-column: span 12;
            display: flex; flex-direction: column; justify-content: space-between;
        }

        @media (min-width: 768px) {
            .bento-item.span-4 { grid-column: span 4; }
            .bento-item.span-6 { grid-column: span 6; }
            .bento-item.span-8 { grid-column: span 8; }
            .bento-item.span-12 { grid-column: span 12; }
            .bento-item.row-2 { grid-row: span 2; }
        }

        .tag {
            display: inline-flex;
            align-items: center;
            padding: 0.4rem 1rem;
            border-radius: 50px;
            font-family: var(--f-main);
            font-weight: 600;
            font-size: 0.85rem;
            background: rgba(255,255,255,0.8);
            color: var(--c-primary);
            border: 1px solid rgba(59, 130, 160, 0.2);
            margin-bottom: 1rem;
            width: fit-content;
        }

        /* --- Hero Section --- */
        .hero-layout {
            display: grid;
            grid-template-columns: 1fr;
            text-align: center;
            gap: 2rem;
        }
        @media (min-width: 1024px) {
            .hero-layout {
                grid-template-columns: 1.2fr 1fr; /* Text left, visual right */
                text-align: left;
                height: 80vh;
                align-items: center;
            }
        }

        .avatar-mask {
            width: 200px; height: 200px;
            margin: 0 auto;
            clip-path: polygon(25% 0%, 100% 0%, 75% 100%, 0% 100%); /* Parallelogram */
            transition: 0.5s var(--ease-out);
        }
        .avatar-mask:hover {
            clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%); /* Square */
        }
        .avatar-img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(100%); transition: 0.5s; }
        .avatar-mask:hover .avatar-img { filter: grayscale(0%); transform: scale(1.1); }

        /* --- Navigation --- */
        .nav-fixed {
            position: fixed; top: 2rem; left: 2rem; z-index: 50;
            font-family: var(--f-main); font-weight: 700;
            color: var(--c-primary); text-decoration: none;
            display: flex; align-items: center; gap: 0.5rem;
            mix-blend-mode: multiply;
        }
        .nav-fixed:hover { color: var(--c-accent); }

        /* --- Scroll Progress Bar --- */
        .scroll-line {
            position: fixed; top: 0; left: 0; height: 4px; width: 100%;
            background: linear-gradient(to right, var(--c-primary), var(--c-accent));
            transform-origin: left; transform: scaleX(0); z-index: 100;
        }

        /* --- Footer --- */
        .footer-link {
            font-size: 3rem; color: var(--c-secondary); margin: 0 1rem; transition: 0.3s;
        }
        .footer-link:hover { color: var(--c-accent); transform: scale(1.1) rotate(5deg); }

    </style>
</head>
<body>

    <div class="scroll-line"></div>
    <a href="/guild" class="nav-fixed"><i class="fa-solid fa-arrow-left"></i> GUILD_ARCHIVE</a>

    <!-- WebGL Background -->
    <div id="webgl-container"></div>

    <div class="scroller">

        <!-- SECTION 1: HERO - The Architect -->
        <section class="section">
            <div class="container hero-layout">
                <div class="gs-reveal">
                    <span class="tag">System Status: Online</span>
                    <h1>The Kinetic<br><span class="accent-text">Architect</span></h1>
                    <p style="font-size: 1.25rem; color: var(--c-secondary); margin-top: 1.5rem; max-width: 50ch;">
                        我是 Michael Lai。<br>
                        半路出家的數據煉金術士。在混沌中建立秩序，在靜止中創造動能。
                    </p>
                    <div style="margin-top: 3rem; display: flex; gap: 1rem; align-items: center;">
                        <span style="font-family: var(--f-main); font-weight: 700; font-size: 0.9rem; color: var(--c-primary);">SCROLL TO INITIALIZE</span>
                        <div style="width: 50px; height: 1px; background: var(--c-primary);"></div>
                    </div>
                </div>
                <!-- Right side is reserved for the 3D object interaction -->
                <div style="position: relative; height: 100%; min-height: 400px;" class="gs-reveal">
                    <!-- The 3D Object will float here initially -->
                </div>
            </div>
        </section>

        <!-- SECTION 2: BENTO GRID - The Variables -->
        <section class="section">
            <div class="container">
                <div class="gs-reveal" style="margin-bottom: 3rem;">
                    <span class="tag">Core Variables</span>
                    <h2>Analysis & <span class="accent-text">Intuition</span></h2>
                </div>

                <div class="bento-grid">

                    <!-- Bio Card -->
                    <div class="bento-item span-8 glass-panel gs-reveal">
                        <div style="display: flex; gap: 2rem; align-items: center; flex-wrap: wrap;">
                            <div class="avatar-mask">
                                <img src="/assets/img/guild/michael/avatar.webp" class="avatar-img" alt="Michael Lai">
                            </div>
                            <div style="flex: 1; min-width: 250px;">
                                <h3 class="heading-font" style="font-size: 1.5rem; margin-bottom: 1rem;">Origin Story</h3>
                                <p>
                                    從非本科系出發，我學會了用不同的鏡頭看世界。
                                    數據不只是冰冷的數字，它是行為的軌跡 (Trajectory)。
                                    目標是從分析師進化為<span class="accent-text">數據專家</span>，
                                    用代碼編織出自動化的未來。
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Stat Card: Automation -->
                    <div class="bento-item span-4 glass-panel gs-reveal" style="background: rgba(59, 130, 160, 0.1);">
                        <i class="fa-solid fa-code-branch" style="font-size: 3rem; color: var(--c-primary); margin-bottom: 1rem;"></i>
                        <h3 class="heading-font">Source Code</h3>
                        <p style="font-size: 0.9rem;">
                            享受將繁瑣流程轉化為優雅的自動化腳本。
                            效率是我的美學。
                        </p>
                    </div>

                    <!-- Interest: AI -->
                    <div class="bento-item span-4 glass-panel gs-reveal">
                        <i class="fa-solid fa-brain" style="font-size: 3rem; color: var(--c-accent); margin-bottom: 1rem;"></i>
                        <h3 class="heading-font">AI Synthesis</h3>
                        <p style="font-size: 0.9rem;">
                            利用 AI 生成未知。
                            探索人腦與矽基智慧的共生邊界。
                        </p>
                    </div>

                    <!-- Interest: Cats -->
                    <div class="bento-item span-4 glass-panel gs-reveal">
                        <i class="fa-solid fa-cat" style="font-size: 3rem; color: var(--c-text); margin-bottom: 1rem;"></i>
                        <h3 class="heading-font">Feline Logic</h3>
                        <p style="font-size: 0.9rem;">
                            貓咪是真愛。
                            學習牠們的優雅、獨立，以及對環境的敏銳觀察。
                        </p>
                    </div>

                    <!-- Interest: Basketball -->
                    <div class="bento-item span-4 glass-panel gs-reveal" style="background: rgba(249, 115, 22, 0.1);">
                        <i class="fa-solid fa-basketball" style="font-size: 3rem; color: var(--c-accent); margin-bottom: 1rem;"></i>
                        <h3 class="heading-font">Kinetic Flow</h3>
                        <p style="font-size: 0.9rem;">
                            籃球場上的動態博弈。
                            預判軌跡、瞬間決策，享受流汗的真實感。
                        </p>
                    </div>

                </div>
            </div>
        </section>

        <!-- SECTION 3: FOOTER - Connect -->
        <section class="section" style="min-height: 60vh;">
            <div class="container" style="text-align: center;">
                <div class="gs-reveal">
                    <span class="tag">Link Start</span>
                    <h2 style="font-size: clamp(3rem, 6vw, 5rem);">Ready to <span class="accent-text">Collaborate?</span></h2>
                    <p style="margin-bottom: 3rem;">正在尋找數據分析相關機會</p>

                    <div>
                        <a href="https://www.threads.net/@michael_lwt" target="_blank" class="footer-link"><i class="fa-brands fa-threads"></i></a>
                        <a href="https://www.instagram.com/michael_lwt/" target="_blank" class="footer-link"><i class="fa-brands fa-instagram"></i></a>
                    </div>
                </div>

                <div style="margin-top: 5rem; opacity: 0.5; font-size: 0.8rem;">
                    Made with <i class="fa-solid fa-bolt" style="color: var(--c-accent);"></i> by SuperGalen's Dungeon
                </div>
            </div>
        </section>

    </div>

    <!-- SCRIPT: Logic -->
    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        // --- 1. SETUP ---
        const container = document.getElementById('webgl-container');
        const scene = new THREE.Scene();
        // Background color handled by CSS, but fog needs to match
        const bgHex = 0xF8FAFC;
        scene.fog = new THREE.FogExp2(bgHex, 0.02);

        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.z = 25;

        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5)); // Limit for performance
        // Tone mapping for realistic glass lighting
        renderer.toneMapping = THREE.ReinhardToneMapping;
        renderer.toneMappingExposure = 1.5;
        container.appendChild(renderer.domElement);

        // --- 2. LIGHTING (Crucial for Glass) ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        scene.add(ambientLight);

        const dirLight = new THREE.DirectionalLight(0xffffff, 2);
        dirLight.position.set(10, 20, 10);
        scene.add(dirLight);

        const accentLight = new THREE.PointLight(0xF97316, 5, 50);
        accentLight.position.set(-5, 5, 5);
        scene.add(accentLight);

        // --- 3. THE KINETIC OBJECT (Morphing Blob) ---
        // Using Icosahedron with high detail for displacement
        const geometry = new THREE.IcosahedronGeometry(4, 8); // Reduced segments for performance

        // Physical Glass Material
        const material = new THREE.MeshPhysicalMaterial({
            color: 0x3B82A0,
            metalness: 0.1,
            roughness: 0.1,
            transmission: 0.95,  // Glass
            thickness: 2,
            ior: 1.5,
            clearcoat: 1,
            clearcoatRoughness: 0.1,
            side: THREE.DoubleSide
        });

        // Add displacement via custom shader modification (simulated here with vertex manipulation for performance/compatibility)
        // We will animate the vertices in the render loop for the "liquid" effect

        const mesh = new THREE.Mesh(geometry, material);
        mesh.position.set(5, 0, 0); // Initial position (Right side)
        scene.add(mesh);

        // Internal Core (The "Energy")
        const coreGeo = new THREE.IcosahedronGeometry(2, 1);
        const coreMat = new THREE.MeshBasicMaterial({
            color: 0xF97316,
            wireframe: true,
            transparent: true,
            opacity: 0.5
        });
        const core = new THREE.Mesh(coreGeo, coreMat);
        mesh.add(core); // Child of the glass mesh

        // Floating Particles (The "Data")
        const particlesCount = 200;
        const posArray = new Float32Array(particlesCount * 3);
        for(let i=0; i<particlesCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 40;
        }
        const partGeo = new THREE.BufferGeometry();
        partGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const partMat = new THREE.PointsMaterial({
            size: 0.15,
            color: 0x3B82A0,
            transparent: true,
            opacity: 0.6
        });
        const particleSystem = new THREE.Points(partGeo, partMat);
        scene.add(particleSystem);

        // --- 4. ANIMATION LOOP ---
        const clock = new THREE.Clock();
        const originalPositions = geometry.attributes.position.array.slice(); // Store base shape

        // Mouse Physics
        const mouse = new THREE.Vector2();
        const targetMouse = new THREE.Vector2();
        const mouseVel = new THREE.Vector2();

        window.addEventListener('mousemove', (e) => {
            const x = (e.clientX / window.innerWidth) * 2 - 1;
            const y = -(e.clientY / window.innerHeight) * 2 + 1;

            // Calculate velocity
            mouseVel.x = x - targetMouse.x;
            mouseVel.y = y - targetMouse.y;

            targetMouse.set(x, y);
        });

        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();

            // Smooth mouse follow
            mouse.lerp(targetMouse, 0.1);

            // 1. Liquid Morphing Effect
            // We manipulate vertices based on Perlin-like noise (sine waves here for simplicity without external lib)
            const positions = geometry.attributes.position.array;

            // Optimization: Only update every other frame or if mouse is moving
            // For now, full update for smoothness

            const positionAttribute = geometry.attributes.position;
            const count = positionAttribute.count;

            for (let i = 0; i < count; i++) {
                const ox = originalPositions[i * 3];
                const oy = originalPositions[i * 3 + 1];
                const oz = originalPositions[i * 3 + 2];

                // Noise formula
                const noise = Math.sin(ox * 0.5 + time) * Math.cos(oy * 0.5 + time) * Math.sin(oz * 0.5 + time);
                const pulse = 1 + (noise * 0.2) + (Math.sin(time * 2) * 0.05);

                // Mouse Impact (Dribble)
                // Need to project mouse (screen) to world roughly
                // Or just use a simpler distance check from center + mouse offset
                const dx = (ox + mesh.position.x) - (mouse.x * 20);
                const dy = (oy + mesh.position.y) - (mouse.y * 20);
                const dist = Math.sqrt(dx*dx + dy*dy);

                // Impact is stronger when mouse moves fast
                const velocityMag = Math.sqrt(mouseVel.x*mouseVel.x + mouseVel.y*mouseVel.y);
                const impact = Math.max(0, 1 - dist / 8) * velocityMag * 10;

                positions[i * 3] = ox * (pulse + impact);
                positions[i * 3 + 1] = oy * (pulse + impact);
                positions[i * 3 + 2] = oz * (pulse + impact);
            }
            geometry.attributes.position.needsUpdate = true;
            geometry.computeVertexNormals(); // Crucial for lighting updates

            // 2. Rotation
            mesh.rotation.y = time * 0.1;
            mesh.rotation.z = time * 0.05;
            core.rotation.x = -time * 0.2;

            // 3. Particle Flow
            particleSystem.rotation.y = time * 0.05;

            // 4. Parallax
            camera.position.x += (mouse.x * 2 - camera.position.x) * 0.05;
            camera.position.y += (mouse.y * 2 - camera.position.y) * 0.05;
            camera.lookAt(0, 0, 0);

            renderer.render(scene, camera);
        }
        animate();

        // --- 5. SCROLL INTERACTIONS (GSAP) ---
        gsap.registerPlugin(ScrollTrigger);

        // Progress Bar
        gsap.to('.scroll-line', {
            scaleX: 1,
            ease: 'none',
            scrollTrigger: {
                trigger: 'body',
                start: 'top top',
                end: 'bottom bottom',
                scrub: 0.5
            }
        });

        // Timeline for the Object's Journey
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: '.scroller',
                start: 'top top',
                end: 'bottom bottom',
                scrub: 1
            }
        });

        // Move mesh from Right (Hero) to Center (Grid) to Bottom
        // Assuming Hero Layout: Mesh is center-right.
        // Screen coordinates need to be mapped to World Space roughly.
        mesh.position.set(6, 0, 0); // Start position

        // Step 1: Move to center for Bento Grid
        tl.to(mesh.position, { x: 0, y: 0, z: 5, duration: 1, ease: 'power1.inOut' });
        tl.to(mesh.scale, { x: 0.6, y: 0.6, z: 0.6, duration: 1 }, "<"); // Shrink slightly to fit behind text

        // Step 2: Explode/Disperse at Footer
        tl.to(mesh.position, { y: -5, duration: 1 });
        tl.to(material, { opacity: 0, duration: 0.5 }, ">-0.5"); // Fade out glass
        tl.to(core.scale, { x: 5, y: 5, z: 5, duration: 1 }, "<"); // Core expands

        // Reveal Animations
        gsap.utils.toArray('.gs-reveal').forEach((elem) => {
            gsap.from(elem, {
                scrollTrigger: {
                    trigger: elem,
                    start: "top 85%",
                    toggleActions: "play none none reverse"
                },
                y: 60,
                opacity: 0,
                duration: 1.2,
                ease: "power3.out"
            });
        });

        // Resize Handler
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>
</html>