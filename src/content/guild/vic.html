<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIC NAIL | THE LOGIC ALCHEMIST</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=JetBrains+Mono:wght@300;700&family=Noto+Sans+TC:wght@300;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        :root {
            --c-bg: #000000;
            --c-accent: #ff003c; /* Cyber Red */
            --c-sec: #00f3ff;    /* Cyber Cyan */
            --c-text: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background-color: var(--c-bg);
            color: var(--c-text);
            font-family: 'Noto Sans TC', sans-serif;
            overflow-x: hidden;
            width: 100vw;
        }

        /* --- Canvas --- */
        #gl-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0;
        }

        /* --- UI Overlay --- */
        .ui-layer {
            position: relative; z-index: 10;
            pointer-events: none; /* Let scroll pass through mostly */
        }

        nav {
            position: fixed; top: 0; left: 0; width: 100%;
            padding: 2rem;
            display: flex; justify-content: space-between; align-items: center;
            mix-blend-mode: difference;
            z-index: 100;
        }
        .brand {
            font-family: 'Anton', sans-serif;
            font-size: 2rem; letter-spacing: 2px;
            text-transform: uppercase;
        }
        .brand span { color: var(--c-accent); }

        .menu-btn {
            pointer-events: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            border: 1px solid #fff; padding: 0.5rem 1rem;
            text-decoration: none; color: #fff;
            transition: 0.3s;
        }
        .menu-btn:hover { background: #fff; color: #000; }

        /* --- Sections --- */
        section {
            position: relative;
            min-height: 100vh;
            display: flex; flex-direction: column; justify-content: center;
            padding: 10vw;
        }

        .hero-title {
            font-family: 'Anton', sans-serif;
            font-size: clamp(4rem, 15vw, 12rem);
            line-height: 0.85;
            text-transform: uppercase;
            mix-blend-mode: exclusion;
            opacity: 0; /* Animated in */
            transform: translateY(50px);
        }
        .hero-subtitle {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem; margin-top: 2rem;
            color: var(--c-sec);
            max-width: 600px;
        }

        .content-box {
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            border-left: 4px solid var(--c-accent);
            padding: 2rem;
            max-width: 600px;
            margin-left: auto; /* Align right */
            transform: translateX(100px); opacity: 0;
        }
        .content-box.left { margin-left: 0; margin-right: auto; transform: translateX(-100px); border-left: none; border-right: 4px solid var(--c-sec); }

        h2 {
            font-family: 'Anton', sans-serif;
            font-size: 4rem; margin-bottom: 1rem;
            text-transform: uppercase;
            -webkit-text-stroke: 1px #fff; color: transparent;
        }
        .content-box:hover h2 { color: #fff; }

        p {
            font-size: 1.1rem; line-height: 1.8; margin-bottom: 1.5rem;
            color: #ccc;
        }

        .stats {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
            font-family: 'JetBrains Mono', monospace;
            margin-top: 2rem;
        }
        .stat-item h3 { font-size: 2rem; color: var(--c-sec); }
        .stat-item span { font-size: 0.8rem; color: #888; text-transform: uppercase; }

        .social-links {
            display: flex; gap: 20px; margin-top: 2rem; pointer-events: auto;
        }
        .social-icon {
            font-size: 1.5rem; color: #fff; transition: 0.3s;
        }
        .social-icon:hover { color: var(--c-accent); transform: scale(1.2); }

        /* --- Scroll Progress --- */
        .progress-bar {
            position: fixed; right: 2rem; top: 50%; transform: translateY(-50%);
            height: 200px; width: 2px; background: rgba(255,255,255,0.2);
            z-index: 90;
        }
        .progress-fill {
            width: 100%; height: 0%; background: var(--c-accent);
        }

        /* --- Loader --- */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 999;
            display: flex; justify-content: center; align-items: center;
            font-family: 'JetBrains Mono', monospace;
            color: var(--c-sec);
            font-size: 1.5rem;
            letter-spacing: 0.2em;
        }
    </style>
</head>
<body>

    <div id="loader">DECRYPTING LOGIC...</div>

    <div id="gl-container"></div>

    <div class="ui-layer">
        <nav>
            <div class="brand">VIC <span>NAIL</span></div>
            <a href="/guild/" class="menu-btn">GUILD_INDEX</a>
        </nav>

        <div class="progress-bar"><div class="progress-fill" id="prog-fill"></div></div>

        <!-- S1: HERO -->
        <section id="s1">
            <h1 class="hero-title">LOGIC<br>ALCHEMIST</h1>
            <div class="hero-subtitle">
                // NAIL ARTIST . EDUCATOR . MAKER<br>
                EST. 18 YEARS
            </div>
        </section>

        <!-- S2: PHILOSOPHY -->
        <section id="s2">
            <div class="content-box">
                <h2>Decode<br>The Art</h2>
                <p>æˆ‘æ˜¯æ±æ±è€å¸«ã€‚èº«ç‚º PRESTO å°ç£å€è¬›å¸«ï¼Œæˆ‘æ‹’çµ•ç…§è¡¨æ“èª²çš„æ­»è¨˜ç¡¬èƒŒã€‚</p>
                <p>ã€ŒçŸ¥å…¶ç„¶ï¼Œæ›´è¦çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚ã€</p>
                <p>æˆ‘å°‡è¤‡é›œçš„æŠ€è¡“æ‹†è§£æˆã€Œé‚è¼¯å®Œå–„ã€çš„ç³»çµ±ã€‚å”¯æœ‰é€šé€é‚è¼¯ï¼Œæ‰èƒ½å°‡æŠ€è¡“çœŸæ­£å…§åŒ–ç‚ºæ­¦å™¨ã€‚</p>
            </div>
        </section>

        <!-- S3: GALLERY SHOWCASE (Trigger for 3D Gallery) -->
        <section id="s3" style="height: 150vh;">
            <!-- Spacer for 3D gallery interaction -->
        </section>

        <!-- S4: LIFE -->
        <section id="s4">
            <div class="content-box left">
                <h2>Full Stack<br>Life</h2>
                <p>è„«ä¸‹è¬›å¸«è¢ï¼Œæˆ‘æ˜¯å€‹é»æ»¿æŠ€èƒ½æ¨¹çš„é›œå­¸å®¶ã€‚</p>
                <p>ç«é‹åº—ã€Uberã€å·¥åœ°ã€æ°´é›» DIYã€å¹³é¢è¨­è¨ˆã€å½±éŸ³å‰ªè¼¯... æˆ‘çš„å±¥æ­·æ¯”è‰²å¡é‚„è±å¯Œã€‚</p>
                <div class="stats">
                    <div class="stat-item">
                        <h3>18y</h3>
                        <span>Experience</span>
                    </div>
                    <div class="stat-item">
                        <h3>âˆ</h3>
                        <span>Curiosity</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- S5: CURRENT -->
        <section id="s5">
            <div class="content-box">
                <h2>System<br>Update</h2>
                <p>å®¶æœ‰å…©éš»è²“ä¸»å­ ğŸˆã€‚</p>
                <p>æœ€è¿‘æ²‰è¿·æ–¼ N8N è‡ªå‹•åŒ–ï¼Œæ‰®æ¼”ç§‘æŠ€æ¥­çš„ã€Œæ…£è€é—†ã€ï¼Œæ¯å¤©æŒ‡ä½¿ AI å¹«æˆ‘å¯«ç¨‹å¼ã€‚</p>
                <div class="social-links">
                    <a href="https://www.threads.com/@dwng1274" target="_blank" class="social-icon"><i class="fa-brands fa-threads"></i></a>
                    <a href="https://www.facebook.com/VicNailArt" target="_blank" class="social-icon"><i class="fa-brands fa-facebook"></i></a>
                    <a href="https://www.instagram.com/dwng1274/" target="_blank" class="social-icon"><i class="fa-brands fa-instagram"></i></a>
                </div>
            </div>
        </section>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        import { ShaderPass } from 'three/addons/postprocessing/ShaderPass.js';
        import { RGBShiftShader } from 'three/addons/shaders/RGBShiftShader.js';

        // --- Config ---
        const CONFIG = {
            shardCount: 800,
            galleryImages: [
                '/assets/img/guild/vic/gallery_01.webp',
                '/assets/img/guild/vic/gallery_02.webp',
                '/assets/img/guild/vic/gallery_03.webp',
                '/assets/img/guild/vic/gallery_04.webp',
                '/assets/img/guild/vic/gallery_05.webp',
                '/assets/img/guild/vic/gallery_06.webp',
                '/assets/img/guild/vic/gallery_07.webp'
            ]
        };

        // --- Scene Setup ---
        const container = document.getElementById('gl-container');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x000000, 0.03);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.z = 10;

        const renderer = new THREE.WebGLRenderer({ antialias: false, powerPreference: "high-performance" });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
        container.appendChild(renderer.domElement);

        // --- Post Processing ---
        const composer = new EffectComposer(renderer);
        const renderPass = new RenderPass(scene, camera);
        composer.addPass(renderPass);

        const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
        bloomPass.threshold = 0;
        bloomPass.strength = 1.2;
        bloomPass.radius = 0.5;
        composer.addPass(bloomPass);

        const rgbShiftPass = new ShaderPass(RGBShiftShader);
        rgbShiftPass.uniforms['amount'].value = 0.001;
        composer.addPass(rgbShiftPass);

        // --- Lights ---
        const ambientLight = new THREE.AmbientLight(0x404040, 2);
        scene.add(ambientLight);

        const spotLight = new THREE.SpotLight(0xffffff, 50);
        spotLight.position.set(10, 20, 10);
        spotLight.angle = 0.3;
        spotLight.penumbra = 1;
        scene.add(spotLight);

        const blueLight = new THREE.PointLight(0x00f3ff, 5, 20);
        blueLight.position.set(-5, 0, 5);
        scene.add(blueLight);

        const redLight = new THREE.PointLight(0xff003c, 5, 20);
        redLight.position.set(5, -5, 5);
        scene.add(redLight);

        // --- Objects: The "Perfect Form" (Instanced Shards) ---

        const shardGeo = new THREE.ConeGeometry(0.1, 0.4, 3); // Spikes
        const shardMat = new THREE.MeshPhysicalMaterial({
            color: 0xffffff,
            metalness: 0.9,
            roughness: 0.1,
            clearcoat: 1.0,
            clearcoatRoughness: 0.1,
        });

        const shards = new THREE.InstancedMesh(shardGeo, shardMat, CONFIG.shardCount);
        const dummy = new THREE.Object3D();
        const shardData = [];

        // Distribute in a Capsule shape
        for (let i = 0; i < CONFIG.shardCount; i++) {
            // Random point in capsule
            // Simplified: Just a tall cylinder with noise
            const r = (Math.random() * 2 - 1) * 2; // radius var
            const theta = Math.random() * Math.PI * 2;
            const y = (Math.random() * 2 - 1) * 4; // Height

            // Constrain to "Perfect" shape initially
            const perfectR = 1.5;
            const x = Math.cos(theta) * perfectR;
            const z = Math.sin(theta) * perfectR;

            // Store target (Perfect) and Explosion vector
            shardData.push({
                idx: i,
                origin: { x, y, z }, // The perfect shell
                exploded: { // The chaotic explosion
                    x: x * (2 + Math.random() * 5),
                    y: y * (2 + Math.random() * 5),
                    z: z * (2 + Math.random() * 5)
                },
                rotation: {
                    x: Math.random() * Math.PI,
                    y: Math.random() * Math.PI,
                    z: Math.random() * Math.PI
                },
                speed: 0.5 + Math.random() * 0.5
            });

            dummy.position.set(x, y, z);
            dummy.rotation.set(Math.random(), Math.random(), Math.random());
            dummy.updateMatrix();
            shards.setMatrixAt(i, dummy.matrix);
        }
        shards.instanceMatrix.needsUpdate = true;
        scene.add(shards);

        // --- Objects: The Logic Core (Wireframe) ---
        const coreGeo = new THREE.IcosahedronGeometry(1.2, 1);
        const coreMat = new THREE.MeshBasicMaterial({ color: 0xff003c, wireframe: true, transparent: true, opacity: 0 });
        const core = new THREE.Mesh(coreGeo, coreMat);
        scene.add(core);

        // --- Objects: Gallery Panels ---
        const textureLoader = new THREE.TextureLoader();
        const galleryGroup = new THREE.Group();
        scene.add(galleryGroup);

        const panels = [];

        CONFIG.galleryImages.forEach((url, i) => {
            const tex = textureLoader.load(url);
            const geo = new THREE.PlaneGeometry(3, 4); // Portrait
            const mat = new THREE.MeshBasicMaterial({ map: tex, side: THREE.DoubleSide, transparent: true, opacity: 0 });
            const mesh = new THREE.Mesh(geo, mat);

            // Position them in a circle around the center
            const angle = (i / CONFIG.galleryImages.length) * Math.PI * 2;
            const radius = 6;
            mesh.position.set(Math.cos(angle) * radius, 0, Math.sin(angle) * radius);
            mesh.lookAt(0, 0, 0);

            mesh.userData = {
                angle: angle,
                radius: radius,
                y: 0
            };

            galleryGroup.add(mesh);
            panels.push(mesh);
        });

        // --- Animation State ---
        let scrollProgress = 0; // 0 to 1

        // --- GSAP Setup ---
        gsap.registerPlugin(ScrollTrigger);

        // Section Animations
        gsap.utils.toArray('.content-box').forEach(box => {
            gsap.to(box, {
                scrollTrigger: {
                    trigger: box,
                    start: "top 80%",
                    end: "top 50%",
                    scrub: 1
                },
                x: 0,
                opacity: 1
            });
        });

        // Main 3D Timeline
        // We map the entire scroll height to a timeline
        ScrollTrigger.create({
            trigger: "body",
            start: "top top",
            end: "bottom bottom",
            onUpdate: (self) => {
                scrollProgress = self.progress;

                // Progress Bar
                const progFill = document.getElementById('prog-fill');
                if (progFill) progFill.style.height = (self.progress * 100) + '%';

                // RGB Shift based on velocity
                const vel = Math.abs(self.getVelocity());
                gsap.to(rgbShiftPass.uniforms['amount'], { value: 0.001 + vel * 0.00005, duration: 0.1 });
            }
        });

        // --- Render Loop ---
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);
            const t = clock.getElapsedTime();

            // 1. Shard Animation (Implosion/Explosion)
            let explosionFactor = 0;
            // S1 (0-0.2): Stable
            // S2 (0.2-0.5): Explode
            if (scrollProgress < 0.2) explosionFactor = scrollProgress * 0.5;
            else if (scrollProgress < 0.6) explosionFactor = 0.1 + (scrollProgress - 0.2) * 5;
            else explosionFactor = 2.1; // Maximum Chaos

            // Update Shards
            for (let i = 0; i < CONFIG.shardCount; i++) {
                const data = shardData[i];

                // Lerp between Origin and Exploded
                const lerpFactor = Math.min(1, explosionFactor);

                const tx = THREE.MathUtils.lerp(data.origin.x, data.exploded.x, lerpFactor);
                const ty = THREE.MathUtils.lerp(data.origin.y, data.exploded.y, lerpFactor);
                const tz = THREE.MathUtils.lerp(data.origin.z, data.exploded.z, lerpFactor);

                // Add some noise based on time
                const noiseX = Math.sin(t + i) * 0.1;

                dummy.position.set(tx + noiseX, ty, tz);

                // Rotation
                dummy.rotation.x = data.rotation.x + t * data.speed;
                dummy.rotation.y = data.rotation.y + t * data.speed;

                // Scale decreases as it explodes to simulate disintegration
                const scale = Math.max(0.1, 1 - explosionFactor * 0.4);
                dummy.scale.setScalar(scale);

                dummy.updateMatrix();
                shards.setMatrixAt(i, dummy.matrix);
            }
            shards.instanceMatrix.needsUpdate = true;
            shards.rotation.y = t * 0.1; // General spin

            // 2. Core Logic Reveal
            if (scrollProgress > 0.15 && scrollProgress < 0.6) {
                const opacity = Math.min(1, (scrollProgress - 0.15) * 5);
                core.material.opacity = opacity;
                core.rotation.x = t;
                core.rotation.y = t * 1.5;
            } else {
                core.material.opacity = Math.max(0, core.material.opacity - 0.05);
            }

            // 3. Gallery Panels
            // Appear at S3 (around 0.4 - 0.7)
            let galleryOp = 0;
            if (scrollProgress > 0.3 && scrollProgress < 0.7) {
                galleryOp = Math.min(1, (scrollProgress - 0.3) * 5);
            } else if (scrollProgress >= 0.7) {
                 galleryOp = Math.max(0, 1 - (scrollProgress - 0.7) * 5);
            }

            panels.forEach((mesh, i) => {
                mesh.material.opacity = galleryOp;

                if (galleryOp > 0.01) {
                    // Spiral motion
                    const angleOffset = t * 0.2;
                    const r = mesh.userData.radius + Math.sin(t + i) * 0.5;

                    mesh.position.x = Math.cos(mesh.userData.angle + angleOffset) * r;
                    mesh.position.z = Math.sin(mesh.userData.angle + angleOffset) * r;
                    mesh.position.y = Math.sin(t + i) * 1;

                    mesh.lookAt(camera.position);
                }
            });

            // 4. Camera Movement
            // S1: Front (z=10)
            // S2: Zoom out slightly
            // S3: Orbit

            const camTargetZ = 10 + scrollProgress * 10;
            camera.position.z += (camTargetZ - camera.position.z) * 0.05;

            const camTargetY = Math.sin(scrollProgress * Math.PI) * 5;
            camera.position.y += (camTargetY - camera.position.y) * 0.05;

            camera.lookAt(0, 0, 0);

            composer.render();
        }

        animate();

        // --- Resize ---
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- Init ---
        let introStarted = false;
        function startIntro() {
            if (introStarted) return;
            introStarted = true;

            const tl = gsap.timeline();
            tl.to('#loader', {
                opacity: 0,
                duration: 0.8,
                ease: 'power2.inOut',
                onComplete: () => {
                    const loader = document.getElementById('loader');
                    if(loader) {
                        loader.style.display = 'none';
                        loader.remove(); // Remove from DOM completely to prevent ghosting
                    }
                }
            })
            .to('.hero-title', { opacity: 1, y: 0, duration: 1.5, ease: 'power4.out' }, "-=0.5");
        }

        window.addEventListener('load', startIntro);

        // Failsafe: Force start after 1.5s regardless of load state
        setTimeout(() => {
            if (!introStarted) {
                console.warn('Loader fallback triggered');
                startIntro();
            }
        }, 1500);

    </script>
</body>
</html>