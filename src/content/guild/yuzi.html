<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yuzi | Solar Velocity</title>
    <meta name="description" content="æŸšå­ Yuzi - Solar Explorer. A journey through space, nature, and connection.">
    <meta property="og:image" content="/assets/img/guild/yuzi/gallery_3.webp">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,400;0,600;0,800;1,800&family=Zen+Kaku+Gothic+New:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Libraries -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <style>
        :root {
            --c-solar: #FFDD00;
            --c-flash: #FFFFFF;
            --c-dark: #050505;
            --c-energy: #FF4D00;
            --c-glass: rgba(5, 5, 5, 0.85);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; cursor: none; }

        body {
            background-color: var(--c-dark);
            color: var(--c-flash);
            font-family: 'Zen Kaku Gothic New', sans-serif;
            overflow-x: hidden;
            width: 100vw;
        }

        /* --- Cursor --- */
        #cursor {
            position: fixed; top: 0; left: 0; width: 20px; height: 20px;
            background: var(--c-solar); border-radius: 50%;
            pointer-events: none; z-index: 10000;
            transform: translate(-50%, -50%);
            mix-blend-mode: difference;
            transition: width 0.2s, height 0.2s, background 0.2s;
        }
        #cursor.hover { width: 80px; height: 80px; opacity: 0.8; background: #fff; mix-blend-mode: normal; }
        #cursor.hover::after {
            content: 'VIEW';
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #000; font-family: 'Kanit'; font-weight: 800; font-size: 12px;
        }

        /* --- Canvas --- */
        #webgl-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none;
        }

        /* --- Scroll Spacer --- */
        #scroll-spacer {
            height: 700vh; /* Increased for better pacing */
            width: 100%; position: relative;
            z-index: -1; pointer-events: none;
        }

        /* --- UI Overlay --- */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10;
        }

        /* Brand Mark (Logo) */
        .brand-mark {
            position: fixed; top: 2rem; left: 2rem; z-index: 100;
            display: flex; align-items: center; gap: 10px;
            pointer-events: auto; mix-blend-mode: difference;
            text-decoration: none;
        }
        .mark-symbol {
            width: 40px; height: 40px; border: 2px solid var(--c-solar);
            display: grid; place-items: center;
            font-family: 'Kanit'; font-weight: 800; font-size: 1.2rem; color: var(--c-solar);
            transform: rotate(45deg);
        }
        .mark-symbol span { transform: rotate(-45deg); }
        .mark-text {
            font-family: 'Kanit'; font-weight: 700; font-size: 1rem; letter-spacing: 0.1em;
            color: var(--c-solar); display: flex; flex-direction: column; line-height: 1;
        }
        .mark-text span { font-size: 0.7rem; opacity: 0.7; font-weight: 400; }

        /* Typography & Layout */
        .hero-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; width: 100%;
        }

        .big-text {
            font-family: 'Kanit', sans-serif;
            font-weight: 800;
            font-style: italic;
            text-transform: uppercase;
            font-size: clamp(4rem, 15vw, 12rem);
            line-height: 0.85;
            color: transparent;
            -webkit-text-stroke: 2px var(--c-solar);
            position: relative;
            z-index: 2;
            white-space: nowrap;
        }
        .big-text.fill { color: var(--c-solar); -webkit-text-stroke: 0; text-shadow: 0 0 40px var(--c-solar); }
        .sub-hero {
            font-family: 'Kanit'; letter-spacing: 0.5em; margin-top: 2rem; font-size: 1.2rem;
            color: #fff; text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        .content-card {
            background: var(--c-glass);
            border: 1px solid var(--c-solar);
            border-left: 5px solid var(--c-solar);
            padding: 2.5rem;
            max-width: 550px;
            width: 85%;
            backdrop-filter: blur(10px);
            opacity: 0;
            pointer-events: auto;
            box-shadow: 0 0 30px rgba(255, 221, 0, 0.1);
            position: absolute;
        }

        .card-left { left: 8%; top: 50%; transform: translateY(-50%); }
        .card-right { right: 8%; top: 50%; transform: translateY(-50%); }
        .card-center { left: 50%; top: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 700px; text-align: center; }

        .content-card h3 {
            font-family: 'Kanit', sans-serif;
            font-size: 2.5rem; color: var(--c-solar); margin-bottom: 1.5rem;
            text-transform: uppercase; font-style: italic;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 0.5rem;
            display: flex; justify-content: space-between;
        }
        .content-card h3 span { font-size: 1rem; opacity: 0.7; font-style: normal; align-self: center; font-weight: 400; }

        .content-card p {
            font-size: 1.1rem; line-height: 1.7; color: #eee; margin-bottom: 1rem;
        }
        .highlight { color: var(--c-solar); font-weight: 700; background: rgba(255,221,0,0.1); padding: 0 5px; }

        .data-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;
            font-family: 'Kanit', sans-serif; color: #aaa; font-size: 0.9rem;
        }
        .data-item strong { color: #fff; display: block; font-size: 1.1rem; }

        /* Floating Icons Container */
        .icon-cloud {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 5;
            perspective: 1000px;
        }
        .floating-icon {
            position: absolute; font-size: 4rem; color: var(--c-solar);
            text-shadow: 0 0 20px rgba(255, 221, 0, 0.5);
            opacity: 0;
        }

        /* HUD Elements */
        .hud-line {
            position: fixed; background: var(--c-solar); opacity: 0.2; pointer-events: none;
        }
        .hud-v { width: 1px; height: 100vh; left: 6%; top: 0; }
        .hud-h { width: 100vw; height: 1px; top: 92%; left: 0; }
        .hud-corner {
            position: fixed; bottom: 2rem; right: 2rem;
            font-family: 'Kanit'; font-size: 4rem; color: rgba(255,255,255,0.1);
            font-weight: 800; pointer-events: none;
        }

        /* Finale */
        #finale {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--c-solar); z-index: 50;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            clip-path: circle(0% at 50% 50%);
            transition: clip-path 0.8s cubic-bezier(0.7, 0, 0.3, 1);
            pointer-events: auto; text-align: center;
            color: #000;
        }
        #finale.active { clip-path: circle(150% at 50% 50%); }

        .finale-avatar {
            width: 220px; height: 220px; border-radius: 50%;
            border: 8px solid #000;
            object-fit: cover; margin-bottom: 2rem;
            box-shadow: 10px 10px 0px rgba(0,0,0,0.2);
        }
        .socials { display: flex; gap: 2rem; font-size: 3.5rem; margin-top: 2rem; }
        .socials a { color: #000; transition: all 0.2s; display: block; }
        .socials a:hover { transform: scale(1.2) rotate(-10deg); color: #fff; }

        @media (max-width: 768px) {
            .content-card { width: 90%; max-width: none; padding: 1.5rem; left: 5% !important; right: auto !important; top: 60% !important; transform: translateY(0) !important; }
            .card-center { top: 60% !important; transform: translate(-50%, 0) !important; }
            .data-grid { grid-template-columns: 1fr; }
            .big-text { font-size: 15vw; }
            .brand-mark { top: 1rem; left: 1rem; }
            .hud-v { left: 0; }
            .floating-icon { font-size: 2.5rem; }
        }

    </style>
</head>
<body>

    <div id="cursor"></div>
    <div id="webgl-container"></div>
    <div id="scroll-spacer"></div>

    <a href="/guild/" class="brand-mark">
        <div class="mark-symbol"><span>Y</span></div>
        <div class="mark-text">
            YUZI
            <span>SOLAR EXPLORER</span>
        </div>
    </a>

    <div class="hud-line hud-v"></div>
    <div class="hud-line hud-h"></div>
    <div class="hud-corner">04</div>

    <div class="icon-cloud" id="icon-cloud">
        <!-- Icons populated by JS -->
    </div>

    <!-- Content Overlays controlled by GSAP -->
    <div class="overlay">
        <!-- Hero -->
        <div id="hero-text" class="hero-container">
            <div class="big-text">SOLAR</div>
            <div class="big-text fill">VELOCITY</div>
            <div class="sub-hero">EXPLORER CLASS // YUZI</div>
        </div>

        <!-- 1. Profile Data (LEFT, Image RIGHT) -->
        <div id="card-origin" class="content-card card-left">
            <h3>// 01 PROFILE <span>DATA LOG</span></h3>

            <div class="data-grid">
                <div class="data-item"><strong>NAME</strong>æŸšå­ (è¬æ²…ä½‘)</div>
                <div class="data-item"><strong>TYPE</strong>ENFP | ç‰¡ç¾Šåº§</div>
                <div class="data-item"><strong>AGE</strong>28 â†’ 29</div>
                <div class="data-item"><strong>SPECS</strong>180cm / 65kg</div>
                <div class="data-item"><strong>BASE</strong>é›™åŒ— / æ·¡æ°´</div>
                <div class="data-item"><strong>ENERGY</strong>Husky Mode ğŸ•</div>
            </div>

            <p>æˆ‘æ˜¯æŸšå­ï¼Œä¸€å€‹ç†±æ„›æ¢ç´¢å¤–åœ¨ä¸–ç•Œï¼Œä¹Ÿæ·±æ½›å…§åœ¨å®‡å®™çš„äººã€‚</p>
            <p>ç•¢æ¥­æ–¼<span class="highlight">è¼”ä»å¤§å­¸æ™¯è§€è¨­è¨ˆ</span>ï¼Œæˆ‘ä¸åªè¨­è¨ˆç’°å¢ƒï¼Œæ›´åœ¨ä¹äººèˆ‡ç©ºé–“çš„é€£çµã€‚å¾åœ’ä¸åˆ°ç¤¾ç¾¤å¼•å°è€…ï¼Œæˆ‘çš„è·æ¶¯è·¯å¾‘é›–ç„¶ä»»æ€§ï¼Œä½†ç›®æ¨™ä¸€è‡´ï¼š<br><strong>å‰µé€ å®‰å…¨ã€è¢«æ¥ç´çš„é€£çµã€‚</strong></p>
        </div>

        <!-- 2. Trajectory (RIGHT, Image LEFT) -->
        <div id="card-path" class="content-card card-right">
            <h3>// 02 TRAJECTORY <span>CAREER PATH</span></h3>
            <p>æˆ‘å–œæ­¡é™ªä¼´æ­£åœ¨æˆå½¢ä¸­çš„æ±è¥¿ï¼šä¸€å€‹ç©ºé–“ã€ä¸€å€‹åœ˜éšŠã€ä¸€æ®µé—œä¿‚ã€‚</p>
            <ul style="list-style: none; line-height: 2; margin-top: 1rem; font-family: 'Kanit';">
                <li><i class="fa-solid fa-seedling" style="color:var(--c-solar); width:20px;"></i> å°åŒ—èŠ±å‰æ‘åœ’ä¸ | ç†è§£ç”Ÿé•·ç¯€å¥</li>
                <li><i class="fa-solid fa-cube" style="color:var(--c-solar); width:20px;"></i> å…’ç«¥ç¨‹å¼å­¸è‹‘å€ä¸»ä»» | çµæ§‹åŒ–æµç¨‹</li>
                <li><i class="fa-solid fa-people-group" style="color:var(--c-solar); width:20px;"></i> å…±è­˜ç‡Ÿä¸»æŒ / åŸ¹è¨“ç¶“ç† | å»ºç«‹ä¿¡ä»»å ´åŸŸ</li>
            </ul>
        </div>

        <!-- 3. Vitality (LEFT, Image RIGHT) -->
        <div id="card-vitality" class="content-card card-left">
            <h3>// 03 VITALITY <span>HUSKY ENERGY</span></h3>
            <p>èº«é«”æ´¾çš„å­©å­ï¼Œè½èªªå€‹æ€§åƒ<span class="highlight">å“ˆå£«å¥‡</span>ã€‚</p>
            <p>å–œæ­¡è®“èº«é«”æ„Ÿå—å±±æµ·é¢¨æ—¥ã€‚æ—…è¡Œä¸æ˜¯é€ƒé›¢ï¼Œè€Œæ˜¯å›åˆ°è‡ªå·±ã€‚</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 1rem;">
                <span style="border:1px solid #fff; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">ğŸ æ’çƒ</span>
                <span style="border:1px solid #fff; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">ğŸ¥ çˆµå£«é¼“</span>
                <span style="border:1px solid #fff; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">ğŸƒ é•·è·‘</span>
                <span style="border:1px solid #fff; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">ğŸ¤¿ æ½›æ°´</span>
                <span style="border:1px solid #fff; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem;">ğŸ”ï¸ ç™»å±±</span>
            </div>
        </div>

        <!-- 4. Core (CENTER/BOTTOM) -->
        <div id="card-core" class="content-card card-center">
            <h3>// 04 CORE VALUE <span>PHILOSOPHY</span></h3>
            <p style="font-size: 1.3rem; color: #fff;"><strong>ã€Œå¤šé‡ä¼´ä¾¶é—œä¿‚å¯¦è¸è€…ã€</strong></p>
            <p>æ„›æœ‰å¾ˆå¤šæ¨£è²Œï¼Œæ ¸å¿ƒæ˜¯èª å¯¦ã€å°Šé‡èˆ‡é™ªä¼´ã€‚</p>
            <p>æˆ‘ä¸æ€¥è‘—å®šç¾©å½¢å¼ï¼Œåªåœ¨ä¹å‰µé€ æœ‰æ„ç¾©çš„é€£çµã€‚<br>å¸Œæœ›èƒ½æˆç‚ºä½ ç”Ÿå‘½ä¸­çš„é™ªä¼´è€…èˆ‡å‰µé€ è€…ã€‚</p>
        </div>
    </div>

    <!-- Finale Screen -->
    <div id="finale">
        <img src="/assets/img/guild/yuzi/gallery_3.webp" class="finale-avatar">
        <h2 style="font-family: 'Kanit'; font-size: clamp(3rem, 8vw, 6rem); color: #000; line-height: 0.9; margin-bottom: 1rem;">LET'S CONNECT</h2>
        <p style="font-size: 1.5rem; color: #000; font-weight: 700; margin-bottom: 0.5rem;">èƒ½æ·±èŠã€èƒ½ç©ã€ä¹Ÿèƒ½ä¸€èµ·å®‰éœ</p>
        <p style="color: #444;">ä¹Ÿè¨±ï¼Œæˆ‘å€‘æœƒç›¸è™•å¾—ä¸éŒ¯ã€‚</p>

        <div class="socials">
            <a href="https://www.threads.net/@rbt330" target="_blank"><i class="fa-brands fa-threads"></i></a>
            <a href="https://www.instagram.com/rbt330/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
        </div>
        <button onclick="document.getElementById('finale').classList.remove('active')" style="margin-top: 3rem; background: #000; border: none; padding: 1rem 2rem; color: #FFDD00; font-family: 'Kanit'; font-weight: 800; font-size: 1.2rem; cursor: none; transition: transform 0.2s;">
            RE-ENGAGE SYSTEM
        </button>
    </div>

    <script type="module">
        import * as THREE from 'three';

        // --- Setup ---
        const container = document.getElementById('webgl-container');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x050505, 0.015);

        const camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // --- Assets ---
        const textureLoader = new THREE.TextureLoader();
        const imgUrls = [
            '/assets/img/guild/yuzi/gallery_1.webp',
            '/assets/img/guild/yuzi/gallery_2.webp',
            '/assets/img/guild/yuzi/gallery_3.webp',
            '/assets/img/guild/yuzi/gallery_4.webp',
            '/assets/img/guild/yuzi/gallery_5.webp',
            '/assets/img/guild/yuzi/gallery_6.webp',
            '/assets/img/guild/yuzi/gallery_7.webp'
        ];

        const textures = imgUrls.map(url => textureLoader.load(url));

        // --- Scene Objects ---
        const worldGroup = new THREE.Group();
        scene.add(worldGroup);

        // 1. Hyper-Speed Particles
        const pGeo = new THREE.BufferGeometry();
        const pCount = 3000;
        const pPos = new Float32Array(pCount * 3);
        const pCol = new Float32Array(pCount * 3);

        for(let i=0; i<pCount; i++) {
            const r = 5 + Math.random() * 40;
            const theta = Math.random() * Math.PI * 2;
            const z = (Math.random() - 0.5) * 400;

            pPos[i*3] = Math.cos(theta) * r;
            pPos[i*3+1] = Math.sin(theta) * r;
            pPos[i*3+2] = z;

            const seed = Math.random();
            if(seed > 0.6) { // Yellow
                pCol[i*3] = 1.0; pCol[i*3+1] = 0.86; pCol[i*3+2] = 0.0;
            } else if (seed > 0.3) { // White
                pCol[i*3] = 1.0; pCol[i*3+1] = 1.0; pCol[i*3+2] = 1.0;
            } else { // Orange tint
                pCol[i*3] = 1.0; pCol[i*3+1] = 0.5; pCol[i*3+2] = 0.0;
            }
        }

        pGeo.setAttribute('position', new THREE.BufferAttribute(pPos, 3));
        pGeo.setAttribute('color', new THREE.BufferAttribute(pCol, 3));

        const pMat = new THREE.PointsMaterial({
            size: 0.15, vertexColors: true, transparent: true, opacity: 0.9,
            blending: THREE.AdditiveBlending
        });
        const particles = new THREE.Points(pGeo, pMat);
        worldGroup.add(particles);

        // 2. DOM Icons Setup
        const iconContainer = document.getElementById('icon-cloud');
        const icons = [
            'fa-solid fa-volleyball',
            'fa-solid fa-drum',
            'fa-solid fa-dog',
            'fa-solid fa-leaf',
            'fa-solid fa-water',
            'fa-solid fa-bolt',
            'fa-solid fa-mountain'
        ];

        for(let i=0; i<30; i++) {
            const iconClass = icons[Math.floor(Math.random() * icons.length)];
            const el = document.createElement('i');
            el.className = `floating-icon ${iconClass}`;

            // Random initial placement
            const left = Math.random() * 100;
            const top = Math.random() * 100;
            el.style.left = `${left}%`;
            el.style.top = `${top}%`;

            // Random scale
            const scale = 0.5 + Math.random() * 1.5;
            el.style.transform = `scale(${scale})`;

            iconContainer.appendChild(el);

            // Animate
            gsap.to(el, {
                opacity: 0.6,
                y: -100 - Math.random() * 200,
                duration: 5 + Math.random() * 5,
                repeat: -1,
                ease: "none",
                delay: Math.random() * 5
            });
            gsap.to(el, {
                x: (Math.random() - 0.5) * 50,
                duration: 3 + Math.random() * 3,
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });
        }

        // 3. Memory Monoliths
        const photoGroup = new THREE.Group();
        worldGroup.add(photoGroup);

        textures.forEach((tex, i) => {
            const planeGeo = new THREE.PlaneGeometry(8, 5.3);
            const planeMat = new THREE.MeshBasicMaterial({
                map: tex, side: THREE.DoubleSide, transparent: true, opacity: 0.9
            });
            const mesh = new THREE.Mesh(planeGeo, planeMat);

            const isRight = i % 2 === 0; // True for 0, 2...

            const zPos = -70 - (i * 70); // Deep spacing
            const xPos = isRight ? 12 : -12; // Further out from center
            const yPos = (Math.random() - 0.5) * 5;

            mesh.position.set(xPos, yPos, zPos);
            mesh.lookAt(0, 0, zPos + 30);

            const borderGeo = new THREE.EdgesGeometry(planeGeo);
            const borderMat = new THREE.LineBasicMaterial({ color: 0xFFDD00, linewidth: 2 });
            const border = new THREE.LineSegments(borderGeo, borderMat);
            mesh.add(border);

            photoGroup.add(mesh);
        });

        // 4. Central Core
        const coreGroup = new THREE.Group();
        coreGroup.position.z = -300;
        coreGroup.scale.set(5, 5, 5);
        worldGroup.add(coreGroup);

        // Inner Star
        const innerGeo = new THREE.IcosahedronGeometry(2, 0);
        const innerMat = new THREE.MeshBasicMaterial({ color: 0xFFDD00, wireframe: true, wireframeLinewidth: 2 });
        const innerStar = new THREE.Mesh(innerGeo, innerMat);
        coreGroup.add(innerStar);

        // Rings
        const ringMat = new THREE.MeshBasicMaterial({ color: 0xFFFFFF, transparent: true, opacity: 0.5 });
        const ring1 = new THREE.Mesh(new THREE.TorusGeometry(3.5, 0.1, 16, 100), ringMat);
        coreGroup.add(ring1);

        const ring2 = new THREE.Mesh(new THREE.TorusGeometry(5, 0.15, 16, 100), ringMat);
        ring2.rotation.x = Math.PI / 2;
        coreGroup.add(ring2);

        const ring3Mat = new THREE.MeshBasicMaterial({ color: 0xFFDD00, transparent: true, opacity: 0.3 });
        const ring3 = new THREE.Mesh(new THREE.TorusGeometry(7, 0.05, 16, 100), ring3Mat);
        ring3.rotation.y = Math.PI / 4;
        coreGroup.add(ring3);

        // --- GSAP Logic ---
        gsap.registerPlugin(ScrollTrigger);

        const totalScrollZ = 280;

        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: "#scroll-spacer",
                start: "top top",
                end: "bottom bottom",
                scrub: 0.1
            }
        });

        // Camera Move
        tl.to(camera.position, { z: -totalScrollZ, ease: "none" });
        tl.to(camera.rotation, { z: Math.PI, ease: "none" }, "<");

        // Effects
        tl.to(particles.scale, { z: 5, ease: "power2.in" }, 0);
        tl.to(particles.scale, { z: 1, ease: "power2.out" }, 0.9);
        tl.to(coreGroup.scale, { x: 50, y: 50, z: 50, ease: "expo.in" }, 0.85);
        tl.to(coreGroup.rotation, { y: 10, x: 5 }, 0);

        // Reveals - Updated for Centered viewing with Fade In/Out lifecycle
        function revealCard(id, startPct, endPct, xOffset) {
            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: "#scroll-spacer",
                    start: startPct + "% top",
                    end: endPct + "% top",
                    scrub: 1
                }
            });

            tl.fromTo(id,
                { opacity: 0, scale: 0.8, x: xOffset, filter: 'blur(10px)', visibility: 'hidden' },
                {
                    opacity: 1, scale: 1, x: 0, filter: 'blur(0px)', visibility: 'visible',
                    duration: 1, ease: "power2.out"
                }
            )
            .to(id, {
                opacity: 0, scale: 0.8, x: -xOffset * 0.5, filter: 'blur(10px)', visibility: 'hidden',
                duration: 1, ease: "power2.in"
            }, ">2"); // Hold phase (duration relative to fade)
        }

        gsap.to("#hero-text", {
            opacity: 0, scale: 1.5, filter: "blur(20px)",
            scrollTrigger: { trigger: "#scroll-spacer", start: "top top", end: "8% top", scrub: true }
        });

        // Centered triggers: Content is visible during the middle of these ranges
        // Total range is stretched to prevent overlap
        revealCard("#card-origin", 10, 28, -50);
        revealCard("#card-path", 32, 50, 50);
        revealCard("#card-vitality", 54, 72, -50);
        revealCard("#card-core", 76, 92, 0);

        // Finale
        ScrollTrigger.create({
            trigger: "#scroll-spacer",
            start: "95% bottom",
            onEnter: () => document.getElementById('finale').classList.add('active'),
            onLeaveBack: () => document.getElementById('finale').classList.remove('active')
        });

        // --- Animation Loop ---
        const clock = new THREE.Clock();

        function animate() {
            const t = clock.getElapsedTime();

            worldGroup.rotation.z = t * 0.05;

            // Core
            innerStar.rotation.y = t;
            innerStar.rotation.z = t * 0.5;
            ring1.rotation.x = t * 0.8;
            ring1.rotation.y = t * 0.2;
            ring2.rotation.y = t * 0.6;
            ring3.rotation.z = t * 0.3;

            // Pulse
            const pulse = 1 + Math.sin(t * 8) * 0.1;
            coreGroup.scale.multiplyScalar(pulse / coreGroup.scale.x * (5 + (camera.position.z < -100 ? (camera.position.z + 100)*-0.5 : 0)));

            // Photos
            photoGroup.children.forEach((mesh, i) => {
                mesh.position.y += Math.sin(t * 3 + i) * 0.005;
                mesh.rotation.z += Math.cos(t * 2 + i) * 0.002;
            });

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }
        animate();

        // --- Interactions ---
        const cursor = document.getElementById('cursor');
        document.addEventListener('mousemove', (e) => {
            gsap.to(cursor, { x: e.clientX, y: e.clientY, duration: 0.1 });
        });
        document.querySelectorAll('a, button, .content-card, .finale-avatar').forEach(el => {
            el.addEventListener('mouseenter', () => cursor.classList.add('hover'));
            el.addEventListener('mouseleave', () => cursor.classList.remove('hover'));
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>
</html>
